(function(f){function k(b,a){var d=document.createElementNS("http://www.w3.org/2000/svg",b||"svg");a&&f.each(a,function(a,b){d.setAttributeNS(null,a,b)});return f(d)}f.fn.activity=function(b){this.each(function(){var a=f(this),d=a.data("activity");d&&(clearInterval(d.data("interval")),d.remove(),a.removeData("activity"));if(!1!==b){b=f.extend({color:a.css("color")},f.fn.activity.defaults,b);var d=m(a,b).css("position","absolute").prependTo(b.outside?"body":a),c=a.outerHeight()-d.height(),e=a.outerWidth()-
d.width(),c="top"==b.valign?b.padding:"bottom"==b.valign?c-b.padding:Math.floor(c/2),e="left"==b.align?b.padding:"right"==b.align?e-b.padding:Math.floor(e/2),g=a.offset();b.outside?d.css({top:g.top+"px",left:g.left+"px"}):(c-=d.offset().top-g.top,e-=d.offset().left-g.left);d.css({marginTop:c+"px",marginLeft:e+"px"});h(d,b.segments,Math.round(10/b.speed)/10);a.data("activity",d)}});return this};f.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2,align:"center",valign:"center",padding:4};
f.fn.activity.getOpacity=function(b,a){var d=b.steps||b.segments-1,c=void 0!==b.opacity?b.opacity:1/d;return 1-Math.min(a,d)*(1-c)/d};var m=function(){return f("<div>").addClass("busy")},h=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)if(m=function(b,a){for(var d=2*a.width+a.space,c=d+a.length+Math.ceil(a.width/2)+1,e=k().width(2*c).height(2*c),g=k("g",{"stroke-width":a.width,"stroke-linecap":"round",stroke:a.color}).appendTo(k("g",
{transform:"translate("+c+","+c+")"}).appendTo(e)),l=0;l<a.segments;l++)g.append(k("line",{x1:0,y1:d,x2:0,y2:d+a.length,transform:"rotate("+360/a.segments*l+", 0, 0)",opacity:f.fn.activity.getOpacity(a,l)}));return f("<div>").append(e).width(2*c).height(2*c)},void 0!==document.createElement("div").style.WebkitAnimationName)var n={},h=function(b,a,d){if(!n[a]){for(var c="spin"+a,e="@-webkit-keyframes "+c+" {",g=0;g<a;g++)var f=Math.round(1E5/a*g)/1E3,k=Math.round(1E5/a*(g+1)-1)/1E3,h="% { -webkit-transform:rotate("+
Math.round(360/a*g)+"deg); }\n",e=e+(f+h+k+h);e+="100% { -webkit-transform:rotate(100deg); }\n}";g=document.createElement("style");g.appendChild(document.createTextNode(""));document.head.appendChild(g);g.sheet.insertRule(e,0);n[a]=c}b.css("-webkit-animation",n[a]+" "+d+"s linear infinite")};else h=function(b,a,d){var c=0,e=b.find("g g").get(0);b.data("interval",setInterval(function(){e.setAttributeNS(null,"transform","rotate("+ ++c%a*(360/a)+")")},1E3*d/a))};else{var p=f("<shape>").css("behavior",
"url(#default#VML)");f("body").append(p);if(p.get(0).adj){var q=document.createStyleSheet();f.each(["group","shape","stroke"],function(){q.addRule(this,"behavior:url(#default#VML);")});m=function(b,a){for(var d=2*a.width+a.space,c=2*(d+a.length+Math.ceil(a.width/2)+1),e=-Math.ceil(c/2),e=f("<group>",{coordsize:c+" "+c,coordorigin:e+" "+e}).css({top:e,left:e,width:c,height:c}),g=0;g<a.segments;g++)e.append(f("<shape>",{path:"m "+d+",0  l "+(d+a.length)+",0"}).css({width:c,height:c,rotation:360/a.segments*
g+"deg"}).append(f("<stroke>",{color:a.color,weight:a.width+"px",endcap:"round",opacity:f.fn.activity.getOpacity(a,g)})));return f("<group>",{coordsize:c+" "+c}).css({width:c,height:c,overflow:"hidden"}).append(e)};h=function(b,a,d){var c=0,e=b.get(0);b.data("interval",setInterval(function(){e.style.rotation=++c%a*(360/a)},1E3*d/a))}}f(p).remove()}})(jQuery);
