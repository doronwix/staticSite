(function(e,L){var l=function(k,e,r){return new l.TouchSVG(k,e,r)};l.TouchSVG=function(k,e,r){function l(b){$("#txtDebug").val("OnTouchStart");try{var c,d,f,g=x?$(m).parent().offset():$(m).offset(),h=g.left,C=g.top;b.preventDefault();y=!0;var e=b.touches;v={};for(g=0;g<e.length;g++){c=e[g];d=z[g];f=$(d);0!=D&&f.attr("cx",c.pageX-h).attr("cy",c.pageY-C).css("display","");v[c.identifier]=f;f.posX=c.pageX-h;f.posY=c.pageY-C;f.deltaX=0;f.deltaY=0;try{if(0==g&&null!=a.OnTouchStart){var k=w(c);setTimeout(function(){a.OnTouchStart(k,
f.posX,f.posY)},10)}}catch(u){alert(u)}}p=b.touches.length;p>s&&(s=p);A=(new Date).getTime();ADVrequestAnimationFrame(E);if(1==s&&null==n)if(n=w(e[0]),null!=n&&null!=a.OnDragStart){mblnInDragMode=!0;var r=n;setTimeout(function(){a.OnDragStart(r)},10)}else mblnInDragMode=!1,n=null}catch(t){b="";for(var q in t)b+="property: "+q+" value: ["+t[q]+"]\n";b+="toString():  value: ["+t.toString()+"]";alert("Debug(1):"+b)}}function F(b){try{b.preventDefault(),u=b,p=b.originalEvent.touches.length,p>s&&(s=p),
y=!1,ADVrequestAnimationFrame(E)}catch(a){b="";for(var d in a)b+="property: "+d+" value: ["+a[d]+"]\n";b+="toString():  value: ["+a.toString()+"]";alert("Debug(2):"+b)}}function G(b){$("#txtDebug").val("OnTouchEnd");try{var c=!1,d=0,f=0,g=null,e;H=t;t=(new Date).getTime();d=t-A;f=t-H;b.preventDefault();var k=b.originalEvent.changedTouches,c=1==s&&1==p&&!0==y;1==k.length&&(u=null,A=s=0);for(var m in v)h=v[m],null!=h&&(h.css("display","none"),delete v[m]);if(null!=n){if(null!=a.OnDragEnd){var r=n;setTimeout(function(){a.OnDragEnd(r)},
10)}n=null}c&&(f<I?null!=a.OnDoubleTap&&(e=k[0],g=w(e),setTimeout(function(){a.OnDoubleTap(g)},10)):d<J?null!=a.OnTap&&(e=k[0],g=w(e),setTimeout(function(){a.OnTap(g)},10)):null!=a.OnLongTap&&(e=k[0],g=w(e),setTimeout(function(){a.OnLongTap(g)},10)));null!=a.OnTouchEnded&&(e=k[0],g=w(e),setTimeout(function(){a.OnTouchEnded(g)},10))}catch(l){b="";for(var q in l)b+="property: "+q+" value: ["+l[q]+"]\n";b+="toString():  value: ["+l.toString()+"]";alert("Debug(3):"+b)}}function E(){try{var b=null,c=[];
if(null!=u){var d=x?$(m).parent().offset():$(m).offset(),f=d.left,g=d.top,b=u;u=null;for(var e=b.originalEvent.changedTouches,b=0;b<e.length;b++)evtTouch=e[b],h=v[evtTouch.identifier],null!=h&&(h.attr("cx",evtTouch.pageX-f).attr("cy",evtTouch.pageY-g),h.deltaX=evtTouch.pageX-f-h.posX,h.deltaY=evtTouch.pageY-g-h.posY,h.posX=evtTouch.pageX-f,h.posY=evtTouch.pageY-g,c.push(h),0==b&&null!=a.OnTouchMove&&setTimeout(function(){null!=h&&null!=h.posX&&null!=h.posY&&a.OnTouchMove(h.posX,h.posY)},10));K(c)}}catch(k){var c=
"",l;for(l in k)c+="property: "+l+" value: ["+k[l]+"]\n";c+="toString():  value: ["+k.toString()+"]";alert("Debug(5):"+c)}}function K(b){var c,d,f;switch(p){case 1:if(0==b.length)break;c=b[0];if(null!=n){if(null!=a.OnDragMove){var g=n;setTimeout(function(){a.OnDragMove(g,c.deltaX,c.deltaY)},10)}}else 0>c.deltaX?null!=a.OnOneFingerLeftSwipe&&setTimeout(function(){a.OnOneFingerLeftSwipe(c.deltaX,c.deltaY)},10):0<c.deltaX&&null!=a.OnOneFingerRightSwipe&&setTimeout(function(){a.OnOneFingerRightSwipe(c.deltaX,
c.deltaY)},10);break;case 2:if(2>b.length)break;c=b[0];d=b[1];f=b[0];objMarker4=b[1];c.posX>d.posX&&(b=c,c=d,d=b);f.posY>objMarker4.posY&&(b=f,f=objMarker4,objMarker4=b);0>c.deltaX&&0>d.deltaX?null!=a.OnTwoFingerLeftSwipe&&setTimeout(function(){a.OnTwoFingerLeftSwipe((c.deltaX+d.deltaX)/2)},10):0<c.deltaX&&0<d.deltaX?null!=a.OnTwoFingerRightSwipe&&setTimeout(function(){a.OnTwoFingerRightSwipe((c.deltaX+d.deltaX)/2)},10):0<c.deltaX&&0>d.deltaX||0<f.deltaY&&0>objMarker4.deltaY?null!=a.OnPinchIn&&setTimeout(function(){a.OnPinchIn(Math.abs(c.deltaX)+
Math.abs(d.deltaX),Math.abs(f.deltaY)+Math.abs(objMarker4.deltaY))},10):(0>c.deltaX&&0<d.deltaX||0>f.deltaY&&0<objMarker4.deltaY)&&null!=a.OnPinchOut&&setTimeout(function(){a.OnPinchOut(Math.abs(c.deltaX)+Math.abs(d.deltaX),Math.abs(f.deltaY)+Math.abs(objMarker4.deltaY))},10);break;case 3:if(3>b.length)break;c=b[0];d=b[1];f=b[2];0>c.deltaX&&0>d.deltaX&&0>f.deltaX?null!=a.OnThreeFingerLeftSwipe&&setTimeout(function(){a.OnThreeFingerLeftSwipe((c.deltaX+d.deltaX+f.deltaX)/3)},10):0<c.deltaX&&0<d.deltaX&&
0<f.deltaX&&null!=a.OnThreeFingerRightSwipe&&setTimeout(function(){a.OnThreeFingerRightSwipe((c.deltaX+d.deltaX+f.deltaX)/3)},10)}}function w(b){try{var a=x?$(m).parent().offset():$(m).offset(),d=a.left,f=a.top;if(null!=q){var g=q.createSVGRect();g.x=b.pageX-d;g.y=b.pageY-f;g.width=1;g.height=1;var e=q.getIntersectionList(g,null);return 0<e.length?e[e.length-1]:null}return null}catch(k){}}function B(b,a,d){b=document.createElementNS("http://www.w3.org/2000/svg",b);b.setAttribute("id",a);null==d&&
(d=null);d.appendChild(b);return b}var z=[],v={},p=0,s=0,u=null,A=0,t=0,H=0,h,J=500,I=500,y=!1,q=e,n=null,D=null==r?30:r,x=null!=navigator.userAgent.match(/Android/i),a=function(b,a,d){b=document.createElement(b);b.setAttribute("id",a);null==d&&(d=null);d.appendChild(b);return b}("div","surfaceevt",k);$(a).css("width","100%").css("height","100%").css("position","absolute").css("left",0).css("top",0).css("z-index","10");var m=B("svg","surface",a);B("g","ttt",m);m.style.zIndex="3";for(k=0;5>k;k++)z[k]=
B("circle","finger"+k,m),h=$(z[k]),h.css("stroke","black").css("stroke-width","2").css("fill","#996633").css("stroke-opacity","0.8").css("fill-opacity","0.7").css("display","none").attr("r",D).css("pointer-events","none");x?(a.parentElement.addEventListener("touchstart",function(a){l(a)}),$(a).parent().bind("touchend",G),$(a).parent().bind("touchmove",F),a.parentElement.addEventListener("touchcancel",function(a){a.preventDefault();$("#txtDebug").val("touchcancel")})):(a.addEventListener("touchstart",
function(a){l(a)}),$(a).bind("touchend",G),$(a).bind("touchmove",F));a.OnOneFingerLeftSwipe=null;a.OnOneFingerRightSwipe=null;a.OnTwoFingerLeftSwipe=null;a.OnTowFingerRightSwipe=null;a.OnThreeFingerLeftSwipe=null;a.OnThreeFingerRightSwipe=null;a.OnPinchIn=null;a.OnPinchOut=null;a.OnTap=null;a.OnLongTap=null;a.OnDoubleTap=null;a.OnTouchStart=null;a.OnTouchMove=null;a.OnTouchEnded=null;a.OnDragStart=null;a.OnDragEnd=null;a.OnDragMove=null;a.NumOfFingers=function(){return p};a.MaxFingers=function(){return s};
return a};e.AdvinionTouchSurface=l;e.ADVrequestAnimationFrame=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame;null==e.ADVrequestAnimationFrame&&(e.ADVrequestAnimationFrame=function(e){setTimeout(e,1E3/60)})})(this);
