function ProChart_InitMenu(F){function G(a,k){$.prochartcache.get(c.parent,".chart-menu")&&$.prochartcache.get(c.parent,".chart-menu").each(function(){"rtl"==k?$(this).hasClass("dir-rtl")||$(this).addClass("dir-rtl"):$(this).removeClass("dir-rtl")})}function H(){var e=a.currenlayout.menus;if("undefined"!=typeof e.click&&!0==e.click&&$.prochartcache.get(c.parent,".action-open-group"))$.prochartcache.get(c.parent,".action-open-group").on("click",function(){"block"==$(this).parent().find(".mn-item-group").css("display")?
($.prochartcache.get(c.parent,".mn-item-group")&&$.prochartcache.get(c.parent,".mn-item-group").css("display","none"),$.prochartcache.get(c.parent,".mn-item-sub-group")&&$.prochartcache.get(c.parent,".mn-item-sub-group").css("display","none"),$.prochartcache.get(c.parent,".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected")):($.prochartcache.get(c.parent,".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),
$.prochartcache.get(c.parent,".mn-item-group")&&$.prochartcache.get(c.parent,".mn-item-group").css("display","none"),$.prochartcache.get(c.parent,".mn-item-sub-group")&&$.prochartcache.get(c.parent,".mn-item-sub-group").css("display","none"),$(this).parent().find(".mn-item-group").css("display","block"),$(this).addClass("menu-selected"),v($(this).parent()));"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.hideopengroup()});if("undefined"!=typeof e.click&&!0==e.click&&$.prochartcache.get(c.parent,
".action-open-sub-group"))$.prochartcache.get(c.parent,".action-open-sub-group").on("click",function(){"block"==$(this).parent().find(".mn-item-sub-group").css("display")?$.prochartcache.get(c.parent,".mn-item-sub-group")&&$.prochartcache.get(c.parent,".mn-item-sub-group").css("display","none"):($.prochartcache.get(c.parent,".mn-item-sub-group")&&$.prochartcache.get(c.parent,".mn-item-sub-group").css("display","none"),$(this).parent().find(".mn-item-sub-group").css("display","block"),v($(this).parent(),
!1));"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.hideopengroup()});"undefined"!=typeof e.hover&&!0==e.hover&&$.prochartcache.get(c.parent,".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").parent().prochart_hoverIntent(function(){$.prochartcache.get(c.parent,".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected");$(this).find(".mn-item-group").stop(!0,!0).show()},function(){$.prochartcache.get(c.parent,".action-open-group")&&
$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected");$(this).find(".mn-item-group").stop(!0,!0).hide();v($(this).parent())});$.prochartcache.update(c.parent,".action-open-item");if($.prochartcache.get(c.parent,".action-open-item"))$.prochartcache.get(c.parent,".action-open-item").off().on("click",function(k){if("undefined"!=typeof a.actions){var g=$(this).attr("tid");a.actions.action(g);k.stopPropagation();"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,
".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,!0).hide(),$(this).parents().find(".mn-item-sub-group").stop(!0,!0).hide())}})}function v(e,c){"undefined"==typeof c&&(c=!0);var g=c?e.find("> .mn-item-group"):e.find("> .mn-item-sub-group"),d=e.closest(".htmlchart"),h=g.find("> .mn-array"),m=c?e.find(".action-open-group").parent("li"):e.find(".action-open-sub-group").parent("li"),b={};b.possition=
c?"bottom":"left";if(!c&&"undefined"!=typeof a.localizationobj)if("rtl"==a.localizationobj.gui.returnCurrentLanguage().direction)switch(b.possition){case "left":b.possition="right";g.removeClass("a-left").addClass("a-right");break;case "right":b.possition="left",g.removeClass("a-right").addClass("a-left")}else switch(b.possition){case "right":g.removeClass("a-left").addClass("a-right");break;case "left":g.removeClass("a-right").addClass("a-left")}var l=0,p=l=0,n=0,s=0,f="",r,n=m.outerWidth(!0),p=
m.outerHeight(!0),f=m.offset().left-d.offset().left;r=d.outerWidth()-f-n;var m=m.offset().top-d.offset().top,d=d.outerHeight()-m-p,s=parseInt(h.css("border-top-width"),10),x=0,v=0;g.find("> ul > mm-item.mm-item-group").each(function(){$(this).css("width","");v=$(this).outerWidth();$(this).outerWidth(!0);v>x&&(x=v)});var l=g.outerWidth(),q={};switch(b.possition){case "bottom":q.top=p+2+"px";q.bottom="auto";break;case "top":q.top="auto";q.bottom=p+2+"px";break;case "right":q.right="auto";q.left=n+2+
"px";q.top="0px";q.bottom="auto";break;case "left":q.right=n+2+"px",q.left="auto",q.top="0px",q.bottom="auto"}g.css(q);"undefined"==typeof b.alignh&&(b.alignh="auto");"undefined"==typeof b.alignv&&(b.alignv="auto");var q={},u={};if("top"==b.possition||"bottom"==b.possition)switch(f="auto"==b.alignh?f+n/2>l/2&&r+n/2>l/2?"center":f+n/2>l?"left":r+n/2>l?"right":"center":b.alignh,f){case "left":q.right="0px";q.left="auto";u.right="5px";u.left="auto";g.css(q);h.css(u);break;case "right":q.left="0px";q.right=
"auto";u.left="5px";u.right="auto";g.css(q);h.css(u);break;case "center":q.right=-(l/2-n/2)+"px",q.left="auto",u.left=l/2-s+"px",u.right="auto",g.css(q),h.css(u)}if("left"==b.possition||"right"==b.possition)switch(l=g.outerHeight(),f="auto"==b.alignv?m>l/2&&d>l/2?"center":m>l?"bottom":"top":b.alignv,f){case "top":q.bottom="auto";q.top="0px";u.top="5px";u.bottom="auto";g.css(q);h.css(u);break;case "bottom":q.top="auto";q.bottom="0px";u.bottom="5px";u.top="auto";g.css(q);h.css(u);break;case "center":q.top=
-(l/2-p/2)+"px",q.bottom="auto",u.top=l/2-s+"px",u.bottom="auto",g.css(q),h.css(u)}h=g.find("> ul");h.css({"max-height":"",overflow:""});b=$.prochartcache.get(a.init.chartcontainer).offset().top+$.prochartcache.get(a.init.chartcontainer).outerHeight(!0);p=g.outerHeight(!0)-g.height();b=b-h.offset().top-5-p;g.outerHeight(!0)>b&&h.css({"max-height":b+"px",overflow:"auto"});g.css("visibility","visible")}function y(e){var c="",g="",d=null;if("undefined"==typeof e.items)return"";for(var h=0,m=e.items.length;h<
m;h++)switch(d=e.items[h],d.type){case "menu-item":var b=d;b.cssaction="undefined"==typeof b.cssaction?" action-open-item":b.cssaction;d=a.patterns.menu.menu_item.replace(n,"").replace(/%id%/g,b.id).replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%caption%/g,"undefined"!=typeof b.caption?b.caption:"").replace(/%cssaction%/g,b.cssaction).replace(/%css%/g,"undefined"!=typeof b.css?b.css:"");b=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,b.id).replace(/%css%/g,
"").replace(/%cssaction%/g,b.cssaction).replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%caption%/g,"undefined"!=typeof b.caption?b.caption:"");d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-item-group":b=null;b="a-top";switch(d.group.possition){case "top":b="a-top";break;case "bottom":b="a-bottom";break;case "left":b="a-left";break;case "right":b="a-right"}d.guiid=a.commonutils.func.returnShortUniqID();d.cssaction="undefined"==typeof d.cssaction?" action-open-group":
d.cssaction+" action-open-group";var l=a.patterns.menu.menu_item_group.replace(n,"").replace(/%id%/g,d.id).replace(/%localization%/g,"undefined"!=typeof d.localize?d.localize:"").replace(/%caption%/g,"undefined"!=typeof d.caption?d.caption:"").replace(/%cssaction%/g,"undefined"!=typeof d.cssaction?d.cssaction:"").replace(/%cssgroup%/g,"undefined"!=typeof d.group&&"undefined"!=typeof d.group.css?d.group.css+" "+b:b).replace(/%css%/g,"undefined"!=typeof d.css?d.css:""),p=a.patterns.menu.menu_more_item_group.replace(n,
"").replace(/%id%/g,d.id).replace(/%localization%/g,"undefined"!=typeof d.localize?d.localize:"").replace(/%cssaction%/g,"action-open-sub-group").replace(/%caption%/g,"undefined"!=typeof d.caption?d.caption:"").replace(/%cssgroup%/g,"undefined"!=typeof d.group&&"undefined"!=typeof d.group.css?d.group.css+" a-left":" a-left").replace(/%css%/g,"undefined"!=typeof d.css?d.css:""),b=y(d),l=l.replace(/%html%/g,b.temp),p=p.replace(/%html%/g,b.tempmore),d={temp:l,tempmore:p},c=c+d.temp,g=g+d.tempmore;break;
case "menu-group-charttype":l=d;b=d="";a.patterns.menu.menu_charttype=a.patterns.menu.menu_charttype.replace(/%mm-item-icons%/g,!0==l.icons?"mm-item-icons":"").replace(/%mm-item-favorites%/g,!0==l.favorites?"mm-item-favorites":"");for(var l=a.api.layout.getbuttonStyle(),p=a.init.charttype,t=0;t<p.length;t++)var s=p[t],f=a.patterns.menu.menu_charttype.replace(n,"").replace(/%id%/g,s.id).replace(/%icon-source%/g,l.icon_source).replace(/%localization%/g,"undefined"!=typeof s.localize?s.localize:"").replace(/%caption%/g,
"undefined"!=typeof s.n?s.n:"").replace(/%star%/g,1==s.f?l.icon_prefix+"startenabled-icon":l.icon_prefix+"stardisabled-icon").replace(/%state%/g,1==s.f?"true":"false").replace(/%icon%/g,l.icon_prefix+s.id).replace(/%css%/g,"undefined"!=typeof s.css?s.css:""),s=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,s.id).replace(/%localization%/g,"undefined"!=typeof s.localize?s.localize:"").replace(/%cssaction%/g,"a-change-charttype").replace(/%css%/g,"").replace(/%caption%/g,"undefined"!=typeof s.n?
s.n:""),d=d+f,b=b+s;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-group-timeframe":b="";l=a.init.timeframe;p="";t=a.api.layout.getbuttonStyle();a.patterns.menu.menu_timeframe=a.patterns.menu.menu_timeframe.replace(/%mm-item-icons%/g,!0==d.icons?"mm-item-icons":"").replace(/%mm-item-favorites%/g,!0==d.favorites?"mm-item-favorites":"");a.patterns.menu.menu_timeframe_text=a.patterns.menu.menu_timeframe_text.replace(/%mm-item-icons%/g,!0==d.icons?"mm-item-icons":"").replace(/%mm-item-favorites%/g,
!0==d.favorites?"mm-item-favorites":"");f=a.api.timeframes.getTimeframeView();for(s=0;s<l.length;s++){var r=l[s],v="";switch(f){case "icon":v=a.patterns.menu.menu_timeframe.replace(n,"").replace(/%icon-source%/g,t.icon_source).replace(/%id%/g,r.id).replace(/%localization%/g,"undefined"!=typeof d.localize?r.localize:"").replace(/%caption%/g,"undefined"!=typeof r.n?r.n:"").replace(/%star%/g,1==r.f?t.icon_prefix+"startenabled-icon":t.icon_prefix+"stardisabled-icon").replace(/%state%/g,1==r.f?"true":
"false").replace(/%icon%/g,t.icon_prefix+z(r.id)).replace(/%css%/g,"undefined"!=typeof r.css?r.css:"");break;case "text":v=a.patterns.menu.menu_timeframe_text.replace(n,"").replace(/%icon-source%/g,t.icon_source).replace(/%id%/g,r.id).replace(/%caption%/g,"undefined"!=typeof r.n?r.n:"").replace(/%star%/g,1==r.f?t.icon_prefix+"startenabled-icon":t.icon_prefix+"stardisabled-icon").replace(/%state%/g,1==r.f?"true":"false").replace(/%title1%/g,r.t1).replace(/%title2%/g,r.t2).replace(/%css%/g,"undefined"!=
typeof r.css?r.css:"")}r=a.patterns.menu.menu_more_item.replace(n,"").replace(/%icon-source%/g,t.icon_source).replace(/%id%/g,r.id).replace(/%localization%/g,"undefined"!=typeof d.localize?r.localize:"").replace(/%cssaction%/g,"a-change-timeframe").replace(/%css%/g,"").replace(/%caption%/g,"undefined"!=typeof r.n?r.n:"");b+=v;p+=r}d={temp:b,tempmore:p};c+=d.temp;g+=d.tempmore;break;case "menu-group-majors":b=d="";l=a.init.majors;for(p=0;p<l.length;p++)f=l[p],t=a.patterns.menu.menu_majors.replace(n,
"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:"").replace(/%css%/g,"undefined"!=typeof f.css?f.css:""),f=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%cssaction%/g,"a-change-symbol").replace(/%css%/g," major-group-item-more").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:""),d+=t,b+=
f;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-group-majors2":b=d="";l=a.init.majors2;for(p=0;p<l.length;p++)f=l[p],t=a.patterns.menu.menu_majors2.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:"").replace(/%css%/g,"undefined"!=typeof f.css?f.css:""),f=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?
f.localize:"").replace(/%cssaction%/g,"a-change-symbol").replace(/%css%/g," major-group-item-more").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:""),d+=t,b+=f;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-group-indicators":b=d="";l=a.init.indicators;for(p=0;p<l.length;p++)f=l[p],t=a.patterns.menu.menu_indicators.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%custom%/g,"undefined"!=typeof f.custom?f.custom:
"false").replace(/%caption%/g,"undefined"!=typeof f.n?f.n:"").replace(/%css%/g,"undefined"!=typeof f.css?f.css:""),f=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%cssaction%/g,"a-change-indicator").replace(/%css%/g," indicator-group-item-more").replace(/%caption%/g,"undefined"!=typeof f.n?f.n:""),d+=t,b+=f;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-group-compares":b=d="";l=a.init.compares;
for(p=0;p<l.length;p++)f=l[p],t=a.patterns.menu.menu_compares.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:"").replace(/%css%/g,"undefined"!=typeof f.css?f.css:""),f=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,f.id).replace(/%cssaction%/g,"a-change-compare").replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%caption%/g,"undefined"!=typeof f.name?
f.name:""),d+=t,b+=f;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-group-localizations":b=d="";l=a.init.localization;for(p=0;p<l.length;p++)f=l[p],t=a.patterns.menu.menu_localizations.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,"undefined"!=typeof f.localize?f.localize:"").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:"").replace(/%css%/g,"undefined"!=typeof f.css?f.css:""),f=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,f.id).replace(/%localization%/g,
"undefined"!=typeof f.localize?f.localize:"").replace(/%cssaction%/g," a-change-localization").replace(/%css%/g,"").replace(/%caption%/g,"undefined"!=typeof f.name?f.name:""),d+=t,b+=f;d={temp:d,tempmore:b};c+=d.temp;g+=d.tempmore;break;case "menu-item-image":b=d,d=a.patterns.menu.menu_item_image.replace(n,"").replace(/%id%/g,b.id).replace(/%caption%/g,"undefined"!=typeof b.caption?b.caption:"").replace(/%cssaction%/g,"undefined"!=typeof b.action?b.action:"").replace(/%image%/g,"undefined"!=typeof b.image?
b.image:"").replace(/%css%/g,"undefined"!=typeof b.css?b.css:""),b=a.patterns.menu.menu_more_item.replace(n,"").replace(/%tid%/g,b.id).replace(/%cssaction%/g,"undefined"!=typeof b.action?b.action:"").replace(/%caption%/g,"undefined"!=typeof b.caption?b.caption:"").replace(/%caption%/g,"undefined"!=typeof b.caption?b.caption:""),d={temp:d,tempmore:b},c+=d.temp,g+=d.tempmore}return{temp:c,tempmore:g}}function A(){$.prochartcache.update(c.parent,".a-change-timeframe");if($.prochartcache.get(c.parent,
".a-change-timeframe"))$.prochartcache.get(c.parent,".a-change-timeframe").off().on("click",function(){var e=$(this).attr("tid");"undefined"!=typeof a.toolbaradvobj.gui&&a.toolbaradvobj.gui.selectedTimeFrameButton(e);"undefined"!=typeof a.chart.ChangeTimeScale&&(a.chart.ChangeTimeScale(e),!0==a.bi.status&&a.bi.addt2BI("change timescale: "+e));e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),
$(this).parents().find(".mn-item-group").stop(!0,!0).hide())});$.prochartcache.update(c.parent,".a-favorite-timeframe");if($.prochartcache.get(c.parent,".a-favorite-timeframe"))$.prochartcache.get(c.parent,".a-favorite-timeframe").off().on("click",function(){var c=$(this).attr("tid"),k=$(this).attr("state"),g="false"==k?!0:!1,d=a.api.layout.getbuttonStyle();switch(k){case "true":$(this).find("span").removeClass(d.icon_prefix+"startenabled-icon").addClass(d.icon_prefix+"stardisabled-icon");$(this).attr("state",
"false");"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.viewTimeFrameButton(c,0);break;case "false":$(this).find("span").removeClass(d.icon_prefix+"stardisabled-icon").addClass(d.icon_prefix+"startenabled-icon"),$(this).attr("state","true"),"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.viewTimeFrameButton(c,1)}for(k=0;k<a.init.timeframe.length;k++)a.init.timeframe[k].id==c&&(a.init.timeframe[k].f=g?"1":"0");if(typeof a.events.onChangeTimeFrameFavorites==typeof Function)a.events.onChangeTimeFrameFavorites(c,
g,a.init.timeframe);try{"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setTimeFrameFavorites(a.init.timeframe)}catch(h){}return!1})}function I(){$.prochartcache.update(c.parent,".a-change-charttype");if($.prochartcache.get(c.parent,".a-change-charttype"))$.prochartcache.get(c.parent,".a-change-charttype").off().on("click",function(){var e=$(this).attr("tid");"undefined"!=typeof a.chart.ChangeSymbol&&("undefined"!=typeof a.toolbaradvobj.gui&&a.toolbaradvobj.gui.selectedChartTypeButton(e),
"undefined"!=typeof a.chart.ChangePriceType&&(a.chart.ChangePriceType(e),!0==a.bi.status&&a.bi.addt2BI("change price type: "+e)));e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,!0).hide())});$.prochartcache.update(c.parent,".a-favorite-charttype");if($.prochartcache.get(c.parent,".a-favorite-charttype"))$.prochartcache.get(c.parent,".a-favorite-charttype").off().on("click",
function(){var c=$(this).attr("tid"),k=$(this).attr("state"),g="false"==k?!0:!1,d=a.api.layout.getbuttonStyle();switch(k){case "true":$(this).find("span").removeClass(d.icon_prefix+"startenabled-icon").addClass(d.icon_prefix+"stardisabled-icon");$(this).attr("state","false");"undefined"!=typeof a.toolbarobj&&a.toolbarobj.gui.viewTypeChartButton(c,0);"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.viewTypeChartButton(c,0);break;case "false":$(this).find("span").removeClass("stardisabled-icon").addClass(d.icon_prefix+
"startenabled-icon"),$(this).attr("state","true"),"undefined"!=typeof a.toolbaradvobj&&a.toolbaradvobj.gui.viewTypeChartButton(c,1)}for(k=0;k<a.init.charttype.length;k++)a.init.charttype[k].id==c&&(a.init.charttype[k].f=g?"1":"0");if(typeof a.events.onChangePriceTypeFavorites==typeof Function)a.events.onChangePriceTypeFavorites(c,g,a.init.charttype);try{"undefined"!=typeof a.api.localstorage&&a.api.localstorage.setPriceTypeFavorites(a.init.charttype)}catch(h){}return!1})}function B(){$.prochartcache.update(c.parent,
".a-change-symbol");if($.prochartcache.get(c.parent,".a-change-symbol"))$.prochartcache.get(c.parent,".a-change-symbol").off().on("click",function(){var e=$(this).attr("tid");"undefined"!=typeof a.chart.ChangeSymbol&&(e=a.init.gui.majorsReturn(e),a.chart.ChangeSymbol(e),!0==a.bi.status&&a.bi.addt2BI("change symobol: "+e.name));e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,
!0).hide())})}function C(){$.prochartcache.update(c.parent,".a-change-indicator");if($.prochartcache.get(c.parent,".a-change-indicator"))$.prochartcache.get(c.parent,".a-change-indicator").off().on("click",function(){var e=$(this).attr("tid"),k=!1,k="undefined"!=$(this).attr("custom")?"true"==$(this).attr("custom")?!0:!1:!1;if("undefined"!=typeof a.chart.AddStudy)switch(k){case !0:typeof a.events.menu.onCustomIndicatorClick==typeof Function&&(a.events.menu.onCustomIndicatorClick(e),!0==a.bi.status&&
a.bi.addt2BI("add custom study: "+e));break;case !1:a.actions.action("add-indicator",e),!0==a.bi.status&&a.bi.addt2BI("add study: "+e)}e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,!0).hide())})}function D(){$.prochartcache.update(c.parent,".a-change-compare");if($.prochartcache.get(c.parent,".a-change-compare"))$.prochartcache.get(c.parent,
".a-change-compare").off().on("click",function(){var e=$(this).attr("tid");"undefined"!=typeof a.chart.AddCompareSymbol&&(e=a.init.gui.comparesReturn(e),a.chart.AddCompareSymbol(e),!0==a.bi.status&&a.bi.addt2BI("add compare symbol: "+e.name));e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,
!0).hide())})}function J(){$.prochartcache.update(c.parent,".a-change-localization");if($.prochartcache.get(c.parent,".a-change-localization"))$.prochartcache.get(c.parent,".a-change-localization").off().on("click",function(){var e=$(this).attr("tid");"undefined"!=typeof a.localizationobj&&(a.localizationobj.gui.changeLocalization(e),!0==a.bi.status&&a.bi.addt2BI("change localization: "+e));e=a.currenlayout.menus;"undefined"!=typeof e.closebyclick&&!0==e.closebyclick&&($.prochartcache.get(c.parent,
".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected"),$(this).parents().find(".mn-item-group").stop(!0,!0).hide())})}function K(){var e=[],k=$(c.parent).find("#menu-favorite-indicators");e.push('<li class="menu-favorite-indicator"  idx="%indicatorid%">%indicatorname%</li>');e.push('<li onclick="openIndicators();">Indicators</li>');var g=/%indicatorid%/g,d=/%indicatorname%/g,h=a.commonutils.func.getKeybyPath(a.gui.guiblock,"menu.studies.visible");null==
h||0!=h&&!1!=h||$(c.parent).find("#studies").addClass("hideobj");$(k).find(".menu-favorite-indicator").each(function(){$(this).off().remove()});for(var h=a.init.indicators,m=0;m<h.length;m++){var b=e[0].replace(g,h[m].id).replace(d,h[m].n);$(k).append(b)}$(k).find(".menu-favorite-indicator").on("click",function(){var b=$(this).attr("idx");"undefined"!=typeof a.chart.AddStudy&&(a.actions.action("add-indicator",b),!0==a.bi.status&&a.bi.addt2BI("add study:"+b))});$(k).find(".menu-indicatorform").off().on("click",
function(){"undefined"!=typeof a.indicators&&(a.indicators.gui.viewIndicators(),!0==a.bi.status&&a.bi.addt2BI("menu view all indicators"))})}function E(){var e=[],k=$(c.parent).find("#menu-favorite-compares");e.push('<li class="menu-favorite-compare"  idx="%compareid%">%comparename%</li>');e.push('<li onclick="openCompares();">Compares</li>');var g=/%compareid%/g,d=/%comparename%/g,h=a.commonutils.func.getKeybyPath(a.gui.guiblock,"menu.compares.visible");null==h||0!=h&&!1!=h||$(c.parent).find("#compares").addClass("hideobj");
$(k).find(".menu-favorite-compare").each(function(){$(this).off().remove()});for(var h=a.init.compares,m=0;m<h.length;m++){var b=e[0].replace(g,h[m].id).replace(d,h[m].name);$(k).append(b)}$(k).find(".menu-favorite-compare").on("click",function(){var b=$(this).attr("idx");"undefined"!=typeof a.chart.AddCompareSymbol&&(b=a.init.gui.comparesReturn(b),a.chart.AddCompareSymbol(b))});$(k).find(".menu-compareform").off().on("click",function(){"undefined"!=typeof a.compares&&a.compares.gui.viewCompares()})}
function z(c){if("undefined"==typeof c||null==c)return"";for(var k=0;k<a.init.timeclassmirror.length;k++)if(a.init.timeclassmirror[k].time==c.toLowerCase()||a.init.timeclassmirror[k].time==c.toUpperCase())return a.init.timeclassmirror[k].css;return""}function w(){$.prochartcache.update(c.parent,".chart-menu > ul");$.prochartcache.get(c.parent,".chart-menu > ul")&&$.prochartcache.get(c.parent,".chart-menu > ul").each(function(){var a=$(this);a.parent();$(document.createDocumentFragment());a.attr("id");
L(a)})}function L(a){var c=a.parent().width();a.parent().height();var g=0,d=0,h=0,m=a.find("> .mn-more");0<m.length&&(h=m.outerWidth(!0));a.find("> .mn-item ").each(function(){d+=$(this).outerWidth(!0)});a.find("> .mn-item ").each(function(){g+=$(this).outerWidth(!0);if(g>c-h){$(this).addClass("hide-item");var b=$(this).find("> a").attr("tid");a.find(".mn-more-item > a[tid^='"+b+"']").parent().removeClass("hide-more-item")}else $(this).removeClass("hide-item"),b=$(this).find("> a").attr("tid"),a.find(".mn-more-item > a[tid^='"+
b+"']").parent().addClass("hide-more-item")});g>c-h?a.find(".mn-more").css("display","block"):a.find(".mn-more").css("display","none")}var c={},a=F;a.menuobj=c;c.mycache={};var n=/=""/g;a.api.debug.getLogger("prochart.gui.menu");c.parent=null;c.parent=null;c.gui={viewMenu:function(e){c.parent=e;$.prochartcache.get(c.parent);for(var k=a.currenlayout.menus.items,g=0;g<k.length;g++){var d=k[g],h=null;d.guiid=a.commonutils.func.returnShortUniqID();var m=a.patterns.menu.containter.replace(/%css%/g,"undefined"!=
typeof d.css?d.css:"").replace(/%id%/g,d.guiid),h=y(d),m=m.replace(/%html%/g,h.temp+"%html%"),b="a-bottom";"undefined"!=typeof d.more.possition&&(b="a-"+d.more.possition);h=a.patterns.menu.menu_more.replace(/%css%/g,"").replace(/%cssaction%/g," action-open-group").replace(/%cssgroup%/g,b).replace(/%html%/g,h.tempmore);m=m.replace(/%html%/g,h);$.prochartcache.get(e,"#"+d.parent)&&$.prochartcache.get(e,"#"+d.parent).append(m)}H();B();I();A();C();D();J();w()},updateIndicatorFavorites:function(){if(parent){K();
var e="",k="";$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".indicator-group-item:not(:last)").remove();var g=$.prochartcache.get(c.parent,".indicator-group-item");$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".indicator-group-item-more:not(:last)").remove();for(var d=$.prochartcache.get(c.parent,".indicator-group-item-more"),h=a.init.indicators,m=0;m<h.length;m++)var b=h[m],l=a.patterns.menu.menu_indicators.replace(n,"").replace(/%id%/g,b.id).replace(/%caption%/g,
"undefined"!=typeof b.n?b.n:"").replace(/%custom%/g,"undefined"!=typeof b.custom?b.custom:"false").replace(/%css%/g,"undefined"!=typeof b.css?b.css:""),b=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,b.id).replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%cssaction%/g,"a-change-indicator").replace(/%css%/g," indicator-group-item-more").replace(/%caption%/g,"undefined"!=typeof b.n?b.n:""),e=e+l,k=k+b;0==h.length&&(h=a.patterns.menu.menu_indicators.replace(n,
"").replace(/%id%/g,"").replace(/%caption%/g,"").replace(/%css%/g," hide-item"),e+=h);g&&g.replaceWith(e);d&&d.replaceWith(k);$.prochartcache.update(c.parent,".indicator-group-item-more");$.prochartcache.update(c.parent,".indicator-group-item");C()}},updateCompareFavorites:function(){if(parent){E();var e="",k="";$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".compare-group-item:not(:last)").remove();var g=$.prochartcache.get(c.parent,".compare-group-item");$.prochartcache.get(c.parent)&&
$.prochartcache.get(c.parent).find(".compare-group-item-more:not(:last)").remove();for(var d=$.prochartcache.get(c.parent,".compare-group-item-more"),h=a.init.compares,m=0;m<h.length;m++)var b=h[m],l=a.patterns.menu.menu_compares.replace(n,"").replace(/%id%/g,b.id).replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%caption%/g,"undefined"!=typeof b.name?b.name:"").replace(/%css%/g,"undefined"!=typeof b.css?b.css:""),b=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,
b.id).replace(/%cssaction%/g,"a-change-compare").replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%caption%/g,"undefined"!=typeof b.name?b.name:""),k=k+l,e=e+b;0==h.length&&(h=a.patterns.menu.menu_compares.replace(n,"").replace(/%id%/g,"").replace(/%caption%/g,"").replace(/%css%/g," hide-item"),k+=h);g&&g.replaceWith(k);d&&d.replaceWith(e);$.prochartcache.update(c.parent,".compare-group-item");$.prochartcache.update(c.parent,".compare-group-item-more");D()}},updateMajorFavorites:function(){if(parent){E();
var e="",k="";$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".major-group-item:not(:last)").remove();var g=$.prochartcache.get(c.parent,".major-group-item");$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".major-group-item-more:not(:last)").remove();for(var d=$.prochartcache.get(c.parent,".major-group-item-more"),h=a.init.majors,m=0;m<h.length;m++)var b=h[m],l=a.patterns.menu.menu_majors.replace(n,"").replace(/%id%/g,b.id).replace(/%caption%/g,"undefined"!=typeof b.name?
b.name:"").replace(/%css%/g,"undefined"!=typeof b.css?b.css:""),b=a.patterns.menu.menu_more_item.replace(n,"").replace(/%id%/g,b.id).replace(/%localization%/g,"undefined"!=typeof b.localize?b.localize:"").replace(/%cssaction%/g,"a-change-symbol").replace(/%css%/g," major-group-item-more").replace(/%caption%/g,"undefined"!=typeof b.name?b.name:""),e=e+l,k=k+b;0==h.length&&(h=a.patterns.menu.menu_majors.replace(n,"").replace(/%id%/g,"").replace(/%caption%/g,"").replace(/%css%/g," hide-item"),e+=h);
g&&g.replaceWith(e);d&&d.replaceWith(k);$.prochartcache.update(c.parent,".major-group-item");$.prochartcache.update(c.parent,".major-group-item-more");B()}},updateMajors2:function(){},about:function(){"undefined"!=typeof a.chart.ShowAbout&&a.chart.ShowAbout()},changeLocalization:function(a,c){G(a,c);w()},updateTimesScale:function(){$.prochartcache.get(c.parent)&&$.prochartcache.get(c.parent).find(".timeframe-group-item:not(:last)").remove();for(var e=$.prochartcache.get(c.parent,".timeframe-group-item"),
k="",g=a.init.timeframe,d=a.api.timeframes.getTimeframeView(),h=a.api.layout.getbuttonStyle(),m=0;m<g.length;m++){var b=g[m],l="";switch(d){case "icon":l=a.patterns.menu.menu_timeframe.replace(n,"").replace(/%id%/g,b.id).replace(/%icon-source%/g,h.icon_source).replace(/%caption%/g,"undefined"!=typeof b.n?b.n:"").replace(/%star%/g,1==b.f?h.icon_prefix+"startenabled-icon":h.icon_prefix+"stardisabled-icon").replace(/%state%/g,1==b.f?"true":"false").replace(/%icon%/g,z(b.id)).replace(/%css%/g,"undefined"!=
typeof b.css?b.css:"");break;case "text":l=a.patterns.menu.menu_timeframe_text.replace(n,"").replace(/%id%/g,b.id).replace(/%icon-source%/g,h.icon_source).replace(/%caption%/g,"undefined"!=typeof b.n?b.n:"").replace(/%star%/g,1==b.f?h.icon_prefix+"startenabled-icon":h.icon_prefix+"stardisabled-icon").replace(/%state%/g,1==b.f?"true":"false").replace(/%title1%/g,b.t1).replace(/%title2%/g,b.t2).replace(/%css%/g,"undefined"!=typeof b.css?b.css:"")}k+=l}e&&e.replaceWith(k);$.prochartcache.update(c.parent,
".timeframe-group-item");A()},help:function(){"undefined"!=typeof a.gui.guiblock.menu.help.functionhelp&&"function"==typeof a.gui.guiblock.menu.help.functionhelp&&null!=a.gui.guiblock.menu.help.functionhelp&&(c.init.functionOpenHelp=a.gui.guiblock.menu.help.functionhelp);"undefined"!=typeof c.init.functionOpenHelp&&"function"==typeof c.init.functionOpenHelp&&c.init.functionOpenHelp()},adjustSize:function(){w()},changeTypeChartFavoritesStar:function(e){if(0!=e.length)for(var k=a.api.layout.getbuttonStyle(),
g=0;g<e.length;g++){var d=e[g],h=$.prochartcache.get(c.parent,".a-favorite-charttype[tid^='"+d.id+"']"),m=$(h).find("span");if(0<h.length)switch(d.f){case 1:case "1":h.attr("state","true");m.removeClass(k.icon_prefix+"stardisabled-icon").addClass(k.icon_prefix+"startenabled-icon");break;case 0:case "0":h.attr("state","false"),m.addClass(k.icon_prefix+"stardisabled-icon").removeClass(k.icon_prefix+"startenabled-icon")}}},changeTimeFrameFavoritesStar:function(){},hidemenus:function(){$.prochartcache.get(c.parent,
".action-open-group")&&$.prochartcache.get(c.parent,".action-open-group").removeClass("menu-selected");$.prochartcache.get(c.parent,".mn-item-group")&&$.prochartcache.get(c.parent,".mn-item-group").css("display","none");$.prochartcache.get(c.parent,".mn-item-sub-group")&&$.prochartcache.get(c.parent,".mn-item-sub-group").css("display","none")}};c.init={functionOpenHelp:function(){window.open("http://www.tradeandchart.com/Help/Help.aspx?p=2.6","_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes")}};
c.favorites={removeFavorite:function(e){var k=a.api.layout.getbuttonStyle();$.prochartcache.get(c.parent,"#star-"+e)&&$.prochartcache.get(c.parent,"#star-"+e).removeClass(k.icon_prefix+"startenabled-icon").addClass(k.icon_prefix+"stardisabled-icon")}};return c};
