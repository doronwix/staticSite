function ProChart_Initindicators(B){function Z(){for(var a=jQuery.extend({},null,f.objParams),c=a.id,b=e.apiinit.savedIndicatorsSetting,d=0;d<b.length;d++)if(b[d].id==c){b.splice(d,1);break}d=e.chart.StudiesById[c];d.hasOwnProperty("panel")&&(a.panel=d.panel);a.hasOwnProperty("UID")&&delete a.UID;a.hasOwnProperty("group")&&delete a.group;b.push(a);if(typeof e.events.study.onChangeDefaultSettings==typeof Function)e.events.study.onChangeDefaultSettings(b,c)}function aa(){for(var a=f.objParams.UID,c=
f.objParams.id,b=e.chart.Studies,d=0;d<b.length;d++)if(b[d].id==c){for(var h=Object.keys(f.objParams),k=0;k<h.length;k++)"UID"!=h[k]&&"group"!=h[k]&&"panel"!=h[k]&&delete f.objParams[h[k]];f.objParams=jQuery.extend(!0,f.objParams,b[d]);if(typeof e.events.study.onReset==typeof Function)e.events.study.onReset(c);break}C({change:!0});D({change:!0});E();S();I({change:!0});T({change:!0});F();"undefined"!=typeof a&&e.chart.UpdateStudyAll(f.objParams)}function ba(){e.chart.IsVolumeEnabled()?$(".properties-tabs").find(".volume-category-tab").css("display",
""):$(".properties-tabs").find(".volume-category-tab").css("display","none")}function x(){if(typeof e.events.onStudyCheckMax!=typeof Function)return!1;try{var a=e.chart.GetNumOfRootIndicators();return!0==e.events.onStudyCheckMax(a)?!1:!0}catch(c){return!1}}function la(a){$("#chart-dialog").html(a);a=e.chart.Studies;for(var c=0;c<a.length;c++){var b=e.patterns.indicators.indicatorsform_row.replace(/%icon-prefix%/g,n.icon_prefix).replace(/%icon-source%/g,n.icon_source).replace(/%id%/g,a[c].id).replace(/%caption%/g,
a[c].caption),d=a[c].category;ca(a[c].id)&&(b=b.replace(n.icon_prefix+"stardisabled-icon",n.icon_prefix+"startenabled-icon"));$("#indicatorsgroup-"+d+" > ul.indicators-list").append(b)}$(".indicators-list .openindicator").on("click",function(){if(!x()){var a=$(this).attr("idx").replace("indicator-",""),b=w(a);e.chart.AddStudyWithParams(a,b);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}});$(".indicators-list .li-indicator .a-property-favorite").on("click",
function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html();U(a,b)});$(".indicators-list .li-indicator .star-button").on("click",function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html(),c=$(this).parent().find("a").attr("title");$(this).hasClass(n.icon_prefix+"stardisabled-icon")?($(this).addClass(n.icon_prefix+"startenabled-icon").removeClass("stardisabled-icon"),da(a.replace("indicator-",""),b,c)):($(this).removeClass(n.icon_prefix+"startenabled-icon").addClass(n.icon_prefix+
"stardisabled-icon"),V(a.replace("indicator-","")))});$(".indicators-list .li-indicator .a-add-favorite").on("click",function(){if(!x()){var a=$(this).parent().attr("id").replace("indicator-",""),b=w(a);e.chart.AddStudyWithParams(a,b);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}});G();J();ea();$("#button-add-indicator").button();$("#button-add-indicator-to").button();$("#button-reset-settings-indicator").button();$("#button-save-settings-indicator").button();
fa();ba();$("#chart-dialog").dialog("open");"undefined"!=typeof e.localizationobj&&e.localizationobj.gui.updateFromDataLang($("#chart-dialog"))}function ma(a){var c=1;"-"===a[0]&&(c=-1,a=a.substr(1));return function(b,d){return(b[a]<d[a]?-1:b[a]>d[a]?1:0)*c}}function na(a){$("#chart-dialog").html(a);a=e.chart.Studies;e.chart.Studies.sort(ma("caption"));for(var c=0;c<a.length;c++){var b=e.patterns.indicators.indicatorsform_row.replace(/%icon-prefix%/g,n.icon_prefix).replace(/%icon-source%/g,n.icon_source).replace(/%id%/g,
a[c].id).replace(/%caption%/g,a[c].caption);ca(a[c].id)&&(b=b.replace(n.icon_prefix+"stardisabled-icon",n.icon_prefix+"startenabled-icon"));$("#indicatorsgroup-trend > ul.indicators-list").append(b)}$(".indicators-list .li-indicator").on("click",function(){if(!x()){var a=$(this).attr("id").replace("indicator-",""),b=w(a);e.chart.AddStudyWithParams(a,b);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}});$(".indicators-list .li-indicator .a-property-favorite").on("click",
function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html();U(a,b)});$(".indicators-list .li-indicator .star-button").on("click",function(){var a=$(this).parent().attr("id"),b=$(this).parent().find("span").html(),c=$(this).parent().find("a").attr("title");$(this).hasClass(n.icon_prefix+"stardisabled-icon")?($(this).addClass(n.icon_prefix+"startenabled-icon").removeClass("stardisabled-icon"),da(a.replace("indicator-",""),b,c)):($(this).removeClass(n.icon_prefix+"startenabled-icon").addClass(n.icon_prefix+
"stardisabled-icon"),V(a.replace("indicator-","")))});$(".indicators-list .li-indicator .a-add-favorite").on("click",function(){if(!x()){var a=$(this).parent().attr("id").replace("indicator-",""),b=w(a);e.chart.AddStudyWithParams(a,b);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}});G();J();ea();$("#button-add-indicator").button();$("#button-add-indicator-to").button();fa();ba();$("#chart-dialog").dialog("open");"undefined"!=typeof e.localizationobj&&
e.localizationobj.gui.updateFromDataLang($("#chart-dialog"))}function U(a,c){(function(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")});$("#dialog-indicator-page #indicator-inner").empty()})($("#dialog-indicator-page #indicator-inner"));oa(e.patterns.indicators.indicatorform,c,a)}function oa(a,c,b){a=a.replace(/%panels%/g,"<tr><td>set panel data here</td></td>").replace(/%style-link-panels%/g,"display:none;");$("#dialog-indicator-page #indicator-inner").html(a);$("#indicators-page > .dialog_level").css("display",
"none");$("#dialog-indicator-page").css("display","block");G();W(1,c);f.id="";f.objStudyInfo=null;f.objParams=null;f.editStatus=!1;a=b.replace("indicator-","");switch(a){case "rsi1":c=w(a);f.objParams=c;C();D();E();I();T(c.lines);F();break;case "macd1":c=w(a);f.objParams=c;C();D();E();b=null;b=c.param1;K("#in-fastema",b.min,b.max,1,b.values[0]);L("#in-fastema","param1",0);b=c.param2;K("#in-slowema",b.min,b.max,1,b.values[0]);L("#in-slowema","param2",0);b=c.param3;K("#in-macdsma",b.min,b.max,1,b.values[0]);
L("#in-macdsma","param3",0);M("#histogram-line","renderitem3");M("#macd-line","renderitem1");M("#signal-line","renderitem2");F();break;case "gator1":c=w(a);f.objParams=c;C();D();E();S();I();F();break;default:ga(w(a))}pa(a);$("#li-browser-indicators").trigger("click");"undefined"!=typeof e.localizationobj&&e.localizationobj.gui.updateFromDataLang($("#dialog-indicator-page #indicator-inner"))}function pa(a){f.id=a;$("#button-add-indicator").off();$("#button-add-indicator").button({disabled:!1});$("#button-add-indicator").on("click",
function(){x()||(f.objStudyInfo=e.chart.AddStudyWithParams(f.id,f.objParams),null!=f.objStudyInfo&&(f.objParams=f.objStudyInfo,f.editStatus=!0,$(this).button({disabled:!0})))});$("#button-add-indicator-to").off();$("#button-add-indicator-to").button({disabled:!1});$("#button-add-indicator-to").on("click",function(){z.debug("Add to button click");var c=void 0;"undefined"==typeof c&&(c="Panels");var b=e.patterns.indicators.panelsform,b=b.replace(/%style-link-panels%/g,""),d="";if("undefined"!=typeof e.panels){for(var h=
e.panels.core.returnPanels(),k="",g=e.chart.GetLegendInfo(),d=d+e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%legends%/g,"").replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%panel-action-style%/g,"").replace(/%tid%/g,a).replace(/%tguiid%/g,"").replace(/%position%/g,"panel-top").replace(/%tpanelid%/g,"").replace(/%css%/g,"paneltype-new"),f=0;f<h.length;f++){switch(h[f].type){case "price":k="Price panel";
break;case "study":k="Study panel"}for(var p="",m=ha(h[f].id,g),q=0;q<m.length;q++)p+="<span>%legend-title%</span>; ".replace(/%legend-title%/g,m[q]);d+=e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,k).replace(/%panel-type%/g,h[f].type).replace(/%legends%/g,p).replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%tid%/g,a).replace(/%tguiid%/g,"").replace(/%panel-action-style%/g,"").replace(/%position%/g,"").replace(/%tpanelid%/g,h[f].id).replace(/%css%/g,
"paneltype-"+h[f].type)}d+=e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%legends%/g,"").replace(/%button-title%/g,"Add here").replace(/%button%/g,"add-button").replace(/%panel-action-style%/g,"").replace(/%tid%/g,a).replace(/%tguiid%/g,"").replace(/%tpanelid%/g,"").replace(/%position%/g,"panel-bottom").replace(/%css%/g,"paneltype-new");b=b.replace(/%panels%/g,d)}$("#dialog-panels-page #panels-inner").html(b);$("#indicators-page > .dialog_level").css("display",
"none");$("#dialog-panels-page").css("display","block");G();N();W(1,c,2);$("#li-browser-indicators").trigger("click");"undefined"!=typeof e.localizationobj&&e.localizationobj.gui.updateFromDataLang($("#dialog-indicator-page #indicator-inner"))});$("#button-reset-settings-indicator").off();$("#button-reset-settings-indicator").on("click",function(){z.debug("Reset settings");aa()});$("#button-save-settings-indicator").off();$("#button-save-settings-indicator").on("click",function(){z.debug("Save as default settings");
Z()})}function ia(a,c,b){ja();A=c.caption;f.id=c.id;f.objStudyInfo=c;f.objParams=c;f.editStatus=!0;e.commonutils.func.detectmob()?qa("",A):ra("",A);a=e.patterns.indicators.indicatorform;a=a.replace(/%style-link-panels%/g,"");var d=X(a,c,b);a=a.replace(/%panels%/g,d);$("#chart-dlgindicator #indicator-inner").html(a);G();N(b);ga(c);$("#button-reset-settings-indicator").button();$("#button-save-settings-indicator").button();"undefined"!=typeof e.localizationobj&&e.localizationobj.gui.updateFromDataLang($("#chart-dlgindicator #indicator-inner"));
$("#chart-dlgindicator").dialog("open")}function ha(a,c){for(var b=[],d=0;d<c.length;d++){var e=c[d];if(a==e.id){for(d=0;d<e.fields.length;d++)"study"==e.fields[d].type&&b.push(e.fields[d].name);break}}return b}function X(a,c,b){a="";if("undefined"!=typeof e.panels){var d=e.panels.core.returnPanels(),h="",f=e.chart.GetLegendInfo();a+=e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,"New panel").replace(/%panel-type%/g,"new").replace(/%tid%/g,c.id).replace(/%tguiid%/g,c.UID).replace(/%legends%/g,
"").replace(/%button-title%/g,"Move here").replace(/%tpanelid%/g,"").replace(/%panel-action-style%/g,"").replace(/%button%/g,"move-button").replace(/%position%/g,"panel-top").replace(/%css%/g,"paneltype-new");for(var g=0;g<d.length;g++){switch(d[g].type){case "price":h="Price panel";break;case "study":h="Study panel"}for(var l="",p="",m=ha(d[g].id,f),q=0;q<m.length;q++)l+="<span>%legend-title%</span>; ".replace(/%legend-title%/g,m[q]);a:{for(q=0;q<f.length;q++)if(m=f[q],d[g].id==m.id){for(q=0;q<m.fields.length;q++)if(m.fields[q].uid==
b){m=!0;break a}m=!1;break a}m=!1}m&&(p="display:none;");a+=e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,h).replace(/%panel-type%/g,d[g].type).replace(/%legends%/g,l).replace(/%button-title%/g,"Move here").replace(/%button%/g,"move-button").replace(/%tid%/g,c.id).replace(/%tguiid%/g,c.UID).replace(/%position%/g,"").replace(/%tpanelid%/g,d[g].id).replace(/%panel-action-style%/g,p).replace(/%css%/g,"paneltype-"+d[g].type)}a+=e.patterns.indicators.panelstr.replace(/%panel-type-title%/g,
"New panel").replace(/%panel-type%/g,"new").replace(/%legends%/g,"").replace(/%tid%/g,c.id).replace(/%tguiid%/g,c.UID).replace(/%button-title%/g,"Move here").replace(/%tpanelid%/g,"").replace(/%panel-action-style%/g,"").replace(/%button%/g,"move-button").replace(/%position%/g,"panel-bottom").replace(/%css%/g,"paneltype-new")}return a}function w(a){var c=a;(a=-1!==a.indexOf("+",a.length-1))&&(c=c.slice(0,c.length-1));var b;a:{b=c;for(var d=e.apiinit.savedIndicatorsSetting,h=0;h<d.length;h++)if(d[h].id==
b){b=jQuery.extend(!0,{},d[h]);break a}b=null}if(b)return a&&(b.panel=""),b;b=e.chart.Studies;for(d=0;d<b.length;d++)if(b[d].id==c)return c=jQuery.extend(!0,{},b[d]),a&&(c.panel=""),c;return null}function E(){if(null!=f.objParams)for(var a=f.objParams.renderitems,c=f.objParams.id,b=0;b<a;b++){var d=f.objParams["renderitem"+(b+1)],h={};"undefined"==typeof d.style?(d.style=[],d.style.push(h)):h=d.style[0];if("undefined"!=typeof e.chart.StyleObject[c+"_item"+(b+1)]){var k=e.chart.StyleObject[c+"_item"+
(b+1)];switch(d.drawtype){case "columns":ka(k,h);for(var d={visible:!0},g=Object.keys(d),l=0;l<g.length;l++){var p=g[l];"undefined"==typeof h[p]&&(h[p]="undefined"!==typeof k[p]?k[p]:d[p])}break;default:for(d={stroke:"rgb(0,0,0)",strokeWidth:"1",strokeOpacity:"1",fill:"rgb(0,0,0)",fillOpacity:"1",visible:!0},g=Object.keys(d),l=0;l<g.length;l++)p=g[l],"undefined"==typeof h[p]&&(h[p]="undefined"!==typeof k[p]?k[p]:d[p])}}}}function S(){if(null!=f.objParams&&"undefined"!=typeof f.objParams.levels&&null!=
f.objParams.levels)for(var a=f.objParams.levels,c=a.length,b=f.objParams.id,d=0;d<c;d++){var h=a[d];try{if("undefined"==typeof e.chart.StyleObject.indicators[b].levels[d])continue}catch(k){continue}var g=e.chart.StyleObject.indicators[b].levels[d];"undefined"!=typeof g.stroke&&(h.stroke=g.stroke);"undefined"!=typeof g.strokeOpacity&&(h.strokeOpacity=g.strokeOpacity);"undefined"!=typeof g.strokeWidth&&(h.strokeWidth=g.strokeWidth);"undefined"!=typeof g.strokeDasharray&&(h.strokeDasharray=g.strokeDasharray);
"undefined"==typeof h.visible&&(h.visible=!0)}}function ga(a){f.objParams=a;C();D();E();S();I();T();a=$("#indicator-inner .properties-tabs a");for(var c=$("#indicator-inner .main-properties"),b=0;b<a.length;b++)if("none"!=$(a[b]).css("display")){$(a[b]).addClass("active");$(c[b]).css("display","block");break}F()}function C(a){var c=$("#tbody-parameters");$(c).html("");var b=[];b.push('<td data-localize="dialogs.indicator.parameters.%capid%">%caption%</td><td><input id="%inputid%" class="param-spinner onlynumeric"/></td>');
b.push('<td data-localize="dialogs.indicator.parameters.%capid%">%caption2%</td><td><input id="%inputid2%" class="param-spinner onlynumeric"/></td>');var d=/%caption%/g,e=/%inputid%/g,k=/%caption2%/g,g=/%inputid2%/g,l=/%capid%/g,p=f.objParams.parameters;a=[];for(var m=0;m<p;m++){for(var q=f.objParams["param"+(m+1)],n="param"+(m+1),r=$("<tr></tr>"),s=q.values.length,v=0;v<s;v++){var t="param"+(m+1)+"_"+v,y="";switch(v){case 0:y=q.caption.toLowerCase().replace(/\s+/g,"");y=b[v].replace(d,q.caption).replace(e,
t).replace(l,y);$(r).append(y);break;case 1:y=q.caption2.toLowerCase().replace(/\s+/g,""),y=b[v].replace(k,q.caption2).replace(g,t).replace(l,y),$(r).append(y)}}a.push(!1!=q.editable);if(!1!=q.editable)for($(c).append(r),r=0;r<s;r++){var v="param"+(m+1)+"_"+r,t=1,y=0,Y=99999,u=0;try{u=q.values[r]}catch(w){u=0}try{t=q.steps[r]}catch(x){t=1}try{y=q.min[r]}catch(z){y=0}try{Y=q.max[r]}catch(A){Y=99999}K("#"+v,y,Y,t,u);L("#"+v,n,r)}}c=!1;for(m=0;m<a.length;m++)c=c||a[m];!1==c&&$("#tab-param").css("display",
"none")}function D(){var a=f.objParams.sourceEditable;if("undefined"!=typeof a&&!1!=a){a=$("#tbody-sources");a.html("");$(a).append(e.patterns.indicators.indicator_source);for(var a=f.objParams.parameters,c=0;c<a;c++)for(var b=f.objParams["param"+(c+1)],d=b.source.length,h=0;h<d;h++)if("value"!=b.source[h]){$("#select-source").val(b.source[h]);break}$("#select-source").on("change",function(){for(var a=$(this).val(),b=f.objParams.parameters,c=0;c<b;c++)for(var d=f.objParams["param"+(c+1)],e=d.source.length,
h=0;h<e;h++)"value"!=d.source[h]&&(d.source[h]=a);t(r.Value)})}}function I(){var a=$("#tbody-styles");$(a).html("");for(var c=f.objParams.renderitems,b=0;b<c;b++){var d=f.objParams["renderitem"+(b+1)],h="renderitem"+(b+1),k="";switch(d.drawtype){case "columns":k=e.patterns.indicators.indicator_style.replace(/%indicator_style_adv%/g,e.patterns.indicators.indicator_style_columns);break;default:k=e.patterns.indicators.indicator_style.replace(/%indicator_style_adv%/g,e.patterns.indicators.indicator_style_default)}d=
k.replace(/%caption%/g,d.caption).replace(/%renderitem%/g,h);$(a).append(d);M("#"+h,h)}}function ca(a){if("undefined"!=typeof e.init.indicators)for(var c=e.init.indicators,b=0;b<c.length;b++)if(c[b].id==a)return!0;return!1}function da(a,c,b){"undefined"!=typeof e.init.indicators&&(e.init.gui.indicatorsAdd(a,c,b),J())}function V(a){"undefined"!=typeof e.init.indicators&&(e.init.gui.indicatorsRemove(a),J())}function ta(){$("ul.favorite-indicators-list .openindicator").on("click",function(){if(!x()){var a=
$(this).parent().attr("idx").replace("indicator-",""),c=w(a);e.chart.AddStudyWithParams(a,c);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}});$("ul.favorite-indicators-list .li-indicator .a-property-favorite").on("click",function(){var a=$(this).parent().attr("idx"),c=$(this).parent().find("span").html();U(a,c)});$("ul.favorite-indicators-list .li-indicator .star-button").on("click",function(){var a=$(this).parent().attr("idx");V(a.replace("indicator-",
""));a=$('ul.indicators-list .li-indicator[id="'+a+'"] .star-button');$(a).removeClass(n.icon_prefix+"startenabled-icon").addClass(n.icon_prefix+"stardisabled-icon")});$("ul.favorite-indicators-list .li-indicator .add-favorite").on("click",function(){if(!x()){var a=$(this).parent().attr("idx").replace("indicator-",""),c=w(a);e.chart.AddStudyWithParams(a,c);if(typeof e.events.study.onDialogAddStudy==typeof Function)e.events.study.onDialogAddStudy(a,$("#chart-dialog"))}})}function J(){var a=$("ul.favorite-indicators-list");
$(a).html("");if("undefined"!=typeof e.init.indicators)for(var c=e.init.indicators,b=0;b<c.length;b++){var d=e.patterns.indicators.indicatorsform_favorites_row.replace(/%icon-source%/g,n.icon_source).replace(/%icon-prefix%/g,n.icon_prefix).replace(/%id%/g,c[b].id).replace(/%caption%/g,c[b].n).replace(/%title%/g,c[b].d);$(a).append(d)}ta();"undefined"!=typeof e.menuobj&&e.menuobj.gui.updateIndicatorFavorites()}function T(){var a=f.objParams.levels;if("undefined"==typeof a||null==a)$("#tab-level").css("display",
"none");else{var c=a.length,b=$("#tbody-indicatorlevels");$(b).html("");for(var d=0;d<c;d++){var h="level"+d,k=e.patterns.indicators.indicator_level.replace(/%id%/g,d).replace(/%levelvalue%/g,a[d].value).replace(/%levelitem%/g,h).replace(/%capid%/g,"level"+(d+1)).replace(/%caption%/g,"Level "+(d+1));$(b).append(k);ua("#"+h,d)}}}function t(a){if(null!=f.objStudyInfo&&null!=f.objParams&&""!=f.id&&!0==f.editStatus)switch(a){case r.All:e.chart.UpdateStudyAll(f.objParams);break;case r.Draw:e.chart.UpdateStudyDrawType(f.objParams);
break;case r.Value:e.chart.UpdateStudyValues(f.objParams);break;case r.Style:e.chart.UpdateStudyStyle(f.objParams);break;default:e.chart.UpdateStudyAll(f.objParams)}}function M(a,c){var b="undefined"!=typeof f.objParams.base,d=f.objParams[c],h=d.style[0],k=$(a).find(".line-color"),g=h.stroke;O($(k),g);var l=$(a).find(".line-color-alt"),p=h.stroke;"undefined"!=typeof d.style[1]&&(p=d.style[1].stroke);O($(l),p);var m=$(a).find(".line-width"),p=h.strokeWidth;$(m).slider({min:1,max:6});$(m).slider("option",
"value",p);var q=$(a).find(".line-opacity");$(q).slider({min:0,max:100});p=100*h.fillOpacity;$(q).slider("option","value",p);$(q).find("div.gradient").css("background-image","linear-gradient(to left, "+g+" 0%, transparent 100% )");d=d.drawtype;g="Line Histogram Ch-Histogram C-Histogram Area Dots".split(" ");p="line histogram changehistogram centeredhistogram area dots".split(" ");switch(d){case "channel":g=["Channel"];p=["channel"];break;case "columns":g=["Columns"];p=["columns"];break;default:g=
"Line Histogram Ch-Histogram C-Histogram Area Dots".split(" "),p="line histogram changehistogram centeredhistogram area dots".split(" ")}for(var n=$(a).find(".linedesign-type"),w=/%val%/g,x=/%Val%/g,v=0;v<g.length;v++)if(!1!=b||"changehistogram"!=p[v]&&"centeredhistogram"!=p[v]){var sa='<option data-localize="dialogs.indicator.linetype.%val%" value="%val%">%Val%</option>'.replace(w,p[v]).replace(x,g[v]);$(n).append(sa)}"undefined"!=typeof d&&($(n).val(d),$(q).css("display","area"==d||"channel"==d?
"block":"none"),$(m).css("display","area"!=d&&"channel"!=d?"block":"none"),$(a).find(".color-alt").css("display","changehistogram"==d||"centeredhistogram"==d?"block":"none"));if("columns"==d){b=h.opacity;s=[];u=[];d=h.visible;b*=100;g=$("#color-opacity-columns");g.slider({min:0,max:100});g.slider("option","value",b);g.find("div.gradient").css("background-image","linear-gradient(to left, #000000 0%, transparent 100% )");g.slider(d?"enable":"disable");g="true"==h.borderVisible||!0==h.borderVisible;
s.push({ctr:"color-columns-up-column",json:"up.fill",opacity:b,status:d?"enable":"disable",borderprop:0},{ctr:"color-columns-down-column",json:"down.fill",opacity:b,status:d?"enable":"disable",borderprop:0},{ctr:"color-columns-up-border",json:"up.stroke",opacity:b,status:d&&g?"enable":"disable",borderprop:1},{ctr:"color-columns-down-border",json:"down.stroke",opacity:b,status:d&&g?"enable":"disable",borderprop:1},{ctr:"color-columns-flat-column",json:"flat.fill",opacity:b,status:d?"enable":"disable",
borderprop:0},{ctr:"color-columns-flat-border",json:"flat.stroke",opacity:b,status:d&&g?"enable":"disable",borderprop:1});u.push({ctr:"control-columns-border",json:"borderVisible",status:d?!0:!1});for(b=0;b<s.length;b++)d=e.commonutils.func.parseColorString(P(h,s[b].json)),d="rgb(%r%, %g%, %b%)".replace("%r%",d[0]).replace("%g%",d[1]).replace("%b%",d[2]),O($("#"+s[b].ctr),d),$("#"+s[b].ctr).spectrum(s[b].status);for(b=0;b<u.length;b++){d=P(h,u[b].json);if(null==d)break;$("#"+u[b].ctr).attr("disabled",
!u[b].status);"true"==d.toLowerCase()?$("#"+u[b].ctr).attr("checked","true"==d.toLowerCase()):$("#"+u[b].ctr).removeAttr("checked")}va()}b=$(a).find(".line-visible");$(b).prop("checked",h.visible);$(q).slider(h.visible?"enable":"disable");$(k).spectrum(h.visible?"enable":"disable");$(m).slider(h.visible?"enable":"disable");$(n).prop("disabled",h.visible?!1:!0);$(l).spectrum(h.visible?"enable":"disable");$(k).attr("ritem",c);$(n).attr("ritem",c);$(m).attr("ritem",c);$(q).attr("ritem",c);$(b).attr("ritem",
c);$(l).attr("ritem",c);$(n).on("change",function(){var b=$(this).val();$(a).find(".linedesign-type").val(b);$(a).find(".line-opacity").css("display","area"==b?"block":"none");$(a).find(".line-width").css("display","area"!=b?"block":"none");$(a).find(".color-alt").css("display","changehistogram"==b||"centeredhistogram"==b?"block":"none");var c=$(this).attr("ritem");f.objParams[c].drawtype=b;t(r.Draw)});$(b).on("change",function(a){a=$(this).is(":checked");$(q).slider(a?"enable":"disable");$(k).spectrum(a?
"enable":"disable");$(m).slider(a?"enable":"disable");$(n).prop("disabled",a?!1:!0);$(l).spectrum(a?"enable":"disable");for(var b=$(this).attr("ritem"),c=0;c<f.objParams[b].style.length;c++)f.objParams[b].style[c].visible=a;try{var d="true"==f.objParams[b].style[0].borderVisible||!0==f.objParams[b].style[0].borderVisible;if("columns"==f.objParams[b].drawtype){for(b=0;b<u.length;b++)$("#"+u[b].ctr).attr("disabled",!a);for(b=0;b<s.length;b++)s[b].status=0==s[b].borderprop?a?"enable":"disable":a&&d?
"enable":"disable",$("#"+s[b].ctr).spectrum(s[b].status);$("#color-opacity-columns").slider(a?"enable":"disable")}}catch(e){}t(r.Style)});$(k).on("change",function(){var a=$(this).spectrum("get").toHexString();$(q).find("div.gradient").css("background-image","linear-gradient(to left, "+a+" 0%, transparent 100% )");var b=$(this).attr("ritem");f.objParams[b].style[0].stroke=a;f.objParams[b].style[0].fill=a;t(r.Style)});$(l).on("change",function(){var a=$(this).spectrum("get").toHexString(),b=$(this).attr("ritem");
f.objParams[b].style[1].stroke=a;t(r.Style)});$(m).on("slidechange",function(){for(var a=$(this).slider("option","value"),b=$(this).attr("ritem"),c=0;c<f.objParams[b].style.length;c++)f.objParams[b].style[c].strokeWidth=a;t(r.Style)});$(q).on("slidechange",function(){var a=$(this).slider("option","value")/100,b=$(this).attr("ritem");f.objParams[b].style[0].fillOpacity=a;t(r.Style)})}function va(){wa("#control-columns-border","#color-columns-up-border","#color-columns-down-border","#color-columns-flat-border",
null,null);$(".class-columns-study-color").on("change",function(){var a=$(this).spectrum("get").toRgbString();$(this).spectrum("get").toHexString();for(var c=$(this).attr("id"),b=$(this).attr("ritem"),d=0;d<s.length;d++)if(s[d].ctr==c){var h=s[d].opacity,k=e.commonutils.func.parseColorString(a),h="rgba(%r%, %g%, %b%, %a%)".replace("%r%",k[0]).replace("%g%",k[1]).replace("%b%",k[2]).replace("%a%",h);H(f.objParams[b].style[0],s[d].json,h);t(r.Style);z.debug("style",f.objParams[b].style)}});$("#color-opacity-columns").on("slidechange",
function(){var a=$(this).slider("option","value"),c=$(this).attr("ritem");H(f.objParams[c].style[0],"opacity",a/100);for(var b=0;b<s.length;b++){s[b].opacity=a/100;var d=e.commonutils.func.parseColorString(P(f.objParams[c].style[0],s[b].json)),d="rgba(%r%, %g%, %b%, %a% )".replace("%r%",d[0]).replace("%g%",d[1]).replace("%b%",d[2]).replace("%a%",a/100);H(f.objParams[c].style[0],s[b].json,d)}t(r.Style)})}function wa(a,c,b,d,e,k){$(a).on("click",function(a){var l=$(this);a=$(this).attr("id");l.is(":checked")?
(null!=k&&$(k).slider("enable"),null!=e&&$(e).slider("enable"),null!=c&&$(c).spectrum("enable"),null!=b&&$(b).spectrum("enable"),null!=d&&$(d).spectrum("enable")):(null!=k&&$(k).slider("disable"),null!=e&&$(e).slider("disable"),null!=c&&$(c).spectrum("disable"),null!=b&&$(b).spectrum("disable"),null!=d&&$(d).spectrum("disable"));for(var l=l.is(":checked"),p=$(this).attr("ritem"),m=0;m<u.length;m++)u[m].ctr==a&&(H(f.objParams[p].style[0],u[m].json,l?"true":"false"),t(r.Style))})}function ua(a,c){var b=
f.objParams.levels[c],d=$(a).find(".line-color"),e=b.stroke;O($(d),e);var k=$(a).find(".line-width"),g=b.strokeWidth;$(k).slider({min:1,max:6});$(k).slider("option","value",g);var l=$(a).find(".line-opacity");$(l).slider({min:0,max:100});g=100*b.fillOpacity;$(l).slider("option","value",g);$(l).find("div.gradient").css("background-image","linear-gradient(to left, "+e+" 0%, transparent 100% )");for(var e=b.strokeDasharray,g=["Solid","Doted","Dashed"],p=["solid","doted","dashed"],m=$(a).find(".linedesign-type"),
q=/%val%/g,n=/%Val%/g,s=0;s<g.length;s++){var u='<option <option data-localize="dialogs.common.linetype.%val%" value="%val%">%Val%</option>'.replace(q,p[s]).replace(n,g[s]);$(m).append(u)}"undefined"!=typeof e&&$(m).val(e);e=$(a).find(".levelinput");g=$(a).find(".line-visible");$(g).prop("checked",b.visible);$(l).slider(b.visible?"enable":"disable");$(d).spectrum(b.visible?"enable":"disable");$(k).slider(b.visible?"enable":"disable");$(m).prop("disabled",b.visible?!1:!0);$(e).prop("disabled",b.visible?
!1:!0);$(d).attr("rlevel",c);$(m).attr("rlevel",c);$(k).attr("rlevel",c);$(l).attr("rlevel",c);$(g).attr("rlevel",c);$(e).attr("rlevel",c);$(m).on("change",function(){var b=$(this).val();$(a).find(".linedesign-type").val(b);$(a).find(".line-opacity").css("display","area"==b?"block":"none");$(a).find(".line-width").css("display","area"!=b?"block":"none");var c=$(this).attr("rlevel");f.objParams.levels[c].strokeDasharray=b;t(r.Draw)});$(g).on("change",function(a){a=$(this).is(":checked");$(l).slider(a?
"enable":"disable");$(d).spectrum(a?"enable":"disable");$(k).slider(a?"enable":"disable");$(m).prop("disabled",a?!1:!0);var b=$(this).attr("rlevel");f.objParams.levels[b].visible=a;t(r.Style)});$(d).on("change",function(){var a=$(this).spectrum("get").toHexString();$(l).find("div.gradient").css("background-image","linear-gradient(to left, "+a+" 0%, transparent 100% )");var b=$(this).attr("rlevel");f.objParams.levels[b].stroke=a;t(r.Style)});$(k).on("slidechange",function(){var a=$(this).slider("option",
"value"),b=$(this).attr("rlevel");f.objParams.levels[b].strokeWidth=a;t(r.Style)});$(l).on("slidechange",function(){var a=$(this).slider("option","value")/100,b=$(this).attr("rlevel");f.objParams.levels[b].fillOpacity=a;t(r.Style)});$(e).on("change",function(){if(""!=$(this).val()&&$.isNumeric($(this).val())){$(this).attr("prevvalue",$(this).val());var a=$(this).attr("rlevel");f.objParams.levels[a].value=$(this).val();t(r.Style)}else $(this).val($(this).attr("prevvalue"))});$(e).on("keydown",function(a){13==
a.keyCode&&(""!=$(this).val()&&$.isNumeric($(this).val())?(a=$(this).attr("rlevel"),f.objParams.levels[a].value=$(this).val(),t(r.Style)):$(this).val($(this).attr("prevvalue")))})}function K(a,c,b,d,e){$(a).spinner({min:c,max:b,step:d});$(a).spinner("value",e)}function L(a,c,b){$(a).spinner({stop:function(a,e){var k=$(this).spinner("value");f.objParams[c].values[b]=k;t(r.Value)}})}function xa(a,c){function b(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function d(a){var b=
e.patterns.common.eye_orange.replace(/%icon-source%/g,n.icon_source).replace(/%icon-prefix%/g,n.icon_prefix);$(a).find(".ui-dialog-buttonset").prepend(b).on("click",function(){var a=$(".chart-ui-dialog.indicators-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":2;$(".chart-ui-dialog.indicators-dialog").css("opacity",a);$(this).css("opacity",b)})}var h="Close",f=c,g="";"undefined"!=typeof e.localizationobj&&(h=e.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),f=e.localizationobj.gui.returnLocalizationString("dialogs.indicators.title",
c));"undefined"!=typeof e.init.TemplateName&&(g=e.init.TemplateName);var l="";"rtl"==e.localizationobj.gui.returnCurrentLanguage().direction&&(l="dir-rtl");$('<div id="chart-dialog" title="'+f+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog indicators-dialog "+g+" "+l,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(a,b){d($(this).parent());$(".ui-widget-overlay").last().addClass("chart-ui-widget-overlay");if(e.api.props){var c=
e.api.props.chart.gui.layout.zindex_dialog;$(".chart-ui-widget-overlay").css({"z-index":c});$(".chart-ui-dialog").css({"z-index":c})}$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});Q()},close:function(a,c){$(".ui-widget-overlay").removeClass("chart-ui-widget-overlay");b($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.indicators-dialog  adv-buttons."+n.icon_prefix+"eye-orange").off().remove();$("div.chart-ui-dialog.indicators-dialog").off().remove();
$(this).off().empty().remove()},buttons:[{id:"btn-dialogs-close",text:h,click:function(){$(this).dialog("close")}}]})}function ya(a,c){function b(){R.trigger()}function d(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function h(a,b){var c=this;c.wait=!1;c.delta=200;c.end=a;c.trigger=function(a){c.wait||(c.wait=!0,setTimeout(function(){c.end&&c.end.call(a);c.wait=!1},c.delta))}}var f="Close",g=c,l="";"undefined"!=typeof e.localizationobj&&(f=e.localizationobj.gui.returnLocalizationString("dialogs.common.button-close",
"Close"),g=e.localizationobj.gui.returnLocalizationString("dialogs.indicators.title",c));"undefined"!=typeof e.init.TemplateName&&(l=e.init.TemplateName);var p="";"rtl"==e.localizationobj.gui.returnCurrentLanguage().direction&&(p="dir-rtl");$('<div id="chart-dialog" title="'+g+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog chart-ui-mob-dialog indicators-dialog "+l+" "+p,draggable:!1,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:window.innerWidth?window.innerWidth:
$(window).width(),height:window.innerHeight?window.innerHeight:$(window).height(),modal:!0,open:function(a,c){$(".ui-widget-overlay").last().addClass("chart-ui-widget-overlay");if(e.api.props){var d=e.api.props.chart.gui.layout.zindex_dialog;$(".chart-ui-widget-overlay").css({"z-index":d});$(".chart-ui-dialog").css({"z-index":d})}$(".ui-widget-overlay").bind("click",function(){$("#chart-dialog").dialog("close")});R=new h(function(){$("#chart-dialog").dialog({width:window.innerWidth?window.innerWidth:
$(window).width(),height:window.innerHeight?window.innerHeight:$(window).height()})},600);$(window).off("resize",b);$(window).on("resize",b);Q()},close:function(a,c){$(".ui-widget-overlay").removeClass("chart-ui-widget-overlay");d($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.indicators-dialog  adv-buttons."+n.icon_prefix+"eye-orange").off().remove();$("div.chart-ui-dialog.indicators-dialog").off().remove();$(this).off().empty().remove();$(window).off("resize",b)},buttons:[{id:"btn-dialogs-close",
text:f,click:function(){$(this).dialog("close")}}]})}function ra(a,c,b){function d(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function h(a){var b=e.patterns.indicators.indicator_button_settings;a=$(a).find(".ui-dialog-buttonset").prepend(b);$(a).find("#button-reset-settings-indicator").button().on("click",function(){z.debug("button-reset-settings-indicator");aa()});$(a).find("#button-save-settings-indicator").button().on("click",function(){z.debug("button-save-settings-indicator");
Z()})}function f(a){var b=e.patterns.common.eye_orange.replace(/%icon-source%/g,n.icon_source).replace(/%icon-prefix%/g,n.icon_prefix);a=$(a).find(".ui-dialog-buttonset").prepend(b);$(a).find(".eye-orange").on("click",function(){var a=$(".chart-ui-dialog.indicator-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":1;$(".chart-ui-dialog.indicator-dialog").css("opacity",a);$(this).css("opacity",b)})}a="Close";b="";"undefined"!=typeof e.localizationobj&&(a=e.localizationobj.gui.returnLocalizationString("dialogs.common.button-close",
"Close"),e.localizationobj.gui.returnLocalizationString("dialogs.common.button-cancel","Cancel"));"undefined"!=typeof e.init.TemplateName&&(b=e.init.TemplateName);var g="";"rtl"==e.localizationobj.gui.returnCurrentLanguage().direction&&(g="dir-rtl");$('<div id="chart-dlgindicator" title="'+c+'"><div id="indicator-inner" class="dialog_level"></div></div>').insertAfter("body");$("#chart-dlgindicator").dialog({dialogClass:"chart-ui-dialog indicator-dialog "+b+" "+g,draggable:!0,autoOpen:!1,resizable:!1,
closeOnEscape:!0,width:"auto",modal:!0,open:function(a,b){f($(this).parent());h($(this).parent());$(".ui-widget-overlay").last().addClass("chart-ui-widget-overlay");if(e.api.props){var c=e.api.props.chart.gui.layout.zindex_dialog;$(".chart-ui-widget-overlay").css({"z-index":c});$(".chart-ui-dialog").css({"z-index":c})}$(".ui-widget-overlay").bind("click",function(){$("#chart-dlgindicator").dialog("close")});Q()},close:function(a,b){d($(this).parent());$("div.chart-ui-dialog.indicator-dialog  adv-buttons."+
n.icon_prefix+"eye-orange").off().remove();$("#chart-dlgindicator").remove();$(this).off().empty().remove()},buttons:[{id:"btn-order-ok",text:a,click:function(){$(this).dialog("close")}}]})}function qa(a,c,b){function d(a,b){var c=this;c.wait=!1;c.delta=200;c.end=a;c.trigger=function(a){c.wait||(c.wait=!0,setTimeout(function(){c.end&&c.end.call(a);c.wait=!1},c.delta))}}function h(){R.trigger()}function f(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function g(a){var b=
e.patterns.common.eye_orange.replace(/%icon-source%/g,n.icon_source).replace(/%icon-prefix%/g,n.icon_prefix);$(a).find(".ui-dialog-buttonset").prepend(b).on("click",function(){var a=$(".chart-ui-dialog.indicator-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":1;$(".chart-ui-dialog.indicator-dialog").css("opacity",a);$(this).css("opacity",b)})}a="Close";b="";"undefined"!=typeof e.localizationobj&&(a=e.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),e.localizationobj.gui.returnLocalizationString("dialogs.common.button-cancel",
"Cancel"));"undefined"!=typeof e.init.TemplateName&&(b=e.init.TemplateName);var l="";"rtl"==e.localizationobj.gui.returnCurrentLanguage().direction&&(l="dir-rtl");$('<div id="chart-dlgindicator" title="'+c+'"><div id="indicator-inner" class="dialog_level"></div></div>').insertAfter("body");$("#chart-dlgindicator").dialog({dialogClass:"chart-ui-dialog indicator-dialog chart-ui-mob-dialog  "+b+" "+l,draggable:!1,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:window.innerWidth?window.innerWidth:$(window).width(),
height:window.innerHeight?window.innerHeight:$(window).height(),modal:!0,open:function(a,b){g($(this).parent());$(".ui-widget-overlay").last().addClass("chart-ui-widget-overlay");if(e.api.props){var c=e.api.props.chart.gui.layout.zindex_dialog;$(".chart-ui-widget-overlay").css({"z-index":c});$(".chart-ui-dialog").css({"z-index":c})}$(".ui-widget-overlay").bind("click",function(){$("#chart-dlgindicator").dialog("close")});Q();R=new d(function(){$("#chart-dlgindicator").dialog({width:window.innerWidth?
window.innerWidth:$(window).width(),height:window.innerHeight?window.innerHeight:$(window).height()})},600);$(window).off("resize",h);$(window).on("resize",h)},close:function(a,b){f($(this).parent());$("div.chart-ui-dialog.indicator-dialog  adv-buttons."+n.icon_prefix+"eye-orange").off().remove();$("#chart-dlgindicator").remove();$(this).off().empty().remove();$(window).off("resize",h)},buttons:[{id:"btn-order-ok",text:a,click:function(){$(this).dialog("close")}}]})}function O(a,c,b){$(a).spectrum({color:c,
showPalette:!0,showPaletteOnly:!1,clickoutFiresChange:!1,showButtons:!1,palette:["rgb(0, 0, 0);{rgb(66, 66, 66);{rgb(101, 101, 101);{rgb(152, 152, 152);{rgb(182, 182, 182);{rgb(203, 203, 203);{rgb(216, 216, 216);{rgb(238, 238, 238);{rgb(242, 242, 242);{rgb(255, 255, 255);".split("{"),"rgb(151, 0, 0);{rgb(255, 0, 0);{rgb(255, 152, 0);{rgb(255, 255, 0);{rgb(0, 255, 0);{rgb(0, 255, 255);{rgb(73, 133, 231);{rgb(0, 0, 255);{rgb(152, 0, 255);{rgb(255, 0, 255);".split("{"),"rgb(230, 184, 175);{rgb(244, 204, 204);{rgb(252, 229, 205);{rgb(255, 242, 204);{rgb(217, 234, 211);{rgb(208, 224, 227);{rgb(201, 218, 248);{rgb(207, 226, 243);{rgb(217, 210, 233);{rgb(234, 209, 220);".split("{"),
"rgb(221, 126, 107);{rgb(234, 153, 153);{rgb(249, 203, 156);{rgb(255, 229, 153);{rgb(182, 215, 168);{rgb(162, 196, 201);{rgb(164, 194, 244);{rgb(159, 197, 232);{rgb(180, 167, 214);{rgb(213, 166, 189);".split("{"),"rgb(204, 65, 37);{rgb(224, 102, 102);{rgb(246, 178, 107);{rgb(255, 217, 102);{rgb(147, 196, 125);{rgb(118, 165, 175);{rgb(109, 158, 235);{rgb(111, 168, 220);{rgb(142, 124, 195);{rgb(194, 123, 160);".split("{"),"rgb(166, 28, 0);{rgb(204, 0, 0);{rgb(230, 145, 56);{rgb(241, 194, 50);{rgb(106, 168, 79);{rgb(69, 129, 142);{rgb(60, 120, 216);{rgb(61, 133, 198);{rgb(103, 78, 167);{rgb(166, 77, 121);".split("{"),
"rgb(133, 32, 12);{rgb(153, 0, 0);{rgb(180, 95, 6);{rgb(191, 144, 0);{rgb(56, 118, 29);{rgb(19, 79, 92);{rgb(17, 85, 204);{rgb(11, 83, 148);{rgb(53, 28, 117);{rgb(116, 27, 71);".split("{"),"rgb(91, 15, 0);{rgb(102, 0, 0);{rgb(120, 63, 4);{rgb(127, 96, 0);{rgb(39, 78, 19);{rgb(12, 52, 61);{rgb(28, 69, 135);{rgb(7, 55, 99);{rgb(32, 18, 77);{rgb(76, 17, 48);".split("{")]})}function G(){$(".properties-tabs").delegate("a","click",function(){var a=$(this).parents(".dialog_level"),c=$(a).find(".properties-tabs a").index(this);
$(a).find(".main-properties").each(function(){$(this).css("display","none")});$(a).find(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(a).find(".main-properties").eq(c).css("display","block");$(this).addClass("active")})}function N(a){$(".action-move-button-indicator").off();$(".action-move-button-indicator").on("click",function(){var c=$(this),b=c.attr("tid"),d=c.attr("tpanelid"),h="";""==d&&(d=null,c.hasClass("panel-top")?h="top":c.hasClass("panel-bottom")&&(h="bottom"));
c=c.attr("tguiid");z.debug("Move indicator",b,d,c);a:{for(var b=e.chart.GetLegendInfo(),k=0;k<b.length;k++)for(var g=b[k],l=0;l<g.fields.length;l++)if(g.fields[l].uid==a){b=g.id;break a}b=null}null==b&&(b=e.chart.GetPanelIDByDefID(a));e.chart.MoveStudyToOtherPanel(c,b,d,h);d=X(null,f.objStudyInfo,a);$("#tbody-indicatorpanels").html(d);N(a)});$(".action-add-button-indicator").off();$(".action-add-button-indicator").on("click",function(){if(!x()){var a=$(this),b=a.attr("tid"),d=a.attr("tpanelid"),h=
a.attr("tguiid");z.debug("Add indicator",b,d,h);$("#button-add-indicator").button({disabled:!0});$("#button-add-indicator-to").button({disabled:!0});$("#dialog-panels-page").css("display","none");$("#dialog-indicator-page").css("display","block");$("#tab-panels").css("display","");h=1;"undefined"==typeof h&&(h=1);for(var k=$("#dlg-indicators .main-page").eq(1).find(".title_level"),g=0;g<k.length;g++)$(k[g]).removeClass("active"),g>h&&$(k[g]).css("display","none");$(k[h]).css("display","block").addClass("active");
h="";""==d&&(d=null,a.hasClass("panel-top")?h="top":a.hasClass("panel-bottom")&&(h="bottom"));f.id=b;f.objStudyInfo=e.chart.AddStudyWithParams(f.id,f.objParams,d,h);null!=f.objStudyInfo&&(f.objParams=f.objStudyInfo,f.editStatus=!0);a=e.chart.GetLegendIDByDefID(f.objStudyInfo.UID);b=X(null,f.objStudyInfo,a);$("#tbody-indicatorpanels").html(b);N(a)}})}function W(a,c,b){"undefined"==typeof b&&(b=a);a=$("#dlg-indicators .main-page").eq(a).find(".title_level");for(var d=0;d<a.length;d++)$(a[d]).removeClass("active"),
d>b&&$(a[d]).css("display","none");$(a[b]).find("a").html(c);$(a[b]).css("display","block").addClass("active")}function ea(){$(" .title_level").delegate("a","click",function(){for(var a=$(this).parents(".main-page"),c=$(a).find(".title_level a").index(this),b=$(a).find(".dialog_level"),d=0;d<b.length;d++){var e=d==c?"block":"none";$(b[d]).css("display",e)}a=$(a).find(".title_level");for(d=c+1;d<a.length;d++)$(a[d]).css("display","none").removeClass("active");$(a[c]).addClass("active")})}function fa(){$("#main-indicator-browser > li").on("click",
function(){var a=$("#main-indicator-browser > li").index(this),c=$(this).attr("id");$("#main-indicator-browser > li").removeClass("browser-item-selected");$("#main-indicator-browser #"+c).addClass("browser-item-selected");for(var c=$("#chart-dialog .main-page"),b=0;b<c.length;b++){var d=b==a?"block":"none";$(c[b]).css("display",d)}a=$(this).html();W(0,a)})}function P(a,c){var b=c.split(".");return 1==b.length?a[b[0]]:"undefined"!=typeof a[b[0]]?P(a[b[0]],b.slice(1).join(".")):null}function H(a,c,
b){c=c.split(".");1==c.length&&(a[c[0]]=b);"undefined"!=typeof a[c[0]]&&H(a[c[0]],c.slice(1).join("."),b)}function ka(a,c){for(var b=Object.keys(a),d=0;d<b.length;d++){var e=b[d];"undefined"==typeof c[e]&&(typeof a[e]==Object?(c[e]={},ka(a[e],c[e])):c[e]=a[e])}}function F(){$(".chart-ui-dialog .onlynumeric").prochart_numeric()}function ja(){"undefined"!=typeof e.preloadobj&&e.preloadobj.startPreload()}function Q(){"undefined"!=typeof e.preloadobj&&e.preloadobj.endPreload()}var e=B;B={};e.indicators=
B;var z=e.api.debug.getLogger("prochart.gui.indicators"),A="",r={All:0,Style:1,Draw:2,Value:3},n=e.api.layout.getbuttonStyle(),R=null,s=[],u=[],f={id:"",objStudyInfo:null,objParams:null,editStatus:!1};B.gui={viewIndicators:function(a){"undefined"==typeof a&&(a="indicators");ja();A="Indicators form";var c=e.commonutils.func.detectmob();c?ya("gannfan",A):xa("gannfan",A);a=e.patterns.indicators.indicatorsform.replace(/%favorites-selected%/g,"favorites"==a?"browser-item-selected":"").replace(/%indicators-selected%/g,
"favorites"==a?"":"browser-item-selected").replace(/%indicatorsfavorite-visible%/g,"favorites"==a?"block":"none").replace(/%indicatorslist-visible%/g,"indicators"==a?"block":"none");c?na(a):la(a)},viewIndicator:function(a,c){ia(c)},getIndicatorObjectParam:function(a){for(var c=w(a),b=c.renderitems,d=0;d<b;d++){var f=c["renderitem"+(d+1)],k={};"undefined"==typeof f.style&&(f.style=[],f.style.push(k));if("undefined"!=typeof e.chart.StyleObject[a+"_item"+(d+1)]){var g=e.chart.StyleObject[a+"_item"+(d+
1)];"undefined"==typeof k.stroke&&(k.stroke="undefined"!==typeof g.stroke?g.stroke:"rgb(0,0,0)");"undefined"==typeof k.strokeWidth&&(k.strokeWidth="undefined"!=typeof g.strokeWidth?g.strokeWidth:"1");"undefined"==typeof k.strokeOpacity&&(k.strokeOpacity="undefined"!=typeof g.strokeOpacity?g.strokeOpacity:"1");"undefined"==typeof k.fill&&"undefined"!=typeof g.fill&&(k.fill=g.fill);"undefined"==typeof k.fillOpacity&&(k.fillOpacity="undefined"!=typeof g.fillOpacity?g.fillOpacity:"1");"undefined"==typeof k.visible&&
(k.visible=!0);"undefined"!=typeof c.base&&(g={},g.stroke=k.stroke,g.strokeWidth=k.strokeWidth,g.strokeOpacity=k.strokeOpacity,g.visible=k.visible,g.fill=k.fill,g.fillOpacity=k.fillOpacity,f.style.push(g))}}if(null!=c&&"undefined"!=typeof c.levels&&null!=c.levels)for(b=c.levels,d=b.length,f=0;f<d;f++){k=b[f];try{if("undefined"==typeof e.chart.StyleObject.indicators[a].levels[f])continue}catch(l){continue}g=e.chart.StyleObject.indicators[a].levels[f];"undefined"!=typeof g.stroke&&(k.stroke=g.stroke);
"undefined"!=typeof g.strokeOpacity&&(k.strokeOpacity=g.strokeOpacity);"undefined"!=typeof g.strokeWidth&&(k.strokeWidth=g.strokeWidth);"undefined"!=typeof g.strokeDasharray&&(k.strokeDasharray=g.strokeDasharray)}return c},appendIndicator:function(a){if(!x()){var c=w(a);e.chart.AddStudyWithParams(a,c)}},deleteFromDefaultSetting:function(a){for(var c=e.apiinit.savedIndicatorsSetting,b=0;b<c.length;b++)if(c[b].id==a){c.splice(b,1);break}}};e.chart.UI.funcOnStudyEdit=ia;return B};
