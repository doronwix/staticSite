function ProChart_InitPanels(da){function N(a){for(var b=0;b<d.length;b++)switch(d[b].type){case a:return d[b]}return null}function ea(){var a=v.length;J();for(var b=0;b<a;b++)switch(v[b].type){case "price":fa(v[b].id);break;case "study":ga(v[b].id);break;case "signal":Y(v[b].id)}}function A(){var a=$.prochartcache.get(e.init.chartcontainer);if(2>d.length)x=[],a&&$(a).find(".chart-pane-splitter").remove();else{for(var b=[],a=[],c=0;c<d.length-1;c++)b.push({pane_before_guiid:d[c].guiid,pane_after_guiid:d[c+
1].guiid});for(c=x.length-1;0<=c;c--){for(var g=!1,f=0;f<b.length;f++)x[c].pane_before_guiid==b[f].pane_before_guiid&&x[c].pane_after_guiid==b[f].pane_after_guiid&&(g=!0);g||((f=$("#"+x[c].guiid))&&f.remove(),x.splice(c,1))}for(f=0;f<b.length;f++){g=!1;for(c=0;c<x.length;c++)x[c].pane_before_guiid==b[f].pane_before_guiid&&x[c].pane_after_guiid==b[f].pane_after_guiid&&(g=!0);g||a.push({pane_before_guiid:b[f].pane_before_guiid,pane_after_guiid:b[f].pane_after_guiid})}for(f=0;f<a.length;f++)b=ya(a[f].pane_before_guiid,
a[f].pane_after_guiid),$("#"+b.guiid).prochart_splitterh({handle:"",cursor:"n-resize",min:50,start:function(){e.chart.EnableSplitMode(!0);$.prochartcache.get(e.init.chartcontainer)&&$.prochartcache.get(e.init.chartcontainer).css({overflow:"hidden"})},resizing:function(b,c){for(var a=0;a<b.length;a++){var g=b[a];if("undefined"!=typeof g)for(var f=0;f<d.length;f++)if(d[f].guiid==g.id)switch(d[f].type){case "price":Z(d[f],g.width,g.height);if("undefined"!=typeof d[f].onResizePanel&&"function"==typeof d[f].onResizePanel)d[f].onResizePanel(d[f]);
break;case "study":ha(d[f],g.width,g.height);if("undefined"!=typeof d[f].onResizePanel&&"function"==typeof d[f].onResizePanel)d[f].onResizePanel(d[f]);break;case "signal":if(ia(d[f],g.width,g.height),"undefined"!=typeof d[f].onResizePanel&&"function"==typeof d[f].onResizePanel)d[f].onResizePanel(d[f])}}c&&e.chart.AdjustSize(null,null)},completed:function(){e.chart.AdjustSize(null,null);e.chart.EnableSplitMode(!1);$.prochartcache.get(e.init.chartcontainer)&&$.prochartcache.get(e.init.chartcontainer).css({overflow:"inherit"})}})}}
function ja(a){for(var b=0;b<a.length;b++){for(var c=0;c<v.length;c++)v[c].id==a[b].id&&v.splice(c,1);for(c=0;c<d.length;c++)if(d[c].id==a[b].id){s.guiid==d[c].guiid&&(s.guiid=null);var g="#"+d[c].guiid,f=$.prochartcache.get(e.init.chartcontainer,g);if(f){f.remove();try{$.prochartcache.clearByMask(g)}catch(k){}}d.splice(c,1)}}J();K();A();aa();a=[];for(b=0;b<d.length;b++)"study"!=d[b].type&&"price"!=d[b].type||a.push(d[b]);return a}function ka(a){for(var b={},c=0,g=a.length;c<g;c++){var f=a[c],d=f.id,
l="",h="";try{l=la(d).type,h=la(d).legend.guiid,b[h]={id:d,type:l,guid:h,fields:[]}}catch(m){T.warn("Not found panel and panel type",d);continue}for(var F=[],q=0;q<f.fields.length;q++)switch(f.fields[q].type){case "price":try{if(B(e.currenlayout.chart_panels.price.legend.view)){var n=f.fields[q],p=V(d);if(null!=p){if(!$.prochartcache.get("#"+p,"#"+n.uid)){var u=e.patterns.panels.legend_price.replace(/%id%/g,n.uid).replace(/%item_id%/g,n.editIdx).replace(/%icon-source%/g,G.icon_source).replace(/%icon-prefix%/g,
G.icon_prefix).replace(/%visible%/g,n.visible?"":"legend-visible-off").replace(/%item_type%/g,n.type);$.prochartcache.get("#"+p).append(u)}$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-description").html(n.name);$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-open.legend-title").html(e.localizationobj.gui.returnLocalizationString("chart."+n.captions[0],n.captions[0]));$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-low.legend-title").html(e.localizationobj.gui.returnLocalizationString("chart."+
n.captions[1],n.captions[1]));$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-high.legend-title").html(e.localizationobj.gui.returnLocalizationString("chart."+n.captions[2],n.captions[2]));$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-close.legend-title").html(e.localizationobj.gui.returnLocalizationString("chart."+n.captions[3],n.captions[3]));var v=e.api.props.chart.gui.legend.font_darklight_auto,s=e.api.props.chart.gui.legend.font_darklight_percent,w=e.commonutils.func.LightenDarkenColor(n.colors[0],
s,v);$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-open.legend-value").css("color",w).html(n.values[0]);var x=e.commonutils.func.LightenDarkenColor(n.colors[1],s,v);$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-low.legend-value").css("color",x).html(n.values[1]);var E=e.commonutils.func.LightenDarkenColor(n.colors[2],s,v);$.prochartcache.get("#"+p,"#"+n.uid,".legend-price-high.legend-value").css("color",E).html(n.values[2]);var R=e.commonutils.func.LightenDarkenColor(n.colors[3],s,v);$.prochartcache.get("#"+
p,"#"+n.uid,".legend-price-close.legend-value").css("color",R).html(n.values[3])}}F.push(f.fields[q].uid);b[h].fields.push(f.fields[q].uid)}catch(Fa){}break;case "study":switch(l){case "price":try{B(e.currenlayout.chart_panels.price.legend.view)&&ma(d)&&na(d,f.fields[q]),F.push(f.fields[q].uid),b[h].fields.push(f.fields[q].uid)}catch(r){}break;case "study":try{B(e.currenlayout.chart_panels.study.legend.view)&&ma(d)&&na(d,f.fields[q]),F.push(f.fields[q].uid),b[h].fields.push(f.fields[q].uid)}catch(t){}}break;
case "compare":try{if(B(e.currenlayout.chart_panels.price.legend.view)){var y=d,C=f.fields[q],O=V(y);if(null!=O){if(null==$.prochartcache.get("#"+O,"#"+C.uid)){var P=e.patterns.panels.legend_compare.replace(/%item_id%/g,C.editIdx).replace(/%icon-source%/g,G.icon_source).replace(/%icon-prefix%/g,G.icon_prefix).replace(/%item_type%/g,C.type).replace(/%visible%/g,C.visible?"":"legend-visible-off").replace(/%css%/g,!1==L(y)||"false"==L(y)?" hide-legend":"").replace(/%id%/g,C.uid);$.prochartcache.get("#"+
O).append(P)}var D=e.commonutils.func.LightenDarkenColor(C.colors[0],e.api.props.chart.gui.legend.font_darklight_percent,e.api.props.chart.gui.legend.font_darklight_auto);$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-description")&&$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-description").html(C.captions[0]);$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-title")&&$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-title").html(e.localizationobj.gui.returnLocalizationString("chart.close"));
$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-value")&&$.prochartcache.get("#"+O,"#"+C.uid,".legend-compare-value").css("color",D).html(C.values[0])}}F.push(f.fields[q].uid);b[h].fields.push(f.fields[q].uid)}catch(Ga){}break;case "plugin":try{if(B(e.currenlayout.chart_panels.plugin.legend.view)){var y=d,z=f.fields[q],Q=V(y);if(null!=Q){if(null==$.prochartcache.get("#"+Q,"#"+z.uid)){var M="";"undefined"!=z.titlelocalize&&(M='data-localize="'+z.titlelocalize+'"');var J=e.patterns.panels.legend_plugin.replace(/%display-closebt%/g,
z.closeBtn?"":"display:none").replace(/%item_id%/g,z.editIdx).replace(/%item_type%/g,z.type).replace(/%legend_title_localization%/g,M).replace(/%visible%/g,z.visible?"":"legend-visible-off").replace(/%css%/g,!1==L(y)||"false"==L(y)?" hide-legend":"").replace(/%id%/g,z.uid);$.prochartcache.get("#"+Q).append(J)}$.prochartcache.get("#"+Q,"#"+z.uid,".legend-plugin-description")&&$.prochartcache.get("#"+Q,"#"+z.uid,".legend-plugin-description").html(z.name)}}F.push(f.fields[q].uid);b[h].fields.push(f.fields[q].uid)}catch(A){}break;
case "signals.tc":try{if(B(e.currenlayout.chart_panels.price.legend.view)){var y=d,H=f.fields[q],U=V(y);if(null!=U){if(null==$.prochartcache.get("#"+U,"#"+H.uid)){var K=e.patterns.panels.legend_signaltc.replace(/%item_id%/g,H.editIdx).replace(/%icon-source%/g,G.icon_source).replace(/%icon-prefix%/g,G.icon_prefix).replace(/%item_type%/g,H.type).replace(/%visible%/g,H.visible?"":"legend-visible-off").replace(/%css%/g,!1==L(y)||"false"==L(y)?" hide-legend":"").replace(/%id%/g,H.uid);$.prochartcache.get("#"+
U).append(K)}$.prochartcache.get("#"+U,"#"+H.uid,".legend-signaltc-description")&&$.prochartcache.get("#"+U,"#"+H.uid,".legend-signaltc-description").html(H.captions[0]);$.prochartcache.get("#"+U,"#"+H.uid,".legend-signaltc-title")&&$.prochartcache.get("#"+U,"#"+H.uid,".legend-signaltc-title").html(e.localizationobj.gui.returnLocalizationString("chart.close"))}}F.push(f.fields[q].uid);b[h].fields.push(f.fields[q].uid)}catch(I){}}}a=!1;c=Object.keys(X);f=Object.keys(b);g=e.commonutils.func.intersection_difference(c,
f);f=e.commonutils.func.intersection_difference(f,c);c=g.res2;g=g.res1;f=f.res2;0<c.length&&(a=!0,T.debug("Deleted Panels:",c));0<f.length&&(a=!0,T.debug("Added Panesl",f));f=0;for(d=g.length;f<d;f++){l=g[f];h=X[l].type;q=X[l].fields;n=b[l].fields;F=e.commonutils.func.intersection_difference(q,n).res2;q=e.commonutils.func.intersection_difference(n,q).res2;0<F.length&&(T.debug("deleted legend",F),a=!0);0<q.length&&(a=!0,T.debug("added legend ",q));q=0;for(n=F.length;q<n;q++)switch(h){case "study":case "price":case "compare":case "plugin":case "signals.tc":p=
l,u=F[q],$.prochartcache.get("#"+p,"#"+u)&&($.prochartcache.get("#"+p,"#"+u).remove(),v=$.prochartcache.clearByMask("#"+p,"#"+u),T.debug("Delete Item by legnd, mask:","#"+p,"#"+u,v))}if(0<c.length)for(l=0,h=c.length;l<h;l++)$.prochartcache.clearByMask("#"+c[l])}X=jQuery.extend(!0,[],b);a&&(za(),Aa(),Ba(),b=N("price").guiid,$.prochartcache.update("#"+b,".legend-study, .legend-compare, .legend-signaltc"))}function na(a,b){var c=V(a);if(null!=c){if(null==$.prochartcache.get("#"+c,"#"+b.uid)){var g=e.patterns.panels.legend_study.replace(/%display-closebt%/g,
b.closeBtn?"":"display:none").replace(/%icon-source%/g,G.icon_source).replace(/%icon-prefix%/g,G.icon_prefix).replace(/%item_id%/g,b.editIdx).replace(/%item_type%/g,b.type).replace(/%visible%/g,b.visible?"":"legend-visible-off").replace(/%id%/g,b.uid).replace(/%css%/g,!1==L(a)||"false"==L(a)?" hide-legend":"");$.prochartcache.get("#"+c).append(g);if(1<b.values.length)for(var g=$.prochartcache.get("#"+c,"#"+b.uid,".legend-study-values"),f=$.prochartcache.get("#"+c,"#"+b.uid,".legend-study-values",
".legend-study-value").clone(!0),d=0;d<b.values.length-1;d++)g.append(f.clone(!0))}g="";for(f=0;f<b.sources.length;f++)f<b.sources.length&&0<g.length&&(g+=","),g+=e.localizationobj.gui.returnLocalizationString("dialogs.indicator.source."+b.sources[f],b.sources[f]).toLowerCase();for(f=0;f<b.params.length;f++)f<b.params.length&&0<g.length&&(g+=","),g+=b.params[f];0<g.length&&(g="("+g+")");$.prochartcache.get("#"+c,"#"+b.uid);$.prochartcache.get("#"+c,"#"+b.uid,".legend-study-description").html(b.name);
$.prochartcache.get("#"+c,"#"+b.uid," .legend-study-params").html(g);c=$.prochartcache.get("#"+c,"#"+b.uid,".legend-study-value");g=e.api.props.chart.gui.legend.font_darklight_auto;f=e.api.props.chart.gui.legend.font_darklight_percent;for(d=0;d<b.values.length;d++){var l=e.commonutils.func.LightenDarkenColor(b.colors[d],f,g);c.eq(d).css("color",l).html(b.values[d]?b.values[d]:"NaN")}}}function aa(){null!=s.guiid&&($.prochartcache.get("#"+s.guiid)&&$.prochartcache.get("#"+s.guiid).removeClass("controlpanel-button-selected"),
s.guiid=null)}function oa(){$.prochartcache.update(e.init.chartcontainer,".controlpanel-down");if($.prochartcache.get(e.init.chartcontainer,".controlpanel-down"))$.prochartcache.get(e.init.chartcontainer,".controlpanel-down").off().on("click",function(){var a=$(this).attr("itemid");pa(a,"down")})}function qa(){$.prochartcache.update(e.init.chartcontainer,".controlpanel-up");if($.prochartcache.get(e.init.chartcontainer,".controlpanel-up"))$.prochartcache.get(e.init.chartcontainer,".controlpanel-up").off().on("click",
function(){var a=$(this).attr("itemid");pa(a,"up")})}function pa(a,b){var c,g,f,k,l,h,m,p,q;if(!(2>d.length)){var n=["price","study"];switch(b){case "up":q=p=m=h=l=k=f=g=null;for(c=0;c<d.length;c++)if(d[c].guiid==a){h=d[c].guiid;m=c;p=d[c].id;q=d[c].type;break}else g=d[c].guiid,f=c,k=d[c].id,l=d[c].type;null==g?(c=d[d.length-1].guiid,g=d[d.length-1].id,I(d,m,d.length-1),$("#"+c).after($("#"+h)),-1<n.indexOf(q)&&e.chart.SwitchPanels(p,g,"bottom")):(I(d,m,f),$("#"+g).before($("#"+h)),-1<n.indexOf(l)&&
-1<n.indexOf(q)&&e.chart.SwitchPanels(k,p,"normal"));A();break;case "down":q=p=m=h=l=k=f=g=null;for(c=d.length-1;-1<c;c--)if(d[c].guiid==a){h=d[c].guiid;m=c;p=d[c].id;q=d[c].type;break}else g=d[c].guiid,f=c,k=d[c].id,l=d[c].type;null==g?(c=d[0].guiid,g=d[0].id,I(d,m,0),$("#"+c).before($("#"+h)),-1<n.indexOf(q)&&e.chart.SwitchPanels(p,g,"top")):(I(d,m,f),$("#"+g).after($("#"+h)),-1<n.indexOf(l)&&-1<n.indexOf(q)&&e.chart.SwitchPanels(k,p,"normal"));A();break;case "top":q=p=m=h=l=k=f=g=null;for(c=d.length-
1;-1<c;c--)if(d[c].guiid==a){h=d[c].guiid;m=c;p=d[c].id;q=d[c].type;break}else g=d[c].guiid,f=c,k=d[c].id,l=d[c].type;null==g?(c=d[0].guiid,g=d[0].id,I(d,m,0),$("#"+c).before($("#"+h)),-1<n.indexOf(q)&&e.chart.SwitchPanels(p,g,"top")):(I(d,m,f),$("#"+g).after($("#"+h)),-1<n.indexOf(l)&&-1<n.indexOf(q)&&e.chart.SwitchPanels(k,p,"normal"));A()}}}function I(a,b,c){var g=a[b];a.splice(b,1);a.splice(c,0,g)}function ra(){$.prochartcache.update(e.init.chartcontainer,".controlpanel-window");if($.prochartcache.get(e.init.chartcontainer,
".controlpanel-window"))$.prochartcache.get(e.init.chartcontainer,".controlpanel-window").off().on("click",function(){var a=$(this).attr("itemid");$(this).toggleClass("controlpanel-button-selected");s.guiid=s.guiid==a?null:a;K();e.chart.AdjustSize(null,null)})}function sa(){$.prochartcache.update(e.init.chartcontainer,".controlpanel-close");if($.prochartcache.get(e.init.chartcontainer,".controlpanel-close"))$.prochartcache.get(e.init.chartcontainer,".controlpanel-close").off().on("click",function(){var a=
$(this).attr("panelid");e.chart.DeletePanel(a)})}function za(){$.prochartcache.update(e.parent,".legend-button-close");if($.prochartcache.get(e.parent,".legend-button-close"))$.prochartcache.get(e.parent,".legend-button-close").off().on("click",function(){var a=$(this).attr("itemid"),b=$(this).attr("itemtype");switch(b){case "plugin":e.signals.gui.pluginDelete(a);break;case "signals.tc":e.tradingCentral.api.hide();break;default:e.chart.legend.Delete(a,b)}})}function Ba(){$.prochartcache.update(e.parent,
".legend-button-visible");if($.prochartcache.get(e.parent,".legend-button-visible"))$.prochartcache.get(e.parent,".legend-button-visible").off().on("click",function(){var a=$(this).attr("itemid"),b=$(this).attr("itemtype"),c=$(this).hasClass("legend-visible-off");e.chart.legend.SetVisible(a,b,c);$(this).toggleClass("legend-visible-off")})}function Aa(){$.prochartcache.update(e.parent,".legend-button-properties");if($.prochartcache.get(e.parent,".legend-button-properties"))$.prochartcache.get(e.parent,
".legend-button-properties").off().on("click",function(){var a=$(this).attr("itemid"),b=$(this).attr("itemtype");switch(b){case "plugin":e.signals.gui.pluginOpenDialog(a);break;default:e.chart.legend.Edit(a,b,!1)}})}function V(a){for(var b=0;b<d.length;b++)if(d[b].id==a&&("price"==d[b].type||"study"==d[b].type||"plugin"==d[b].type||"signal"==d[b].type))return d[b].legend.guiid;return null}function la(a){for(var b=0;b<d.length;b++)if(d[b].id==a&&("price"==d[b].type||"study"==d[b].type||"plugin"==d[b].type||
"signal"==d[b].type))return d[b];return null}function ma(a){for(var b=0;b<d.length;b++)if(d[b].id==a&&("price"==d[b].type||"study"==d[b].type||"plugin"==d[b].type||"signal"==d[b].type))switch(d[b].type){case "price":try{return e.currenlayout.chart_panels.price.collapselegend?e.currenlayout.chart_panels.price.collapselegend.collapseopen||e.currenlayout.chart_panels.price.collapselegend.view:!0}catch(c){return!0}case "study":try{return e.currenlayout.chart_panels.study.collapselegend?e.currenlayout.chart_panels.study.collapselegend.collapseopen||
e.currenlayout.chart_panels.study.collapselegend.view:!0}catch(g){return!0}case "plugin":return!0;case "signal":return!0}}function L(a){for(var b=0;b<d.length;b++)if(d[b].id==a&&("price"==d[b].type||"study"==d[b].type||"plugin"==d[b].type||"signal"==d[b].type)){if("undefined"!=typeof d[b].legend.collapseopen)return d[b].legend.collapseopen;switch(d[b].type){case "price":try{var c=e.currenlayout.chart_panels.price;return c.collapselegend?c.collapselegend.collapseopen:!0}catch(g){return!0}case "study":try{var f=
e.currenlayout.chart_panels.study;return f.collapselegend?f.collapselegend.collapseopen:!0}catch(k){return!0}}}return!0}function K(){J();for(var a=0;a<d.length;a++)switch(d[a].type){case "price":Z(d[a],null,null);if("undefined"!=typeof d[a].onResizePanel&&"function"==typeof d[a].onResizePanel)d[a].onResizePanel(d[a]);w(d[a],"controlpanel");w(d[a],"zoom");w(d[a],"legend");w(d[a],"lastupdate");w(d[a],"communic");w(d[a],"axisxmsg");break;case "study":ha(d[a],null,null);w(d[a],"controlpanel");w(d[a],
"legend");if("undefined"!=typeof d[a].onResizePanel&&"function"==typeof d[a].onResizePanel)d[a].onResizePanel(d[a]);break;case "splitter":ta(d[a]);break;case "signal":ia(d[a]);if("undefined"!=typeof d[a].onResizePanel&&"function"==typeof d[a].onResizePanel)d[a].onResizePanel(d[a]);w(d[a],"controlpanel");w(d[a],"legend")}}function w(a,b,c){try{var g=e.currenlayout.chart_panels[a.type][b];"undefined"!=typeof g&&"undefined"!=typeof g.view&&B(g.view)?"controlpanel"==b&&1==d.length?($.prochartcache.get("#"+
a[b].guiid).css("display","none"),"undefined"!=typeof c&&$.prochartcache.get("#"+a[c].guiid).css("display","none")):($.prochartcache.get("#"+a[b].guiid).css("display","block"),"undefined"!=typeof c&&$.prochartcache.get("#"+a[c].guiid).css("display","block")):($.prochartcache.get("#"+a[b].guiid).css("display","none"),"undefined"!=typeof c&&$.prochartcache.get("#"+a[c].guiid).css("display","none"))}catch(f){}}function ua(){for(var a=0;a<x.length;a++)switch(x[a].type){case "splitter":ta(x[a])}}function fa(a){var b=
$.prochartcache.get(e.init.chartcontainer),c=e.currenlayout.chart_panels.unit;if(null!=e.patterns.panels.price){var g=e.commonutils.func.returnShortUniqID(),f=e.commonutils.func.returnShortUniqID(),k=e.commonutils.func.returnShortUniqID(),l=e.commonutils.func.returnShortUniqID(),h=e.commonutils.func.returnShortUniqID(),m=e.commonutils.func.returnShortUniqID(),F=e.commonutils.func.returnShortUniqID(),q=e.commonutils.func.returnShortUniqID(),n=e.commonutils.func.returnShortUniqID(),v=e.commonutils.func.returnShortUniqID(),
s=e.commonutils.func.returnShortUniqID(),w=e.commonutils.func.returnShortUniqID(),x=e.commonutils.func.returnShortUniqID(),J=e.commonutils.func.returnShortUniqID(),K=e.commonutils.func.returnShortUniqID(),L=e.commonutils.func.returnShortUniqID(),N=e.commonutils.func.returnShortUniqID(),A=e.commonutils.func.returnShortUniqID(),r=ba(),t=e.patterns.panels.price.replace(W,"").replace(/%id%/g,g).replace(/%guiid%/g,g).replace(/%pane-style%/g,p(r.panelsize,c)),t=t.replace(/%main-id%/g,l).replace(/%main-style%/g,
p(r.innermainsize,c)),y={width:r.innermainsize.width,height:r.innermainsize.height,top:0,left:0,"z-index":1},t=t.replace(/%pricealert-id%/g,L).replace(/%cancas-price-id%/g,f).replace(/%pricealert-style%/g,p(y,c)).replace(/%pricealert-size%/g,ca(y,c)),t=t.replace(/%xalert-id%/g,N).replace(/%cancas-x-id%/g,k).replace(/%xalert-style%/g,p(r.axisxalertsize,c));r.axisxalertsize.top=0;r.axisxalertsize.left=0;r.axisxalertsize.right=0;r.axisxalertsize.bottom=0;t=t.replace(/%xalert-inner-size%/g,ca(r.axisxalertsize,
c)).replace(/%xalert-inner-style%/g,p(r.axisxalertsize,c));t=t.replace(/%x-id%/g,F).replace(/%date-style%/g,p(r.dateaxissize,c));t=t.replace(/%y-id%/g,h).replace(/%price-style%/g,p(r.priceaxissize,c));t=t.replace(/%legend-id%/g,q).replace(/%legend-style%/g,p(r.legendsize,c));t=t.replace(/%wm-id%/g,s).replace(/%watermark-style%/g,p(r.watermarksize,c));t=t.replace(/%cp-id%/g,v).replace(/%cp-style%/g,p(r.controlpanelsize,c)).replace(/%item-id%/g,g);t=t.replace(/%zoom-id%/g,n).replace(/%zoom-style%/g,
p(r.zoomsize,c));t=t.replace(/%lastupdate-id%/g,J).replace(/%lastupdate-style%/g,p(r.lastupdatesize,c,1));t=t.replace(/%communic-id%/g,K).replace(/%communic-style%/g,p(r.communicsize,c,1));t=t.replace(/%xmsg-id%/g,m).replace(/%xmsg-style%/g,p(r.axisxmsgsize,c));s="";try{s=e.currenlayout.chart_panels.price.infomsg.infomsg_title}catch(C){s=""}r.infomsg["pointer-events"]="auto";r.infomsg.display="none";t=t.replace(/%infomsg_title%/g,s).replace(/%infomsg-id%/g,A).replace(/%html-info%/g,e.patterns.signals.info_mesg).replace(/%infomsg-style%/g,
p(r.infomsg,c,1));try{"undefined"!=typeof r.axisxinmainsize.view?r.axisxinmainsize.width=r.innermainsize.width:r.axisxinmainsize.view=!1,t=t.replace(/%canvas-axisxinmain-id%/g,x).replace(/%axisxinmain-style%/g,p(r.axisxinmainsize,c)).replace(/%axisxinmain-size%/g,ca(r.axisxinmainsize,c))}catch(O){}s="";try{if("undefined"!=typeof e.currenlayout.chart_panels.price.htmlcontainers){var P=e.currenlayout.chart_panels.price.htmlcontainers;if("undefined"!=typeof P.items)for(y=0;y<P.items.length;y++){var D=
P.items[y],B="";"undefined"!=typeof D.css&&(B=D.css);var z="";"undefined"!=typeof D.content&&(z=D.content);var Q="",M=e.commonutils.func.returnShortUniqID();"undefined"!=typeof D.id&&(Q=D.id);var I=u({width:e.currenlayout.chart.width,height:E.price.height},D),s=s+e.patterns.panels.htmlcontainer.replace(/%id%/g,M).replace(/%css%/g,B+" price-html-container").replace(/%style%/g,p(I,c,1));0<Q.length&&(R.htmlcustomcontainers[Q]=M);if("undefined"!=typeof D.items)for(z="",B=0;B<D.items.length;B++){var S=
D.items[B];switch(S.type){case "toolbar":var H=Ca(S),z=z+H}}s=s.replace(/%html%/g,z)}}}catch(U){}t=t.replace(/%htmlcontainers%/g,s);if("undefined"!=typeof e.currenlayout.chart_panels.price.collapselegend){P=!1==e.currenlayout.chart_panels.price.collapselegend.collapseopen||"false"==e.currenlayout.chart_panels.price.collapselegend.collapseopen?!1:!0;D=I=M=M="";try{M=e.currenlayout.chart_panels.price.collapselegend.title_1,I=e.currenlayout.chart_panels.price.collapselegend.title_2}catch(V){}M=!1==P?
M:I;D=!1==P?" collapsebutton_close":" collapsebutton_open";t=t.replace(/%collapselegend-id%/g,w).replace(/%title1%/g,M).replace(/%collapseopen%/g,P).replace(/%caption%/g,"").replace(/ %collapsebuttoncss%/g,D).replace(/%collapselegend-style%/g,p(r.collapselegend,c,1).replace("pointer-events:none",""))}else t=t.replace(/%collapselegend-id%/g,"").replace(/%title1%/g,"").replace(/%collapseopen%/g,"").replace(/%caption%/g,"").replace(/%collapselegend-id%/g,w).replace(/%collapselegend-style%/g,'style=" display:none; "');
t=t.replace(/%font-icon%/g,""==G.icon_prefix?"":G.icon_prefix+"panel-communic").replace(/%icon-prefix%/g,G.icon_prefix).replace(/%icon-source%/g,G.icon_source);b.append(t);d.push({id:a,guiid:g,type:"price",width:r.panelsize.width+c,height:r.panelsize.height+c,y:{guiid:h,width:r.priceaxissize.width+c,height:r.priceaxissize.height+c},x:{guiid:F,width:r.dateaxissize.width+c,height:r.dateaxissize.height+c},axisxalert:{guiid:N,width:r.axisxalertsize.width+c,height:r.axisxalertsize.height+c},axisxmsg:{guiid:m,
width:r.axisxmsgsize.width+c,height:r.axisxmsgsize.height+c},main:{guiid:l,width:r.innermainsize.width+c,height:r.innermainsize.height+c},pricealert:{guiid:L,width:r.innermainsize.width+c,height:r.innermainsize.height+c},canvasalert:{guiid:f,width:r.innermainsize.width,height:r.innermainsize.height},canvasxalert:{guiid:k,width:r.axisxalertsize.width,height:r.axisxalertsize.height},axisxinmain:{guiid:x,width:r.axisxinmainsize.width,height:r.axisxinmainsize.height},legend:{guiid:q},infomsg:{guiid:A},
zoom:{guiid:n},controlpanel:{guiid:v},lastupdate:{guiid:J},communic:{guiid:K}})}if($.prochartcache.get("#"+g,"button.button-action"))$.prochartcache.get("#"+g,"button.button-action").on("click",function(){var b=$(this).attr("tid");if("undefined"!=typeof b&&"undefined"!=typeof e.actions)switch(b){case "legend-collapse":var a=g,c=e.commonutils.func.toBool($(this).attr("collapseopen")),f="",k="";try{f=e.currenlayout.chart_panels.price.collapselegend.title_1,k=e.currenlayout.chart_panels.price.collapselegend.title_2}catch(h){}e.actions.action(b,
a,c);$(this).attr("collapseopen",!0==c?!1:!0);$(this).find("b").html(!1==c?k:f);a:for(b=g,c=!0==c?!1:!0,a=0;a<d.length;a++)if(d[a].guiid==b&&("price"==d[a].type||"study"==d[a].type||"plugin"==d[a].type||"signal"==d[a].type)){d[a].legend.collapseopen=c;break a}}});$.prochartcache.get("#"+A).on("click",function(){"visible"==$.prochartcache.get("#"+A,".infomessage-group").css("visibility")?$.prochartcache.get("#"+A,".infomessage-group").css("visibility","hidden"):$.prochartcache.get("#"+A,".infomessage-group").css("visibility",
"visible");T.debug("Ckick infomsg")})}function Ca(a){var b=e.commonutils.func.returnShortUniqID();a.guiid=b;var c=e.patterns.panels.toolbar.replace(W,"").replace(/%id%/g,b).replace(/%style%/g,a.possition?Da(a.possition):"");a.fns=[];a.fns.push({prop:"view",actions:["$('#"+b+"').css('display',%value%?'block':'none')"]});if(a.possition){a.possition.fns=[];for(var g="right left width height top bottom".split(" "),f=0;f<g.length;f++)a.possition.fns.push({prop:g[f],actions:["$('#"+b+"').css('"+g[f]+"',isNaN('%value%')?'auto': '%value%' + 'px' )"]})}return{header:c}}
function Da(a,b){var c="";if(!a)return c;var c="undefined"==typeof a.position?c+"position :absolute;":c+"position :"+a.position+"; ",g="px";"undefined"!=typeof b&&null!=b&&(g=b);"undefined"!=typeof a.display&&(c=c+"display :"+a.display+";");"undefined"!=typeof a.left&&(c=c+"left :"+S(a.left,g)+"; ");"undefined"!=typeof a.right&&(c=c+"right :"+S(a.right,g)+"; ");"undefined"!=typeof a.top&&(c=c+"top :"+S(a.top,g)+"; ");"undefined"!=typeof a.bottom&&(c=c+"bottom :"+S(a.bottom,g)+"; ");"undefined"!=typeof a.width&&
(c=c+"width :"+S(a.width,g)+"; ");"undefined"!=typeof a.height&&(c=c+"height :"+S(a.height,g)+"; ");"undefined"!=typeof a.view&&!0!=a.view&&(c+="display : none; ");return 0<c.length?'style="'+c+'"':null}function ga(a,b){var c=$.prochartcache.get(e.init.chartcontainer),g=e.currenlayout.chart_panels.unit;if(null!=e.patterns.panels.study){var f=e.commonutils.func.returnShortUniqID(),k=e.commonutils.func.returnShortUniqID(),l=e.commonutils.func.returnShortUniqID(),h=e.commonutils.func.returnShortUniqID(),
m=e.commonutils.func.returnShortUniqID(),s=e.commonutils.func.returnShortUniqID(),q=va(),n=e.patterns.panels.study.replace(W,"").replace(/%id%/g,f).replace(/%guiid%/g,f).replace(/%pane-style%/g,p(q.panelsize,g)),n=n.replace(/%main-id%/g,k).replace(/%main-style%/g,p(q.innermainsize,g)),n=n.replace(/%x-id%/g,h).replace(/%date-style%/g,p(q.dateaxissize,g)),n=n.replace(/%y-id%/g,l).replace(/%price-style%/g,p(q.priceaxissize,g)),n=n.replace(/%legend-id%/g,m).replace(/%legend-style%/g,p(q.legendsize,g)),
n=n.replace(/%cp-id%/g,s).replace(/%panel-id%/g,a).replace(/%cp-style%/g,p(q.controlpanelsize,g)).replace(/%item-id%/g,f),n=n.replace(/%icon-source%/g,G.icon_source).replace(/%icon-prefix%/g,G.icon_prefix);"top"==b.position?c.prepend(n):c.append(n);c={id:a,guiid:f,type:"study",width:q.panelsize.width+g,height:q.panelsize.height+g,y:{guiid:l,width:q.priceaxissize.width+g,height:q.priceaxissize.height+g},x:{guiid:h,width:q.dateaxissize.width+g,height:q.dateaxissize.height+g},main:{guiid:k,width:q.innermainsize.width+
g,height:q.innermainsize.height+g},legend:{guiid:m},controlpanel:{guiid:s}};"top"==b.position?d.unshift(c):d.push(c)}}function ya(a,b){$.prochartcache.get(e.init.chartcontainer);var c=e.currenlayout.chart_panels.unit;if(null!=e.patterns.panels.splitter){var g=e.commonutils.func.returnShortUniqID(),f=e.commonutils.func.returnShortUniqID(),d=wa(),l=e.patterns.panels.splitter.replace(W,"").replace(/%id%/g,g).replace(/%guiid%/g,g).replace(/%pane-style%/g,p(d.panelsize,c)),l=l.replace(/%main-id%/g,f).replace(/%main-style%/g,
p(d.innermainsize,c));$("#"+a).after(l);c={id:null,guiid:g,type:"splitter",width:d.panelsize.width+c,height:d.panelsize.height+c,pane_before_guiid:a,pane_after_guiid:b,main:{guiid:f,width:d.innermainsize.width+c,height:d.innermainsize.height+c}};x.push(c);return c}}function Y(a){var b=$.prochartcache.get(e.init.chartcontainer),c=e.currenlayout.chart_panels.unit;if(null!=e.patterns.panels.signal){var g=e.commonutils.func.returnShortUniqID(),f=e.commonutils.func.returnShortUniqID(),k=e.commonutils.func.returnShortUniqID(),
l=e.commonutils.func.returnShortUniqID(),h=e.commonutils.func.returnShortUniqID(),m=xa(),s=e.patterns.panels.signal.replace(/=""/g,"").replace(/%id%/g,g).replace(/%guiid%/g,g).replace(/%pane-style%/g,p(m.panelsize,c)),s=s.replace(/%main-id%/g,f).replace(/%main-style%/g,p(m.innermainsize,c)),s=s.replace(/%legend-id%/g,k).replace(/%legend-style%/g,p(m.legendsize,c)),s=s.replace(/%cp-id%/g,l).replace(/%cp-style%/g,p(m.controlpanelsize,c)).replace(/%item-id%/g,g),s=s.replace(/%alert-id%/g,h).replace(/%alert-style%/g,
p(m.alertsize,c)).replace(/%item-id%/g,g);b.append(s);a={id:a,guiid:g,type:"signal",width:m.panelsize.width+c,height:m.panelsize.height+c,main:{guiid:f,width:m.innermainsize.width+c,height:m.innermainsize.height+c},legend:{guiid:k},controlpanel:{guiid:l},alert:{guiid:h}};d.push(a);return a}return null}function ba(a,b){var c=e.currenlayout.chart_panels.price,g={width:e.currenlayout.chart.width,height:null!=b?b:E.price.height},f=u(g,c.main,c),d=u(g,c.axisx,c),l=u(g,c.axisy,c),h=u(g,c.legend,c),m=u(g,
c.zoom,c),p=u(g,c.controlpanel,c),q=u(g,c.lastupdate,c),n=u(g,c.communic,c),s=u(g,c.watermark,c),v=u(g,c.collapselegend,c),w=u(g,c.axisxalert,c),x=u(g,c.volume,c),A=u(g,c.axisxmsg,c),B=u(g,c.axisxinmain,c),c=u(g,c.infomsg,c);return{panelsize:g,innermainsize:f,dateaxissize:d,priceaxissize:l,legendsize:h,zoomsize:m,controlpanelsize:p,lastupdatesize:q,communicsize:n,watermarksize:s,collapselegend:v,axisxalertsize:w,volumesize:x,axisxmsgsize:A,axisxinmainsize:B,infomsg:c}}function va(a,b){var c=e.currenlayout.chart_panels.study,
g={width:e.currenlayout.chart.width,height:null!=b?b:E.study.height},f=u(g,c.main),d=u(g,c.axisx),l=u(g,c.axisy),h=u(g,c.legend),c=u(g,c.controlpanel);return{panelsize:g,innermainsize:f,dateaxissize:d,priceaxissize:l,legendsize:h,controlpanelsize:c}}function wa(){var a={width:e.currenlayout.chart.width,height:0},b=u(a,e.currenlayout.chart_panels.splitterx.main);return{panelsize:a,innermainsize:b}}function xa(a,b){var c={width:e.currenlayout.chart.width,height:null!=b?b:E.signal.height},g=e.currenlayout.chart_panels.signal,
f=u(c,g.main),d=u(c,g.legend),l=u(c,g.controlpanel),g=u(c,g.alert);return{panelsize:c,innermainsize:f,legendsize:d,controlpanelsize:l,alertsize:g}}function u(a,b,c){var g={};if("undefined"==typeof b)return g;var e="",e="undefined"==typeof b.width?"auto":b.width;"undefined"!=typeof b.left&&(g.left="center"==b.left?parseInt(a.width/2-e/2):b.left);"undefined"!=typeof b.right&&(g.right="center"==b.right?parseInt(a.width/2+e/2):b.right);switch(e){case "auto":"undefined"==typeof g.left&&(g.left=0);"undefined"==
typeof g.right&&(g.right=0);var e=isNaN(g.right)?0:parseInt(g.right),d=isNaN(g.left)?0:parseInt(g.left);g.width=a.width-d-e;break;case "inherit":break;default:g.width=b.width}"undefined"!=typeof b.top&&(g.top=b.top);e="";if("undefined"!=typeof b.bottom)switch(e=b.bottom,e){case "relative":e=0;if("undefined"!=typeof b.bottomrelative)for(var d=b.bottomrelative.split(","),l=0;l<d.length;l++)if(!1==isNaN(d[l]))e+=parseInt(d[l]);else if("undefined"!=typeof c[d[l]]&&"undefined"!=typeof c[d[l]].height){var h=
c[d[l]].height,m=!1;try{m=Ea(d[l],c),T.debug(d[l],"view_rel_block_view:",m)}catch(p){}!1==isNaN(h)&&!0==m&&(e+=parseInt(h))}g.bottom=e;break;default:g.bottom=e}c="";c="undefined"==typeof b.height?"auto":b.height;switch(c){case "auto":"undefined"==typeof g.top&&(g.top=0);"undefined"==typeof g.bottom&&(g.bottom=0);c=isNaN(g.top)?0:parseInt(g.top);e=isNaN(g.bottom)?0:parseInt(g.bottom);g.height=a.height-c-e;break;case "inherit":break;default:g.height=b.height}"undefined"!=typeof b.paddingtop&&(g.paddingtop=
b.paddingtop);"undefined"!=typeof b.paddingright&&(g.paddingright=b.paddingright);"undefined"!=typeof b.paddingbottom&&(g.paddingbottom=b.paddingbottom);"undefined"!=typeof b.paddingtleft&&(g.paddingtleft=b.paddingtleft);"undefined"!=typeof b.view&&(g.view=b.view);return g}function Ea(a,b){switch(a){case "axisxalert":var c=!1;try{c=b.axisxalert.view}catch(g){}var d=!1;try{d=e.apiinit.guipart.enabled.alert}catch(k){}return c&&d;case "axisx":c=!1;try{c=b.axisx.view}catch(l){}return c;case "axisxmsg":c=
!1;try{c=b.axisxmsg.view}catch(h){}return c}return!1}function ca(a,b){var c="";"undefined"!=typeof a.width&&(c=c+' width ="'+a.width+'" ');"undefined"!=typeof a.height&&(c=c+' height ="'+a.height+'" ');return c}function p(a,b,c){var e="",d=" ";"undefined"!=typeof a.position?e=e+"position:"+a.position+"; ":1==c&&(d+=" position:absolute; ");"undefined"!=typeof a["z-index"]?e=e+"z-index:"+a["z-index"]+"; ":1==c&&(d+=" z-index:30; ");"undefined"!=typeof a["pointer-events"]?e=e+"pointer-events:"+a["pointer-events"]+
"; ":1==c&&(d+="pointer-events:none;");"undefined"!=typeof a.more&&(e+=a.more);"undefined"!=typeof a.left&&(e=e+"left :"+a.left+(isNaN(a.left)?"":b)+"; ");"undefined"!=typeof a.right&&(e=e+"right :"+a.right+(isNaN(a.right)?"":b)+"; ");"undefined"!=typeof a.top&&(e=e+"top :"+a.top+(isNaN(a.top)?"":b)+"; ");"undefined"!=typeof a.bottom&&(e=e+"bottom :"+a.bottom+(isNaN(a.bottom)?"":b)+"; ");"undefined"!=typeof a.width&&(e=e+"width :"+a.width+(isNaN(a.width)?"":b)+"; ");"undefined"!=typeof a.height&&
(e=e+"height :"+a.height+(isNaN(a.height)?"":b)+"; ");"undefined"!=typeof a.view&&!0!=a.view&&(e+="display : none; ");return 0<e.length?("undefined"!=typeof c&&1==c&&(e+=d),'style="'+e+'"'):'style=" display:none; "'}function Z(a,b,c){var d=$.prochartcache.get(e.init.chartcontainer,"#"+a.guiid),f=d.width(),k=d.height();b=ba(b,c);var l=$.prochartcache.get(e.init.chartcontainer,"#"+a.main.guiid),h=$.prochartcache.get(e.init.chartcontainer,"#"+a.x.guiid);$.prochartcache.get(e.init.chartcontainer,"#"+
a.axisxalert.guiid);c=$.prochartcache.get(e.init.chartcontainer,"#"+a.pricealert.guiid);var m=$.prochartcache.get(e.init.chartcontainer,"#"+a.y.guiid),p=$.prochartcache.get(e.init.chartcontainer,"#"+a.legend.guiid),q=$.prochartcache.get(e.init.chartcontainer,"#"+a.zoom.guiid),n=$.prochartcache.get(e.init.chartcontainer,"#"+a.axisxinmain.guiid),u=0,v=0;try{k!=d.height()&&(v=d.outerHeight(!0)-d.height()),f!=d.width()&&(u=d.outerWidth(!0)-d.width())}catch(w){}0!=u&&(b.panelsize.width=parseInt(b.panelsize.width)-
u);0!=v&&(b.panelsize.height=parseInt(b.panelsize.height)-v);f="height width top right bottom left".split(" ");for(k=0;k<f.length;k++)"undefined"!=typeof b.panelsize[f[k]]&&(d.css(f[k],b.panelsize[f[k]]),a[f[k]]=b.panelsize[f[k]]);null!==s.guiid&&s.guiid!=a.guiid?d.css("display","none"):d.css("display","block");for(k=0;k<f.length;k++)"undefined"!=typeof b.innermainsize[f[k]]&&(l.css(f[k],b.innermainsize[f[k]]),a.main[f[k]]=b.innermainsize[f[k]]);for(k=0;k<f.length;k++)"undefined"!=typeof b.dateaxissize[f[k]]&&
(h.css(f[k],b.dateaxissize[f[k]]),a.x[f[k]]=b.dateaxissize[f[k]]);if(c)for(k=$.prochartcache.get(c,".alertdata"),l=$.prochartcache.get(e.init.chartcontainer,"#"+a.canvasalert.guiid),d=["width","height"],h=0;h<d.length;h++)"undefined"!=typeof b.innermainsize[d[h]]&&(c.css(d[h],b.innermainsize[d[h]]+"px"),k.css(d[h],b.innermainsize[d[h]]+"px"),l.attr(d[h],b.innermainsize[d[h]]));if("undefined"!=typeof n){d=["width","height"];for(k=0;k<f.length;k++)"undefined"!=typeof b.axisxinmainsize[f[k]]&&(n.css(f[k],
b.axisxinmainsize[f[k]]),a.axisxinmain[f[k]]=b.axisxinmainsize[f[k]]);for(h=0;h<d.length;h++)"undefined"!=typeof b.axisxinmainsize[d[h]]&&n.attr(d[h],b.axisxinmainsize[d[h]])}for(k=0;k<f.length;k++)"undefined"!=typeof b.priceaxissize[f[k]]&&(m.css(f[k],b.priceaxissize[f[k]]),a.y[f[k]]=b.priceaxissize[f[k]]);for(k=0;k<f.length;k++)"undefined"!=typeof b.legendsize[f[k]]&&(p.css(f[k],b.legendsize[f[k]]),a.legend[f[k]]=b.legendsize[f[k]]);for(k=0;k<f.length;k++)"undefined"!=typeof b.zoomsize[f[k]]&&(q.css(f[k],
b.zoomsize[f[k]]),a.zoom[f[k]]=b.zoomsize[f[k]])}function ha(a,b,c){b=va(b,c);c=$.prochartcache.get(e.init.chartcontainer,"#"+a.guiid);var d=$.prochartcache.get(e.init.chartcontainer,"#"+a.main.guiid),f=$.prochartcache.get(e.init.chartcontainer,"#"+a.x.guiid),k=$.prochartcache.get(e.init.chartcontainer,"#"+a.y.guiid),l=$.prochartcache.get(e.init.chartcontainer,"#"+a.legend.guiid),h=0,m=0;try{m=c.outerHeight(!0)-c.height(),h=c.outerWidth(!0)-c.width()}catch(p){}0!=h&&(b.panelsize.width=parseInt(b.panelsize.width)-
h);0!=m&&(b.panelsize.height=parseInt(b.panelsize.height)-m);h="height width top right bottom left".split(" ");for(m=0;m<h.length;m++)"undefined"!=typeof b.panelsize[h[m]]&&(c.css(h[m],b.panelsize[h[m]]),a[h[m]]=b.panelsize[h[m]]);null!==s.guiid&&s.guiid!=a.guiid?c.css("display","none"):c.css("display","block");for(m=0;m<h.length;m++)"undefined"!=typeof b.innermainsize[h[m]]&&(d.css(h[m],b.innermainsize[h[m]]),a.main[h[m]]=b.innermainsize[h[m]]);for(m=0;m<h.length;m++)"undefined"!=typeof b.dateaxissize[h[m]]&&
(f.css(h[m],b.dateaxissize[h[m]]),a.x[h[m]]=b.dateaxissize[h[m]]);for(m=0;m<h.length;m++)"undefined"!=typeof b.priceaxissize[h[m]]&&(k.css(h[m],b.priceaxissize[h[m]]),a.y[h[m]]=b.priceaxissize[h[m]]);for(m=0;m<h.length;m++)"undefined"!=typeof b.legendsize[h[m]]&&(l.css(h[m],b.legendsize[h[m]]),a.legend[h[m]]=b.legendsize[h[m]])}function ta(a){for(var b=wa(),c=$.prochartcache.get(e.init.chartcontainer,"#"+a.guiid),d=$.prochartcache.get(e.init.chartcontainer,"#"+a.main.guiid),f="height width top right bottom left".split(" "),
k=0;k<f.length;k++)"undefined"!=typeof b.panelsize[f[k]]&&(c&&c.css(f[k],b.panelsize[f[k]]),a[f[k]]=b.panelsize[f[k]]);null!==s.guiid?c&&c.css("display","none"):c&&c.css("display","block");for(k=0;k<f.length;k++)"undefined"!=typeof b.innermainsize[f[k]]&&(d&&d.css(f[k],b.innermainsize[f[k]]),a.main[f[k]]=b.innermainsize[f[k]])}function ia(a,b,c){b=xa(b,c);c=$.prochartcache.get(e.init.chartcontainer,"#"+a.guiid);for(var d=$.prochartcache.get(e.init.chartcontainer,"#"+a.main.guiid),f=$.prochartcache.get(e.init.chartcontainer,
"#"+a.legend.guiid),k=$.prochartcache.get(e.init.chartcontainer,"#"+a.alert.guiid),l="height width top right bottom left".split(" "),h=0;h<l.length;h++)"undefined"!=typeof b.panelsize[l[h]]&&(c&&c.css(l[h],b.panelsize[l[h]]),a[l[h]]=b.panelsize[l[h]]);null!==s.guiid&&s.guiid!=a.guiid?c&&c.css("display","none"):c&&c.css("display","block");for(h=0;h<l.length;h++)"undefined"!=typeof b.innermainsize[l[h]]&&(d&&d.css(l[h],b.innermainsize[l[h]]),a.main[l[h]]=b.innermainsize[l[h]]);for(h=0;h<l.length;h++)"undefined"!=
typeof b.legendsize[l[h]]&&(f&&f.css(l[h],b.legendsize[l[h]]),a.legend[l[h]]=b.legendsize[l[h]]);for(h=0;h<l.length;h++)"undefined"!=typeof b.alertsize[l[h]]&&(alert&&k.css(l[h],b.alertsize[l[h]]),a.alert[l[h]]=b.alertsize[l[h]])}function J(){var a=0,b=e.currenlayout.chart.height;if(2>v.length||null!=s.guiid)E.price.height=b,E.study.height=b,E.signal.height=b;else{for(var c=0,d=0,f=0;f<v.length;f++)switch(v[f].type){case "price":a+=e.currenlayout.chart_panels.price.grow;break;case "study":a+=e.currenlayout.chart_panels.study.grow;
c+=1;break;case "signal":a+=e.currenlayout.chart_panels.signal.grow;d+=1;break;case "splitter":break;default:a+=1}a=b/a;for(f=0;f<v.length;f++)switch(v[f].type){case "price":E.price.height=parseInt(e.currenlayout.chart_panels.price.grow*a);break;case "study":E.study.height=parseInt(e.currenlayout.chart_panels.study.grow*a);break;case "signal":E.signal.height=parseInt(e.currenlayout.chart_panels.signal.grow*a)}E.price.height=b-c*E.study.height-d*E.signal.height}return 0}function S(a,b,c){return"auto"==
a.toString().toLowerCase()||"inherit"==a.toString().toLowerCase()?a:"undefined"!=typeof c?a+c+b:a+b}function B(a){return"undefined"==typeof a||null==a?!1:"string"==typeof a?"true"==a.toLowerCase()?!0:!1:"boolean"==typeof a?a:!1}var e=da,R={};e.panels=R;ProChart_InitFloatingPanels(da);var W=/=""/g,G=e.api.layout.getbuttonStyle(),T=e.api.debug.getLogger("prochart.gui.panels"),s={guiid:null},X={};R.htmlcustomcontainers={};R.gui={createPanels:function(){ea()},resizePanels:function(){K();ua()},resizeFullpagePanels:function(){K();
ua()},disablePanelEvents:function(a,b){b?($.prochartcache.get(e.init.chartcontainer,".legend-buttons","a")&&$.prochartcache.get(e.init.chartcontainer,".legend-buttons","a").css("pointer-events","none"),$.prochartcache.get(e.init.chartcontainer,".controlpanel-buttons","a")&&$.prochartcache.get(e.init.chartcontainer,".controlpanel-buttons","a").css("pointer-events","none"),$.prochartcache.get(e.init.chartcontainer,".chart-button")&&$.prochartcache.get(e.init.chartcontainer,".chart-button").css("pointer-events",
"none"),$.prochartcache.get(e.init.chartcontainer,".chart-price-communic")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-communic").css("pointer-events","none"),$.prochartcache.get(e.init.chartcontainer,".legend-price-collapsebutton")&&$.prochartcache.get(e.init.chartcontainer,".legend-price-collapsebutton").css("pointer-events","none"),$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom").css("pointer-events","none"),
$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom",".zoom-buttons")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom",".zoom-buttons").css("pointer-events","none"),$.prochartcache.get(e.init.chartcontainer,".chart-pane-main")&&$.prochartcache.get(e.init.chartcontainer,".chart-pane-main").css("pointer-events","none")):($.prochartcache.get(e.init.chartcontainer,".legend-buttons","a")&&$.prochartcache.get(e.init.chartcontainer,".legend-buttons","a").css("pointer-events","All"),
$.prochartcache.get(e.init.chartcontainer,".controlpanel-buttons","a")&&$.prochartcache.get(e.init.chartcontainer,".controlpanel-buttons","a").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,".chart-button")&&$.prochartcache.get(e.init.chartcontainer,".chart-button").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,".chart-price-communic")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-communic").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,
".legend-price-collapsebutton")&&$.prochartcache.get(e.init.chartcontainer,".legend-price-collapsebutton").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom",".zoom-buttons")&&$.prochartcache.get(e.init.chartcontainer,".chart-price-zoom",".zoom-buttons").css("pointer-events","All"),$.prochartcache.get(e.init.chartcontainer,
".chart-pane-main")&&$.prochartcache.get(e.init.chartcontainer,".chart-pane-main").css("pointer-events","All"));e.alertobj&&e.alertobj.gui.initMouseEvents(b)},addSignalPanel:function(a){"undefined"==typeof a&&(a="signalid");var b=[];b.push({type:"signal",id:a});for(var c=0;c<b.length;c++)v.push(b[c]);null!=s.guiid&&aa();J();a=Y(a);K();A();ra();sa();oa();qa();e.chart.AdjustSize(null,null);return a},deletePanelById:function(a){ja([{id:a}]);e.chart.AdjustSize(null,null)},updateLegends:function(a){ka(a)},
updateInfomsg:function(a,b,c){if(c)for(c=0;c<d.length;c++)switch(d[c].type){case "price":if(d[c].infomsg){var e=d[c].infomsg.guiid;a?($.prochartcache.get("#"+e).css("display","block"),$.prochartcache.get("#"+e+" .infomessage-content").html(b)):$.prochartcache.get("#"+e).css("display","none")}}},activateonResizePanel:function(a,b){for(var c=0;c<d.length;c++)if(d[c].id==a){d[c].onResizePanel=b;break}},changeLocalization:function(a,b){var c=$.prochartcache.get(e.init.chartcontainer);c&&("rtl"==b?c.hasClass("dir-rtl")||
c.addClass("dir-rtl"):c.removeClass("dir-rtl"))},onLastUpdateChange:function(a,b){try{for(var c=0;c<d.length;c++)if("price"==d[c].type){if("undefined"!=typeof d[c].lastupdate.guiid)try{$.prochartcache.get("#"+d[c].lastupdate.guiid)&&$.prochartcache.get("#"+d[c].lastupdate.guiid).html(b)}catch(e){}break}}catch(f){}},onCommunication:function(a,b){try{for(var c=0;c<d.length;c++)if("price"==d[c].type){if("undefined"!=typeof d[c].communic.guiid)try{$.prochartcache.get("#"+d[c].communic.guiid,"> .panel-communic")&&
$.prochartcache.get("#"+d[c].communic.guiid,"> .panel-communic").removeClass(b?"ComOff":"ComOn")}catch(e){}break}}catch(f){}},collapselegend:function(a,b){$.prochartcache.get("#"+a,".legend-study, .legend-compare, .legend-signaltc")&&$.prochartcache.get("#"+a,".legend-study, .legend-compare, .legend-signaltc").each(function(){switch(b){case !0:case "true":$(this).addClass("hide-legend");break;case !1:case "false":$(this).hasClass("hide-legend")&&$(this).removeClass("hide-legend")}})},getAlertZone:function(){for(var a=
0;a<d.length;a++)if("price"==d[a].type)try{return d[a].axisxalert.guiid}catch(b){break}return null},getPriceAlertZone:function(){for(var a=0;a<d.length;a++)if("price"==d[a].type)try{return d[a].pricealert.guiid}catch(b){break}return null},getPriceAlertCanvasZone:function(){for(var a=0;a<d.length;a++)if("price"==d[a].type)try{return d[a].canvasalert.guiid}catch(b){break}return null},getMsgZone:function(){for(var a=0;a<d.length;a++)if("price"==d[a].type)try{return d[a].axisxmsg.guiid}catch(b){break}return null},
refreshPriceWithInfoBars:function(){J();for(var a=0;a<d.length;a++)switch(d[a].type){case "price":Z(d[a],d[a].width,d[a].height),w(d[a],"controlpanel"),w(d[a],"zoom"),w(d[a],"legend"),w(d[a],"lastupdate"),w(d[a],"communic"),w(d[a],"axisxmsg"),e.chart.AdjustSize(null,null)}},slideToRight:function(){"undefined"==typeof status&&(status=!0);var a=$.prochartcache.get(e.parent,".layout-innner-container"),b=$.prochartcache.get(e.parent,".htmlchart ");switch(status){case !0:a&&a.css("left","-250px");b&&b.css("overflow",
"hidden");break;case !1:a&&a.css("left","inherit"),b&&b.css("overflow","inherit")}},slideToLeft:function(){"undefined"==typeof e.currenlayout.layout.slideToLeftStatus&&(e.currenlayout.layout.slideToLeftStatus=!1);var a=e.currenlayout.layout.slideToLeftStatus,b=$.prochartcache.get("#"+e.currenlayout.layout.guiniid),c=$.prochartcache.get(e.parent,".htmlchart "),d=$.prochartcache.get("#"+e.currenlayout.layout.lockguiid);switch(a){case !1:c&&c.css("overflow","hidden");d&&d.css("display","block");b&&b.animate({left:"-=250"},
400);e.currenlayout.layout.slideToLeftStatus=!0;break;case !0:b&&b.animate({left:"+=250"},400),c&&c.css("overflow","inherit"),d&&d.css("display","none"),e.currenlayout.layout.slideToLeftStatus=!1}},drawZoomIntervale:function(a,b,c,d,f,k){d=null;if(N("price").axisxinmain&&(d=N("price").axisxinmain,f=$.prochartcache.get("#"+d.guiid))){a=null;try{a=f[0]}catch(l){return}b=e.chart.getDateByIndex(b);c=e.chart.getDateByIndex(c);f=a.getContext("2d");a.width=a.width;a.height=d.height;null!=b&&null!=c&&(f.beginPath(),
f.fillStyle=e.api.props.chart.gui.zoom.interval_font_color?e.api.props.chart.gui.zoom.interval_font_color:"#000000",f.shadowBlur=0,f.textAlign="left",f.textBaseline="bottom",d=e.api.props.chart.gui.zoom.interval_font_size?e.api.props.chart.gui.zoom.interval_font_size:10,k=e.api.props.chart.gui.zoom.interval_font_padding?e.api.props.chart.gui.zoom.interval_font_padding:3,f.font=(e.api.props.chart.gui.zoom.interval_font_bold?"bold":"")+" "+d+"px sans-serif",f.fillText(b,k,d),f.textAlign="right",f.fillText(c,
a.width-k,d))}},viewPriceAlert:function(){if(e.apiinit.guipart.enabled.alert)try{$.prochartcache.get("#"+N("price").pricealert.guiid)&&$.prochartcache.get("#"+N("price").pricealert.guiid).css({display:"block"})}catch(a){}else try{$.prochartcache.get("#"+N("price").pricealert.guiid)&&$.prochartcache.get("#"+N("price").pricealert.guiid).css({display:"none"})}catch(b){}},addHookPrice:function(a,b){if("undefined"!=typeof e.currenlayout.chart_panels.price){var c=e.init.majors=jQuery.extend(!0,{},b);e.currenlayout.chart_panels.price[a]=
c;for(var c=v.length,d=0;d<c;d++)switch(v[d].type){case "price":$.prochartcache.get(e.init.chartcontainer);var f=e.currenlayout.chart_panels.unit;if(null!=e.patterns.panels.price){var k=e.commonutils.func.returnShortUniqID(),l=ba();e.patterns.signals.info_mesg.replace(W,"").replace(/%id%/g,k).replace(/%guiid%/g,k).replace(/%pane-style%/g,p(l.panelsize,f))}}}}};R.core={requestPanels:function(a){v=[];for(var b=0;b<a.length;b++)v.push(a[b]),0<b&&b<a.length&&v.push({id:"",type:"splitter"});ea();a=[];
for(b=0;b<d.length;b++)"study"!=d[b].type&&"price"!=d[b].type||a.push(d[b]);return a},returnPanels:function(){for(var a=[],b=0;b<d.length;b++)"study"!=d[b].type&&"price"!=d[b].type||a.push(d[b]);return a},addPanels:function(a){for(var b=0;b<a.length;b++)v.push(a[b]);null!=s.guiid&&aa();J();for(b=0;b<a.length;b++)switch(a[b].type){case "price":fa(a[b].id);break;case "study":ga(a[b].id,a[b]);break;case "signal":Y(a[b].id)}K();A();ra();sa();oa();qa();a=[];for(b=0;b<d.length;b++)"study"!=d[b].type&&"price"!=
d[b].type||a.push(d[b]);return a},deletePanels:ja,updateLegends:ka};var d=[];e.temp_panel=d;Object.defineProperty(R,"allpanels",{get:function(){return d}});var E={price:{height:null},study:{height:null},signal:{height:null}},v=[],x=[];return R};
