var UrlResolver=function(){function i(){return(document.cookie.match(/(^|; )DB=([\d]+)B/i)||"")[2]||"0"}var e=null,n={memoizedValues:{},getVersion:function(){return this.memoizedValues.version?this.memoizedValues.version:this.memoizedValues.version=(document.cookie.match(/(^|; )Version=([^;]+)/i)||"")[2]||""},getLanguage:function(){return this.memoizedValues.language?this.memoizedValues.language:this.memoizedValues.language=(document.cookie.match(/(^|; )Language=([^;]+)/i)||"")[2]||""},getLanguageId:function(){return this.memoizedValues.languageId?this.memoizedValues.languageId:this.memoizedValues.languageId=(document.cookie.match(/(^|; )LID=([^;]*)/i)||"")[2]||""},getCdnPath:function(){return this.memoizedValues.cdnPath?this.memoizedValues.cdnPath:this.memoizedValues.cdnPath=(document.cookie.match(/(^|; )CDN=([^;]*)/i)||"")[2]||""},getApplicationType:function(){return this.memoizedValues.applicationType?this.memoizedValues.applicationType:"mobile"===((document.cookie.match(/(^|; )ViewMode=([^;]*)/i)||0)[2]||"").toLowerCase()?this.memoizedValues.applicationType="mobile":this.memoizedValues.applicationType="web"},getBroker:function(){return null===e&&(e=(document.cookie.match(/(^|; )B=([\d]+)B\|/i)||"")[2]||""),e},getFolderForInstruments:function(){return"DM"===(document.cookie.match(/(^|; )B=.*\|(DM)\|/i)||"")[2]?(document.cookie.match(/(^|; )B=.*\|([\d]+)RF\|/i)||"")[2]||"0":this.getFolder()},getFolder:function(){return(document.cookie.match(/(^|; )B=.*\|([\d]+)F\|/i)||"")[2]||""},getFuturesPermission:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)FP\|/i)||"")[2]||""},getSharesPermission:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)SP\|/i)||"")[2]||""},getShowTestInstruments:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)TST\|/i)||"")[2]||""},getInstrumentsVersion:function(){return(document.cookie.match(/(^|; )B=.*\|([\d]+)\-VER\|/i)||"")[2]||""},getVersionHash:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)\-H\|/i)||"")[2]||""},getDealAmountsVersion:function(){return(document.cookie.match(/(^|; )B=.*\|([\d]+)\-DVER\|/i)||"")[2]||""},getDealAmountsHash:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)\-DH\|/i)||"")[2]||""},getMinDealsVersion:function(){return(document.cookie.match(/(^|; )B=.*\|([\d]+)\-MVER\|/i)||"")[2]||""},getMinDealGroupId:function(){return(document.cookie.match(/(^|; )MinDealGroupId=([^;]*)/i)||"")[2]||""},getMinDealsHash:function(){return(document.cookie.match(/(^|; )B=.*\|([\w]+)\-MH/i)||"")[2]||""},getIsAutoLogin:function(){return(document.cookie.match(/(^|; )B=.*\|([\d]+)\-AL/i)||"")[2]||""},getApplicationRelativePath:function(){return this.memoizedValues.getApplicationRelativePath?this.memoizedValues.getApplicationRelativePath:this.memoizedValues.getApplicationRelativePath=window.location.pathname.substring(0,window.location.pathname.indexOf("/",1)).toLowerCase()},getStaticPath:function(){return this.combine(this.getCdnPath(),this.getApplicationRelativePath())},getAssetsPath:function(){return this.combine(this.getStaticPath(),"assets",this.getVersion())},getOriginJSPath:function(e){return this.combine("assets",this.getVersion(),"js",e||"")},getStaticJSPath:function(e){return this.combine(this.getAssetsPath(),"js",e||"")},getStaticJSActionPath:function(e,t){return this.combine(this.getAssetsPath(),e,t+".js")},getImagePath:function(e,t,n){e=e||"";t=!0===t?this.getLanguage():"Default",n=!0===n?"Broker"+i():"AllBrokers";return this.combine(this.getAssetsPath(),"skins",this.getApplicationType(),n,t,"img",e)},getImageSharedPath:function(e){return e=e||"",this.combine(this.getAssetsPath(),"skins","Shared","svg",e)},getStaticParams:function(){var e=window.location.host,t=this.getApplicationType(),n=this.getBroker(),i=this.getLanguageId();return this.combine(e,t,n,i)},getStaticFilePath:function(){return this.combine(this.getStaticPath(),this.getStaticParams())},getStaticResourcePath:function(e){return this.combine(this.getStaticPath(),this.getStaticParams(),this.getVersion(),e+".js")},getContentPath:function(e){return this.combine(this.getStaticPath(),this.getStaticParams(),this.getVersion(),i(),e+".js")},getHostName:function(e){e=e.match(/:\/\/([^\/]*)/i);return null!=e&&1<e.length&&"string"==typeof e[1]&&0<e[1].length?e[1]:null},getRedirectPath:function(){return"Account/Redirect"},getRedirectUrl:function(e,t){return this.combine(this.getApplicationRelativePath(),this.getRedirectPath(),e,t?"?"+t:String.empty)},getInstrumentsUrl:function(e,t){var n="Instruments/";return n+="fu"+this.getFuturesPermission(),n+="-s"+this.getSharesPermission(),n+="-fo"+this.getFolderForInstruments(),n+="-br"+this.getBroker(),n+="-tst"+this.getShowTestInstruments(),n+="-v"+(e||this.getInstrumentsVersion()),n+="-h"+(t||this.getVersionHash())},getInstrumentsFromOriginUrl:function(){var e="InitialData/InstrumentsFromOrigin";return e+="?futuresPermission="+this.getFuturesPermission(),e+="&stocksPermission="+this.getSharesPermission(),e+="&folderId="+this.getFolderForInstruments(),e+="&brokerId="+this.getBroker(),e+="&includeTestInstruments="+this.getShowTestInstruments()},getMinDealAmountsUrl:function(e,t,n){var i="MinDealAmounts/";return i+="g"+e,i+="-v"+(t||this.getMinDealsVersion()),i+="-h"+(n||this.getMinDealsHash())},getDealAmountsUrl:function(e,t){var n="DealAmounts/";return n+="v"+(e||this.getDealAmountsVersion()),n+="-h"+(t||this.getDealAmountsHash())},getStaticInitialDataInstrumentsUrl:function(e,t){return this.combine(this.getAssetsPath(),"InitialData",this.getInstrumentsUrl(e,t)+".js")},getStaticInitialDataDealAmountsUrl:function(e,t){return this.combine(this.getAssetsPath(),"InitialData",this.getDealAmountsUrl(e,t)+".js")},getStaticInitialDataMinDealAmountsUrl:function(e,t,n){return this.combine(this.getAssetsPath(),"InitialData",this.getMinDealAmountsUrl(e,t,n)+".js")},isCors:function(e){e=this.getHostName(e);return null!==e&&""!==e},combine:function(){var e=[].slice.call(arguments,0).filter(function(e){return null!=e&&""!==e}).join("/");return e=(e=(e=(e=e.replace(/:\/(?=[^\/])/g,"://")).replace(/([^:\s\%\3\A])\/+/g,"$1/")).replace(/\/(\?|&|#[^!]|$)/g,"$1")).replace(/(\?.+)\?/g,"$1&")},getHashParameters:function(){var e={connectionToken:"",jwtToken:"",dealerCurrency:null,dealerAdvancedWalletView:null,CSMPushEnabled:""};if(window.location.hash&&-1<window.location.hash.indexOf("$")){for(var t=window.location.hash.slice(1).split("$"),n=0;n<t.length;n++)-1!==t[n].indexOf("ct=")&&(e.connectionToken=t[n].substring(3,t[n].length)),-1!==t[n].indexOf("jt=")&&(e.jwtToken=t[n].substring(3,t[n].length)),-1!==t[n].indexOf("dc=")&&(e.dealerCurrency=parseInt(t[n].substring(3,t[n].length))),-1!==t[n].indexOf("av=")&&(e.dealerAdvancedWalletView=parseInt(t[n].substring(3,t[n].length))),-1!==t[n].indexOf("en=")&&(e.CSMPushEnabled=t[n].substring(3,t[n].length));window.location.hash=""}return e},getContentStyleBrokerId:function(){return(document.cookie.match(/(^|; )CS=([^;]*)/i)||"")[2]||""},rndKey:"rnd",regexRndKey:/[?|&]rnd=0.\d+/g,rndMaxValue:9007199254740991,getRndKeyValue:function(){return n.rndKey+"=0."+Math.floor(Math.random()*n.rndMaxValue)},getUrlWithRndKeyValue:function(e){var t=(e=e.replace(n.regexRndKey,"")).indexOf("?")<0?"?":"&";return e=e+t+n.getRndKeyValue()},getChatBotResourcesPath:function(){return UrlResolver.getStaticJSPath()+"/fx-chatbot/"}};return n}();!function(){var e=navigator.userAgent,t="cordova-android-raw.js";e.match(/CDV8.1.0/)?t="cordova-android-raw-8.1.0.js":e.match(/CDV7.1.0/)?t="cordova-android-raw-7.1.0.js":e.match(/CDV5.1.1/)&&(t="cordova-android-raw-5.1.1.js");e=document.createElement("script");e.type="text/javascript",e.src=UrlResolver.getStaticJSPath(t),document.getElementsByTagName("head")[0].appendChild(e)}();var app=function(){function e(e){e.preventDefault(),0<window.location.href.toLowerCase().indexOf("/account/login")?navigator.app.exitApp():window.location.replace("/Account/Login")}return{onDeviceReady:function(){document.addEventListener("backbutton",e,!1),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/PG_Andr_FXNET/))&&(navigator.userAgent.match(/CDV7.1.0/)||navigator.userAgent.match(/CDV8.1.0/))&&PushNotification.init({android:{senderID:"1"}})},onBackKeyDown:e}}();document.addEventListener("backbutton",app.onBackKeyDown,!1),document.addEventListener("deviceready",app.onDeviceReady,!1);var eLoginMethods={Password:1,Fingerprint:2},deviceSupportErrorEnum={SUPPORTED:"10",NOT_SUPPORTS_FINGERPRINT:"1",DEVICE_HAS_NO_ENROLLED_FINGERPRINT:"2",OTHER_REASON:"3",MINIMUM_SDK_VERSION_23_REQUIRED:"4",BIOMETRY_IS_LOCKED_OUT:"5",IOS_FACE_INSTEADOF_FINGERPTINT:"6"},tokenErrorEnum={WRONG_ACCOUNT_NUMBER:"1"},iOSDeviceSupportErrorEnum={ErrorTouchIDNotEnrolled:-7,BiometryIsLockedOut:-8};function translateIOSErrorToGeneralMessage(e){switch(e.code){case iOSDeviceSupportErrorEnum.ErrorTouchIDNotEnrolled:return deviceSupportErrorEnum.DEVICE_HAS_NO_ENROLLED_FINGERPRINT;case iOSDeviceSupportErrorEnum.BiometryIsLockedOut:return deviceSupportErrorEnum.BIOMETRY_IS_LOCKED_OUT;default:return deviceSupportErrorEnum.NOT_SUPPORTS_FINGERPRINT}}!function(e,t){"use strict";"function"==typeof define&&define.amd?define("global/native/FingerprintTools",["generalmanagers/ErrorManager"],t):e.FingerprintTools=t(e.ErrorManager)}("undefined"!=typeof self?self:this,function(a){return window.FingerprintTools=new function(){var o,n="fingerPrint",t="fingerprintSupport";function r(e,t){a&&a.onError("CFingerprintTools/"+e,t)}function s(e){localStorage.setItem(t,e)}function i(){localStorage.removeItem(n)}function c(){i();try{Fingerprint.DeleteToken(function(e){return i(),e},function(e){r("DeleteTokenError",e)})}catch(e){}}return{DeviceSupportErrorEnum:window.deviceSupportErrorEnum,IsDeviceSupportFingerprint:function(t,n){try{Fingerprint.IsDeviceSupportFingerprint(function(e){null!=e&&"face"===e?i(deviceSupportErrorEnum.IOS_FACE_INSTEADOF_FINGERPTINT):(s(window.deviceSupportErrorEnum.SUPPORTED),t(e))},i)}catch(e){n(deviceSupportErrorEnum.OTHER_REASON)}function i(e){e===window.deviceSupportErrorEnum.DEVICE_HAS_NO_ENROLLED_FINGERPRINT?(c(),s(e)):e===window.deviceSupportErrorEnum.BIOMETRY_IS_LOCKED_OUT&&s(e),n(e)}},GetToken:function(n,i,o){Fingerprint.GetToken(function(e){if(e&&"0"!==e){var t=JSON.parse(e);return 0===n||t.account===n?i(t.token):o(tokenErrorEnum.WRONG_ACCOUNT_NUMBER)}return o(e)},function(e){return r("GetTokenError",e),o(e)})},SetToken:function(e,t){Fingerprint.SetToken(JSON.stringify({token:t,account:e}),function(e){return localStorage.setItem(n,"1"),e},function(e){r("SetTokenError",e)})},DeleteToken:c,ShowSetFingerprint:function(e,t,n,i){o=i,i=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*i));return t}(32),Fingerprint.show({clientId:"FingerprintPluginForApp",clientSecret:i,disableBackup:!0,title:e.title,message:e.message,description:e.message,cancel:e.cancel,cancelButtonTitle:e.cancel,fingerprint_not_recognized:e.fingerprint_not_recognized,fingerprint_success:e.fingerprint_success,secure_lock_screen_required:e.secure_lock_screen_required,finger_moved_too_fast:e.finger_moved_too_fast,too_many_attempts:e.too_many_attempts},function(){t()},function(e){e&&"string"==typeof e&&"Cancelled"===e&&n(e,!0);return e&&"string"==typeof e&&0<=e.indexOf("IllegalBlockSizeException: null")?t():n(e,!1)})},IsFingerprintSet:function(){var e=localStorage.getItem(n);return!(null==e)},FingerprintScanCancel:function(e,t){Fingerprint.scanCancel(e,t)},onScanError:function(e){o&&o(e)},RetrieveFingerprintSupport:function(){var e=localStorage.getItem(t);return null==e?null:e},Init:function(){localStorage.removeItem(t)}}}});var NativeLogsTools={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){NativeLogsTools.receivedEvent("deviceready")},receivedEvent:function(e){console.log("Received Event: "+e)},GetLogs:function(){console.log("GetLogs... ");try{NativeLogs.getLog(500,!1,function(e){return console.log("GetLogsSuccess - result is: "+e),e},function(e){console.log("GetLogsError: "+e)})}catch(e){}},GetCustomerID:function(){console.log("GetCustomerID on NativeLogsTools... ");try{var t="";try{t=null==$customer.prop.accountNumber?0:$customer.prop.accountNumber}catch(e){t=0}console.log("customerID is: "+t),NativeLogs.getCustomerID(t,function(e){return console.log("GetCustomerIDSuccess - result is: "+e),e},function(e){console.log("GetCustomerIDError: "+e)})}catch(e){}}};NativeLogsTools.initialize();var DarkModeTools={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){DarkModeTools.receivedEvent("deviceready"),console.log("DarkMode onDeviceReady")},receivedEvent:function(e){console.log("Received Event: "+e)},DarkModeisAvailable:function(){console.log("DarkModeisAvailable Function");try{cordova.plugins.ThemeDetection.isAvailable(function(e){console.log(e)},function(e){console.log(e)})}catch(e){console.log("cordova.plugins.ThemeDetection Doesnt exists. err is: "+e)}},DarkModeisEnabled:function(){console.log("DarkModeisEnabled Function");try{cordova.plugins.ThemeDetection.isDarkModeEnabled(function(e){console.log(e)},function(e){console.log(e)})}catch(e){console.log("cordova.plugins.ThemeDetection Doesnt exists. err is: "+e)}}};DarkModeTools.initialize(),function(e,t){"use strict";"function"==typeof define&&define.amd?define("global/devices/native/LastLoginMethod",[],t):e.LastLoginMethod=t()}("undefined"!=typeof self?self:this,function(){return window.LastLoginMethod=new function(){var t="lastLoginMethod";function n(e){localStorage.setItem(t,e)}return{SetLastLoginMethod:n,GetLastLoginMethod:function(){var e=localStorage.getItem(t);return null==e&&(e=eLoginMethods.Password),n(e),e}}}});var popupManager=function(o){var e=document.querySelector(".log-opt-overlay"),r=null;function s(){r&&(e.classList.add("visible"),r.classList.add("visible"),o(document).scrollTop(0))}function c(){e.classList.remove("visible"),r&&r.classList.remove("visible")}return{showSetupFingerprintPopup:function(e,t,n,i){document.querySelector("#cookies").classList.remove("visible"),document.querySelector("#fingerprint_title").innerHTML=e,document.querySelector("#fingerprint_message").innerHTML=t,(e=document.querySelector("#fingerprint_continue")).innerHTML=i,(t=document.querySelector("#fingerprint_close")).innerHTML=n,t.addEventListener("click",c,!1),null==i?(o(e).hide(),t.classList.remove("gray"),t.classList.remove("left")):(o(e).show(),t.classList.add("gray"),t.classList.add("left"),e.addEventListener("click",function(){location.href=UrlResolver.getApplicationRelativePath()+"/account/redirect/loginoptions?option=fingerprint"},{once:!0})),r=document.querySelector("#fingerprint"),s()},showCookiesDisabledPopUp:function(){document.querySelector("#fingerprint").classList.remove("visible");var e=document.querySelector("#cookies_ok");e.addEventListener("click",c,!1),e.classList.remove("gray"),e.classList.remove("left"),(e=document.querySelector("#cookies_alert_x"))&&e.addEventListener("click",c,!1),r=document.querySelector("#cookies"),s()}}}(jQuery),FingerprintLogin=function(){var s,c,a,u,l,g,n={None:0,Allow:1,Restricted:2},o={None:0,Success:1,LoginServerError:2,FingerprintNotSupported:3,NoFingerPrintOnDevice:4,FigerprintNotSet:5,LastLoginMethodNotFingerprint:6,CancelFingerprint:7,ScanError:8,CancelAfterMaxAttempts:9,TokenNotFound:10,ErrorGetToken:11},r=this;function i(){s("#fingerPrintLogin").click(function(){a.IsDeviceSupportFingerprint(function(){a.IsFingerprintSet()?m():(t(),r.fingerprintResult=o.FigerprintNotSet)},function(e){e===a.DeviceSupportErrorEnum.BIOMETRY_IS_LOCKED_OUT&&a.IsFingerprintSet()?m():(t(),r.fingerprintResult=o.NoFingerPrintOnDevice)})}),s("#btnOkLogin").click(function(){u.SetLastLoginMethod(eLoginMethods.Password)})}function d(e){g.fire("login-error",{isAutologin:!1,reason:e,type:"server"}),a.DeleteToken(),u.SetLastLoginMethod(eLoginMethods.Password),t()}function t(){var e=JSON.parse(c.FingerprintModelJson).Content;l.showSetupFingerprintPopup(e.scanFingerprintTitle,e.setupFingerPrintMessage,e.cancelButton,e.continueButton)}function p(){a.GetToken(0,function(e){g.fire("login-submit",{isAutologin:!1,type:"fingerprint"}),u.SetLastLoginMethod(eLoginMethods.Fingerprint),e=e,s("#token").val(e),s("#TokenLoginForm").submit(),r.fingerprintResult=o.Submit},function(){t(),r.fingerprintResult=o.TokenNotFound})}function m(){var e=JSON.parse(c.FingerprintModelJson),t=e.Content,n=e.MaxScanAttempts,t={title:t.scanFingerprintMessage,message:" ",cancel:t.cancelButton,fingerprint_not_recognized:t.scanFingerprintNotRecognized,fingerprint_success:t.scanFingerprintSuccess,secure_lock_screen_required:t.scanFingerprintSecureLockRequired,finger_moved_too_fast:t.scanFingerprintMoovedTooFast,too_many_attempts:t.scanFingerprintTooManyAttempts},i=0;a.ShowSetFingerprint(t,function(){p()},function(e,t){"string"!=typeof e||t||(t=e,e=JSON.parse(c.FingerprintModelJson).Content,l.showSetupFingerprintPopup("",t,e.closeButton)),r.fingerprintResult=o.CancelFingerprint},function(){n<=(i+=1)?(a.FingerprintScanCancel(function(){},function(){}),r.fingerprintResult=o.CancelAfterMaxAttempts):r.fingerprintResult=o.ScanError})}return r.fingerprintResult=0,function(){{var e;window.FingerprintTools&&(!(e=window.FingerprintTools.RetrieveFingerprintSupport())||e!==window.FingerprintTools.DeviceSupportErrorEnum.SUPPORTED&&e!==window.FingerprintTools.DeviceSupportErrorEnum.DEVICE_HAS_NO_ENROLLED_FINGERPRINT&&e!==window.FingerprintTools.DeviceSupportErrorEnum.BIOMETRY_IS_LOCKED_OUT||document.getElementById("TokenLoginForm")&&(document.getElementById("TokenLoginForm").style.display="block"))}}(),{eFingerprintLoginResult:o,InitDependencies:function(e,t,n,i,o,r){s=e,c=t,a=n,u=i,l=o,g=r},GetFingerprintResult:function(){return r.fingerprintResult},FingerprintStart:function(e){if(i(),a.Init(),e===n.Restricted)return d(e),void(r.fingerprintResult=o.LoginServerError);var t=u.GetLastLoginMethod();a.IsDeviceSupportFingerprint(function(){s("#TokenLoginForm").show(),a.IsFingerprintSet()?parseInt(t)===eLoginMethods.Fingerprint?m():r.fingerprintResult=o.LastLoginMethodNotFingerprint:r.fingerprintResult=o.FigerprintNotSet},function(e){e===a.DeviceSupportErrorEnum.DEVICE_HAS_NO_ENROLLED_FINGERPRINT||e===a.DeviceSupportErrorEnum.BIOMETRY_IS_LOCKED_OUT?(s("#TokenLoginForm").show(),r.fingerprintResult=o.NoFingerPrintOnDevice):(s("#TokenLoginForm").hide(),r.fingerprintResult=o.FingerprintNotSupported)})}}}();$(document).ready(function(){document.addEventListener("deviceready",function(){navigator&&navigator.splashscreen&&navigator.splashscreen.hide(),window.FingerprintLogin&&(window.FingerprintLogin.InitDependencies(window.$,window.Model,window.FingerprintTools,window.LastLoginMethod,window.popupManager,window.externalEventsCallbacks),window.FingerprintLogin.FingerprintStart(window.Model.AutologinStatus))},!1)});
//# sourceMappingURL=nativeandroidmainprelogin.js.map