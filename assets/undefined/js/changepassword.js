function RevealPassword(){var s,o,a,r,t={passwordTypeText:"password-type-text",passwordInput:"password-input",icoWbReveal:"ico-wb-reveal",icoWbRevealOff:"ico-wb-reveal-off",icoPassBlue:"ico-pass-blue"},n={enter:13,ctrlEnter:10};function l(){f(o)||(s.val(o.val()),i(),a.removeClass(t.icoWbRevealOff).addClass(t.icoWbReveal))}function i(){f(o)||(o.off(".RevealPassword"),o.remove(),o=null)}function d(e){""===o.val()?(i(),s.val("").prev().removeClass(t.icoPassBlue).removeClass(t.icoWbRevealOff).addClass(t.icoWbReveal)):(e=e).which!=n.ctrlEnter&&e.which!=n.enter||(e.preventDefault(),s.val(o.val()),i(),r.submit())}function e(){var e;e={width:s.width(),height:s.height(),top:s.offset().top,left:s.offset().left},(o=s.clone().attr("type","text").removeAttr("id").addClass(t.passwordTypeText).removeClass(t.passwordInput).insertAfter(r).offset({top:e.top,left:e.left}).innerWidth(s.innerWidth()).innerHeight(s.innerHeight())).on("keyup.RevealPassword",d),a.removeClass(t.icoWbReveal).addClass(t.icoWbRevealOff),v()&&o.val(s.val())}function c(){v()&&s.val(o.val()),i(),a.removeClass(t.icoWbRevealOff).addClass(t.icoWbReveal)}function u(){""!==s.val()&&(a.hasClass(t.icoWbReveal)?e:c)()}function w(){var e=s.css("box-shadow");""!==s.val()||Browser.isChrome()&&0<=e.indexOf("inset")?s.prev().addClass(t.icoPassBlue):s.prev().removeClass(t.icoPassBlue).removeClass(t.icoWbRevealOff).addClass(t.icoWbReveal)}function v(){return!f(o)&&0<o.length&&""!==o.val()}function f(e){return null==e}return{Init:function(e){s=e.passwordInput,a=e.icon,r=e.form,a.on("click.RevealPassword",u),s.on("keyup.RevealPassword",w),$(window).on("orientationchange.RevealPassword",l),setTimeout(w,100)},HidePasswordText:c,Dispose:function(){a.off("click.RevealPassword"),s.off("keyup.RevealPassword"),$(window).off("orientationchange.RevealPassword")}}}function CustomerValidators(){var s=[],o="passwordnotinblacklist",a="passwordnotcustomerfullname";return{addValidationBlackList:function(){$.validator.unobtrusive.adapters.add(o,["param"],function(e){e.rules[o]=!0,e.messages[o]=e.message}),$.validator.addMethod(o,function(e){return!s||!s.length||-1===s.indexOf(e)}),$.get(function(){var e="";{var s;e=UrlResolver.getAssetsPath?UrlResolver.combine(UrlResolver.getAssetsPath(),"Account","PasswordsBlacklist.js"):(s=UrlResolver.getVersion(),s?Model.CdnPath+Model.jsVirtualPath+"/assets/"+s+"/Account/PasswordsBlacklist.js":Model.jsVirtualPath+"/Account/PasswordsBlacklist")}return e}()).then(function(e){$.isArray(e)&&(s=e)}).done()},addValidationCustomerFullName:function(){var s;window.$customer&&(customer=window.$customer,s={firstName:customer.prop.firstName,lastName:customer.prop.lastName,combinations:[customer.prop.firstName+customer.prop.lastName,customer.prop.firstName+" "+customer.prop.lastName,customer.prop.lastName+customer.prop.firstName,customer.prop.lastName+" "+customer.prop.firstName]},$.validator.unobtrusive.adapters.add(a,["param"],function(e){e.rules[a]=!0,e.messages[a]=e.message}),$.validator.addMethod(a,function(e){return e!==s.firstName&&e!==s.lastName&&-1===s.combinations.indexOf(e)}))}}}!function(e,s){"use strict";"function"==typeof define&&define.amd?define("registration/ChangePasswordModule",["jquery","Global/RevealPassword","Registration/Common/CustomerValidators","dataaccess/dalCommon","devicehelpers/adjustUiPerDevice","UrlResolver","initdatamanagers/Customer"],s):e.ChangePassword=s(e.$,e.RevealPassword,e.CustomerValidators,null,e.adjustUiPerDevice,e.UrlResolver,e.$customer)}("undefined"!=typeof self?self:this,function(a,e,s,r,t,n,l){var i={changePassword_NoToken:7770108},d={None:0,Success:1,ChangeSuccess:2,ResetSuccess:3,OldPasswordDoesNotMatch:4,NewPasswordsDoNotMatch:5,InvalidNewPassword:6,PreviousPasswordRecurrence:7,InternalError:8,UserLockedOut:9,UserNotFound:10,MinDaysPassword:11,TokenNotValid:12,WeakPassword:13},c=new s;function u(){a("#ChangePasswordForm").off(".ChangePassword")}function w(e,s){e.DeleteToken(),s.SetLastLoginMethod(eLoginMethods.Password)}function v(){var e=a("#ChangePasswordForm").validate();a(".input-holder").removeClass("error"),a.each(e.errorList,function(e,s){a(s.element).parent().addClass("error")})}return{init:function(e){var s,o;c.addValidationBlackList(),c.addValidationCustomerFullName(),jQuery.validator.unobtrusive.parse(a("#ChangePasswordForm")),s=a(".validation-summary-errors li"),o=s.text(),s.html(o),e&&u(),u(),a("#oldPassword").on("keyup",function(e){0<e.target.value.length?a("#oldPasswordIcon").addClass("ico-pass-blue"):(a("#oldPasswordIcon").removeClass("ico-wb-reveal-off"),a("#oldPasswordIcon").removeClass("ico-pass-blue"),a("#oldPasswordIcon").addClass("ico-wb-reveal"),e.target.type="password")}),a("#oldPasswordIcon").on("click",function(e){var s=document.getElementById("oldPassword");0<s.value.length&&("password"==s.type?(s.type="text",e.target.classList.add("ico-wb-reveal-off"),e.target.classList.remove("ico-wb-reveal")):(s.type="password",e.target.classList.remove("ico-wb-reveal-off"),e.target.classList.add("ico-wb-reveal")))}),a("#newPassword").on("keyup",function(e){0<e.target.value.length?a("#newPasswordIcon").addClass("ico-pass-blue"):(a("#newPasswordIcon").removeClass("ico-wb-reveal-off"),a("#newPasswordIcon").removeClass("ico-pass-blue"),a("#newPasswordIcon").addClass("ico-wb-reveal"),e.target.type="password")}),a("#newPasswordIcon").on("click",function(e){var s=document.getElementById("newPassword");0<s.value.length&&("password"==s.type?(s.type="text",e.target.classList.add("ico-wb-reveal-off"),e.target.classList.remove("ico-wb-reveal")):(s.type="password",e.target.classList.remove("ico-wb-reveal-off"),e.target.classList.add("ico-wb-reveal")))}),a("#confirmPassword").on("keyup",function(e){0<e.target.value.length?a("#confirmPasswordIcon").addClass("ico-pass-blue"):(a("#confirmPasswordIcon").removeClass("ico-wb-reveal-off"),a("#confirmPasswordIcon").removeClass("ico-pass-blue"),a("#confirmPasswordIcon").addClass("ico-wb-reveal"),e.target.type="password")}),a("#confirmPasswordIcon").on("click",function(e){var s=document.getElementById("confirmPassword");0<s.value.length&&("password"==s.type?(s.type="text",e.target.classList.add("ico-wb-reveal-off"),e.target.classList.remove("ico-wb-reveal")):(s.type="password",e.target.classList.remove("ico-wb-reveal-off"),e.target.classList.add("ico-wb-reveal")))}),a("#ChangePasswordForm").on("change","input",function(e){var s=a("#ChangePasswordForm").validate(),e=e.srcElement||e.target;s.element(e),v()}),a("#ChangePasswordForm").on("click.ChangePassword","#changePasswordbtnOk",{},function(e){e.preventDefault(),function(){var e=document.getElementById("oldPassword");e.type="password",a("#oldPasswordIcon").removeClass("ico-wb-reveal-off"),a("#oldPasswordIcon").addClass("ico-wb-reveal"),0==e.value.length&&a("#oldPasswordIcon").removeClass("ico-pass-blue");e=document.getElementById("newPassword");e.type="password",a("#newPasswordIcon").removeClass("ico-wb-reveal-off"),a("#newPasswordIcon").addClass("ico-wb-reveal"),0==e.value.length&&a("#newPasswordIcon").removeClass("ico-pass-blue");e=document.getElementById("confirmPassword");e.type="password",a("#confirmPasswordIcon").removeClass("ico-wb-reveal-off"),a("#confirmPasswordIcon").addClass("ico-wb-reveal"),0==e.value.length&&a("#confirmPasswordIcon").removeClass("ico-pass-blue")}(),function(){var e=a("#ChangePasswordForm");window.$viewModelsManager&&e.find('input[name="IsExternalPage"]').val("True");a("#divChangePasswordErrors").html("").removeClass().addClass("field-validation-valid"),e.valid()?a.post(n.getUrlWithRndKeyValue("/webpl3/Account/SaveChangedPassword"),e.serialize(),function(e){(e=a.parseJSON(e)).result===d.Success?function(e){window.Fingerprint&&localStorage.getItem("fingerprintSupport")&&("function"==typeof define&&define.amd?require(["FingerprintTools","LastLoginMethod"],w):w(window.FingerprintTools,window.LastLoginMethod));window.$viewModelsManager?(l.prop.showSuggestionChangePassword=!1,AlertsManager.UpdateAlert(AlertTypes.ServerResponseAlert,Dictionary.GetItem("GenericAlert","dialogsTitles"," "),Dictionary.GetItem("PasswordSuccess"),"",{redirectToView:l.prop.mainPage}),AlertsManager.PopAlert(AlertTypes.ServerResponseAlert)):e.returnUrl&&""!==e.returnUrl?window.location.href=window.location.pathname.substring(0,window.location.pathname.indexOf("/",1))+e.returnUrl.replace("~",""):window.location.href=window.location.pathname.substring(0,window.location.pathname.indexOf("/",1))+e.resultTranslation.replace("~","")}(e):e.result===d.TokenNotValid?r?r.Logout(i.changePassword_NoToken):window.location.assign("logout?reason="+i.changePassword_NoToken):(function(e){switch(e.result){case d.OldPasswordDoesNotMatch:a("#ChangePasswordForm").validate().showErrors({OldPassword:e.resultTranslation.join("<br />")});break;case d.PreviousPasswordRecurrence:case d.WeakPassword:a("#ChangePasswordForm").validate().showErrors({NewPassword:e.resultTranslation.join("<br />")});break;default:a("#divChangePasswordErrors").removeClass().addClass("field-validation-error error-from-server").html(e.resultTranslation.join("<br />"))}}(e),v())}):v()}()}),t&&(t(document.getElementById("oldPassword")),t(document.getElementById("newPassword")),t(document.getElementById("confirmPassword"))),a("#changePasswordTemplate").addClass(window.$viewModelsManager?"internal":"")},unsetDomEvents:u}}),function(e,s){"use strict";"function"==typeof define&&define.amd?define("adjustUiPerDevice",[],s):e.adjustUiPerDevice=s()}("undefined"!=typeof self?self:this,function(){function s(){for(var e=document.querySelectorAll("[data-ios]"),s=0;s<e.length;s++){var o=e[s].getAttribute("data-ios");"adjustTop"==o?(e[s].style.top=0,e[s].style.position="absolute"):"adjustBottom"==o&&(e[s].style.position="relative",e[s].style.display="none")}}function o(){for(var e=document.querySelectorAll("[data-ios]"),s=0;s<e.length;s++){var o=e[s].getAttribute("data-ios");"adjustTop"==o?(e[s].style.top=0,e[s].style.position="fixed"):"adjustBottom"==o&&(e[s].style.position="fixed",e[s].style.display="")}}return function(e){null!==e&&(1!=e?0!=e?(e.onfocus=s,e.onblur=o):o():s())}});
//# sourceMappingURL=changepassword.js.map