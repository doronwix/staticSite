function ProChart_InitSystems(q){function l(){c.init.endLisLoaded=0;b.chart.ListTemplates(c.init.mstrUserToken,"template");b.chart.ListTemplates(c.init.mstrUserToken,"analysis")}function r(){$(".systems-dialog .systems-list .opensystem").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.OpenTemplate(c.init.mstrUserToken,a,d)});$(".systems-dialog .systems-list .open-system").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.OpenTemplate(c.init.mstrUserToken,
a,d)});$(".systems-dialog .systems-list .delete-system").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.DeleteTemplate(c.init.mstrUserToken,a,d)})}function s(){$(".systems-dialog .systems-list .save-system-template").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).parent().find("span").html();e();b.chart.SaveTemplate(c.init.mstrUserToken,a,d,"","template")});$(".systems-dialog .systems-list .save-system-analysis").off().on("click",function(){var a=
$(this).attr("tid"),d=$(this).parent().find("span").html();e();b.chart.SaveTemplate(c.init.mstrUserToken,a,d,"","analysis")});$(".systems-dialog .systems-list .delete-system").off().on("click",function(){var a=$(this).attr("tid"),d=$(this).attr("ttype");e();b.chart.DeleteTemplate(c.init.mstrUserToken,a,d)});$(".systems-dialog .save-system-new-template").off().on("click",function(){var a=$(".systems-dialog #in-newname-template").val();e();b.chart.SaveTemplate(c.init.mstrUserToken,"",a,"","template")});
$(".systems-dialog .save-system-new-analysis").off().on("click",function(){var a=$(".systems-dialog #in-newname-analysis").val();e();b.chart.SaveTemplate(c.init.mstrUserToken,"",a,"","analysis")})}function m(a,d){function c(a){$(a).find(".spectrum-color").each(function(){$(this).spectrum("destroy")})}function e(a){var c=b.patterns.common.eye_orange.replace(/%icon-source%/g,h.icon_source).replace(/%icon-prefix%/g,h.icon_prefix);$(a).find(".ui-dialog-buttonset").prepend(c).on("click",function(){var a=
$(".chart-ui-dialog.systems-dialog").css("opacity"),a=1==a?.5:1,b=1==a?"":2;$(".chart-ui-dialog.systems-dialog").css("opacity",a);$(this).css("opacity",b)})}var g="Close",k=d,f="";"undefined"!=typeof b.localizationobj&&(g=b.localizationobj.gui.returnLocalizationString("dialogs.common.button-close","Close"),k=b.localizationobj.gui.returnLocalizationString("dialogs.systems.title",d));"undefined"!=typeof b.init.TemplateName&&(f=b.init.TemplateName);var l="";"rtl"==b.localizationobj.gui.returnCurrentLanguage().direction&&
(l="dir-rtl");$('<div id="chart-dialog" title="'+k+'"></div>').insertAfter("body");$("#chart-dialog").dialog({dialogClass:"chart-ui-dialog systems-dialog "+f+" "+l,draggable:!0,autoOpen:!1,resizable:!1,closeOnEscape:!0,width:"auto",modal:!0,open:function(a,c){e($(this).parent());$(".ui-widget-overlay").last().addClass("chart-ui-widget-overlay");if(b.api.props){var d=b.api.props.chart.gui.layout.zindex_dialog;$(".chart-ui-widget-overlay").css({"z-index":d});$(".chart-ui-dialog").css({"z-index":d})}$(".ui-widget-overlay").bind("click",
function(){$("#chart-dialog").dialog("close")});"undefined"!=typeof b.preloadobj&&b.preloadobj.endPreload()},close:function(a,b){c($(this).parent());$("#chart-dialog").remove();$("div.chart-ui-dialog.systems-dialog  adv-buttons."+h.icon_prefix+"eye-orange").off().remove();$("div.chart-ui-dialog.systems-dialog").off().remove();$(this).off().empty().remove()},buttons:[{id:"btn-dialogs-close",text:g,click:function(){$(this).dialog("close")}}]})}function n(){$(".properties-tabs").delegate("a","click",
function(){var a=$(this).parents(".dialog_level"),b=$(a).find(".properties-tabs a").index(this);$(a).find(".main-properties").each(function(){$(this).css("display","none")});$(a).find(".properties-tabs-label").each(function(){$(this).removeClass("active")});$(a).find(".main-properties").eq(b).css("display","block");$(this).addClass("active")})}function p(){"undefined"!=typeof b.preloadobj&&b.preloadobj.startPreload()}function e(){if("undefined"!=typeof b.preloadobj){var a=$(".chart-ui-dialog.systems-dialog");
b.preloadobj.startPreloadinobject(a)}}function k(){if("undefined"!=typeof b.preloadobj){var a=$(".chart-ui-dialog.systems-dialog");b.preloadobj.endPreloadinobject(a)}}var b=q,c={};b.systems=c;b.api.debug.getLogger("prochart.gui.systems");var h=b.api.layout.getbuttonStyle(),f="";c.gui={viewSystems:function(){c.init.typeOpenSave=0;c.init.endLisLoaded=0;p();f="Systems form";m("test",f);var a=b.patterns.systems.systemsform;$("#chart-dialog").html(a);n();"undefined"!=typeof b.localizationobj&&b.localizationobj.gui.updateFromDataLang($("#chart-dialog"));
$("#chart-dialog").dialog("open");e()},saveSystems:function(){c.init.typeOpenSave=1;c.init.endLisLoaded=0;p();f="Save system form";m("test",f);var a=b.patterns.systems.systemssaveform.replace(/%icon-source%/g,h.icon_source).replace(/%icon-prefix%/g,h.icon_prefix);$("#chart-dialog").html(a);n();"undefined"!=typeof b.localizationobj&&b.localizationobj.gui.updateFromDataLang($("#chart-dialog"));$("#chart-dialog").dialog("open");e()},loginInSystems:function(a,d){c.init.mstrUserToken=d;b.chart.ListTemplates(d,
"template");b.chart.ListTemplates(d,"analysis")},systemsList:function(a,d,e){switch(c.init.typeOpenSave){case 0:a=null;var f="";switch(e){case "template":a=$("#systemgroup-group1 .systems-list");$(a).empty();f="template";break;case "analysis":a=$("#systemgroup-group2 .systems-list"),$(a).empty(),f="analysis"}if(null!=a)for(e=0;e<d.length;e++){var g=d[e],g=b.patterns.systems.systems_list_open.replace(/%icon-source%/g,h.icon_source).replace(/%icon-prefix%/g,h.icon_prefix).replace(/%systemid%/g,g.TemplateIID).replace(/%caption%/g,
g.Name).replace(/%description%/g,g.Description).replace(/%typesystem%/g,f);$(a).append(g)}c.init.endLisLoaded+=1;2==c.init.endLisLoaded&&r();break;case 1:a=null;f="";switch(e){case "template":a=$("#systemgroup-group1 .systems-list");$(a).empty();f="template";break;case "analysis":a=$("#systemgroup-group2 .systems-list"),$(a).empty(),f="analysis"}if(null!=a)for(e=0;e<d.length;e++)g=d[e],g=b.patterns.systems.systems_list_save.replace(/%icon-source%/g,h.icon_source).replace(/%icon-prefix%/g,h.icon_prefix).replace(/%systemid%/g,
g.TemplateIID).replace(/%caption%/g,g.Name).replace(/%description%/g,g.Description).replace(/%typesystem%/g,f),$(a).append(g);c.init.endLisLoaded+=1;2==c.init.endLisLoaded&&s()}k()},loadedSystem:function(a,b){k()},savedSystem:function(a,b){k();e();l()},deletedSystem:function(a,b,c){k();e();l()},errorSystem:function(a,b,c){}};c.init={mstrUserToken:"",typeOpenSave:0,endLisLoaded:0};return c};
