{
  "requestUrl": "/webpl3/assets/20201230110628/js/scripts/fxnet/LogicLayer/GeneralManager/DealTypeManager.js?v=20201230110628",
  "contentType": "application/javascript",
  "method": "GET",
  "statusCode": 200,
  "data": "ï»¿define(\r\n    \"generalmanagers/DealTypeManager\",\r\n    [\r\n        \"require\",\r\n        \"initdatamanagers/Customer\",\r\n        \"enums/enums\",\r\n        \"handlers/StateMachine\"\r\n    ],\r\n    function DealTypeManager(require) {\r\n        var Customer = require(\"initdatamanagers/Customer\"),\r\n            dealTypeStateMachine,\r\n            cDealPermitTypeStates = [\r\n                {\r\n                    'name': 'initial',\r\n                    'initial': true,\r\n                    'events': {\r\n                        'islamic': eDealType.Islamic,\r\n                        'spot_or_spotonly_no_future': eDealType.Spot,\r\n                        'future': eDealType.Future,\r\n                        'share': eDealType.Share\r\n                    }\r\n                },\r\n                {\r\n                    'name': eDealType.Islamic,\r\n                    'events': {}\r\n                },\r\n                {\r\n                    'name': eDealType.Spot,\r\n                    'events': {\r\n                        'future': eDealType.Future,\r\n                        'share': eDealType.Share\r\n                    }\r\n                },\r\n                {\r\n                    'name': eDealType.Future,\r\n                    'events': {\r\n                        'spot_or_spotonly_no_future': eDealType.Spot,\r\n                        'share': eDealType.Share\r\n                    }\r\n                },\r\n                {\r\n                    'name': eDealType.Share,\r\n                    'events': {\r\n                        'spot_or_spotonly_no_future': eDealType.Spot,\r\n                        'future': eDealType.Future\r\n                    }\r\n                }\r\n            ];\r\n\r\n        function init() {\r\n            dealTypeStateMachine = new TStateMachine();\r\n            dealTypeStateMachine.Init(cDealPermitTypeStates);\r\n\r\n            setContext();\r\n        }\r\n\r\n        function getStatus() {\r\n            return dealTypeStateMachine.GetStatus();\r\n        }\r\n\r\n        function consumeEvent(e) {\r\n            setContext();\r\n\r\n            dealTypeStateMachine.ConsumeEvent(e);\r\n        }\r\n\r\n        function setContext() {\r\n            switch (Customer.prop.dealPermit) {\r\n                case eDealPermit.SpotOnly:\r\n                case eDealPermit.ZeroSpread:\r\n                    dealTypeStateMachine.ConsumeEvent('spot_or_spotonly_no_future');\r\n                    break;\r\n\r\n                case eDealPermit.Islamic:\r\n                    dealTypeStateMachine.ConsumeEvent('islamic');\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return {\r\n            Init: init,\r\n            GetStatus: getStatus,\r\n            ConsumeEvent: consumeEvent\r\n        };\r\n    }\r\n);\r\n",
  "isBase64": false
}