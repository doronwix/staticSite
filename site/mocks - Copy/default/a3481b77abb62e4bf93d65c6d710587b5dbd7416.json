{
  "requestUrl": "/webpl3/assets/20201230110628/js/scripts/fxnet/uilayer/managers/ChartSettingManager.js?v=20201230110628",
  "contentType": "application/javascript",
  "method": "GET",
  "statusCode": 200,
  "data": "ï»¿define(\r\n    'managers/ChartSettingManager',\r\n    [\r\n        \"require\",\r\n        'managers/CustomerProfileManager',\r\n        \"modules/LoadFromPouchDB!chart\",\r\n        'dataaccess/dalPouchDB',\r\n        'JSONHelper',\r\n        'global/debounce'\r\n    ],\r\n    function ChartSettingManager(require) {\r\n        var customerProfileManager = require('managers/CustomerProfileManager'),\r\n            requireChartDoc = require(\"modules/LoadFromPouchDB!chart\"),\r\n            JSONHelper = require('JSONHelper'),\r\n            dalPouchDB = require('dataaccess/dalPouchDB');\r\n\r\n        var chartDocId = \"chart\";\r\n        var period = 1000;\r\n        var chart = {};\r\n\r\n        var saveChart = debounce(function saveChartHandler() {\r\n            //chart without methods\r\n            var chartToSave = JSONHelper.STR2JSON(\"ChartSettingManager:saveChart\", JSON.stringify(chart));\r\n            dalPouchDB.Save(chartDocId, chartToSave);\r\n\r\n        }, period);\r\n\r\n        function getChart() {\r\n            return chart;\r\n        }\r\n\r\n        function init() {\r\n            if (requireChartDoc) {\r\n                chart = requireChartDoc;\r\n            }\r\n            else {\r\n                // try to load from legacy\r\n                chart.chartUserSettings = customerProfileManager.OldChart().chartUserSettings || {};\r\n                chart.tileChartSettings = customerProfileManager.OldChart().tileChartSettings || [];\r\n                chart.tileSettings = customerProfileManager.OldChart().tileSettings || {};\r\n                chart.chartFavorites = customerProfileManager.OldChart().chartFavorites || {};\r\n                chart.chartIndicatorsSettings = customerProfileManager.OldChart().chartIndicatorsSettings || [];\r\n                chart.chartsZoomSettings = customerProfileManager.OldChart().chartsZoomSettings || {};\r\n            }\r\n        }\r\n\r\n        init();\r\n\r\n        return {\r\n            Chart: getChart,\r\n            SaveChart: saveChart\r\n        };\r\n    }\r\n);\r\n",
  "isBase64": false
}